import{bZ as li,E as ri,z as di,c as _,H as hi,_ as ui,L as te,b_ as to,V as Dt,U as Et,Q as ce,b$ as L,W as pi,c0 as cc,c1 as lc,T as R,w as gi,c2 as no,c3 as mi,c4 as rc,a3 as dc,c5 as hc,a6 as uc,c6 as fi,u as J,aL as Rn,aJ as pc,c7 as gc,c8 as mc,c9 as fc,ca as $i,cb as $c,a$ as yi,a_ as bi,cc as P,cd as yc,ce as bc,bv as A,b4 as xc,b5 as _c,cf as Mt,cg as wc,ch as vc,ci as xi,cj as Tt,ck as kc,j as o,cl as It,cm as le,bn as Q,bw as zn,cn as Cc,d as x,al as G,ay as rt,co as Rt,h as H,av as W,bQ as _i,cp as Sc,cq as wi,cr as vi,cs as Bn,ct as ee,ad as En,n as M,cu as Dc,cv as ki,bD as Mc,k as Ci,bU as Tc,e as Y,G as j,C as re,S as ne,N as Ic,bH as Rc,bb as Tn,bV as oo,bl as Si,aV as at,bW as zc,bX as Bc,I as Pn,q as Vn,a1 as Ec,cw as Pc,s as ct,M as On,aK as Pt,ab as Di,ac as Mi,cx as Vc,i as Oc,l as Ac,m as qc,ba as Fc,D as Lc,bY as jc,cy as Hc,o as Ti,r as Wc,a as Kc,b as Nc,g as Gc,br as Ii,bz as Ri,bx as zi,cz as Uc,y as Jc,cA as Zc,x as dt,B as de,cB as An,F as ht,cC as Bi,cD as Qc,ag as qn,af as Yc,aW as st,ao as Xc,b1 as el,cE as tl,cF as nl,cG as ol,aF as Ei,aD as Ct,ah as al,cH as sl,bt as il,cI as cl,aI as ll,cJ as rl,cK as dl,bT as hl,cL as ul,cM as pl,cN as U,cO as Pi,a4 as ao,b3 as so,cP as gl,cQ as ml,b9 as Vi,cR as fl,cS as w,cT as Fn,cU as g,cV as p,aw as z,aB as $,cW as $l,bC as yl}from"./index-D6jllUwH.js";import{u as Oi}from"./useDataEntryBase-CmLxRlN2.js";import{i as bl,d as xl}from"./discSortUtil-Bn_MGDB2.js";function _l(e){const{badgeContent:t,invisible:n=!1,max:a=99,showZero:s=!1}=e,c=li({badgeContent:t,max:a});let i=n;n===!1&&t===0&&!s&&(i=!0);const{badgeContent:l,max:d=a}=i?c:e,h=l&&Number(l)>d?`${d}+`:l;return{badgeContent:l,invisible:i,max:d,displayValue:h}}function wl(e){return di("MuiBadge",e)}const X=ri("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),vl=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],dn=10,hn=4,kl=e=>{const{color:t,anchorOrigin:n,invisible:a,overlap:s,variant:c,classes:i={}}=e,l={root:["root"],badge:["badge",c,a&&"invisible",`anchorOrigin${L(n.vertical)}${L(n.horizontal)}`,`anchorOrigin${L(n.vertical)}${L(n.horizontal)}${L(s)}`,`overlap${L(s)}`,t!=="default"&&`color${L(t)}`]};return pi(l,wl,i)},Cl=Et("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Sl=Et("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${L(n.anchorOrigin.vertical)}${L(n.anchorOrigin.horizontal)}${L(n.overlap)}`],n.color!=="default"&&t[`color${L(n.color)}`],n.invisible&&t.invisible]}})(({theme:e})=>{var t;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:dn*2,lineHeight:1,padding:"0 6px",height:dn*2,borderRadius:dn,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.keys(((t=e.vars)!=null?t:e).palette).filter(n=>{var a,s;return((a=e.vars)!=null?a:e).palette[n].main&&((s=e.vars)!=null?s:e).palette[n].contrastText}).map(n=>({props:{color:n},style:{backgroundColor:(e.vars||e).palette[n].main,color:(e.vars||e).palette[n].contrastText}})),{props:{variant:"dot"},style:{borderRadius:hn,height:hn*2,minWidth:hn*2,padding:0}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${X.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${X.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${X.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${X.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${X.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${X.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${X.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${X.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]}}),io=_.forwardRef(function(t,n){var a,s,c,i,l,d;const h=hi({props:t,name:"MuiBadge"}),{anchorOrigin:b={vertical:"top",horizontal:"right"},className:S,component:k,components:m={},componentsProps:y={},children:v,overlap:C="rectangular",color:V="default",invisible:K=!1,max:N=99,badgeContent:Z,slots:F,slotProps:O,showZero:q=!1,variant:T="standard"}=h,I=ui(h,vl),{badgeContent:ae,invisible:Yi,max:Xi,displayValue:ec}=_l({max:N,invisible:K,badgeContent:Z,showZero:q}),tc=li({anchorOrigin:b,color:V,overlap:C,variant:T,badgeContent:Z}),Jn=Yi||ae==null&&T!=="dot",{color:nc=V,overlap:oc=C,anchorOrigin:ac=b,variant:Zn=T}=Jn?tc:h,Qn=Zn!=="dot"?ec:void 0,cn=te({},h,{badgeContent:ae,invisible:Jn,max:Xi,displayValue:Qn,showZero:q,anchorOrigin:ac,color:nc,overlap:oc,variant:Zn}),Yn=kl(cn),Xn=(a=(s=F==null?void 0:F.root)!=null?s:m.Root)!=null?a:Cl,eo=(c=(i=F==null?void 0:F.badge)!=null?i:m.Badge)!=null?c:Sl,ln=(l=O==null?void 0:O.root)!=null?l:y.root,rn=(d=O==null?void 0:O.badge)!=null?d:y.badge,sc=to({elementType:Xn,externalSlotProps:ln,externalForwardedProps:I,additionalProps:{ref:n,as:k},ownerState:cn,className:Dt(ln==null?void 0:ln.className,Yn.root,S)}),ic=to({elementType:eo,externalSlotProps:rn,ownerState:cn,className:Dt(Yn.badge,rn==null?void 0:rn.className)});return ce.jsxs(Xn,te({},sc,{children:[v,ce.jsx(eo,te({},ic,{children:Qn}))]}))});function Dl(e){return di("MuiFormControlLabel",e)}const it=ri("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Ml=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],Tl=e=>{const{classes:t,disabled:n,labelPlacement:a,error:s,required:c}=e,i={root:["root",n&&"disabled",`labelPlacement${L(a)}`,s&&"error",c&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",s&&"error"]};return pi(i,Dl,t)},Il=Et("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${it.label}`]:t.label},t.root,t[`labelPlacement${L(n.labelPlacement)}`]]}})(({theme:e,ownerState:t})=>te({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${it.disabled}`]:{cursor:"default"}},t.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},t.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},t.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${it.label}`]:{[`&.${it.disabled}`]:{color:(e.vars||e).palette.text.disabled}}})),Rl=Et("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})(({theme:e})=>({[`&.${it.error}`]:{color:(e.vars||e).palette.error.main}})),zl=_.forwardRef(function(t,n){var a,s;const c=hi({props:t,name:"MuiFormControlLabel"}),{className:i,componentsProps:l={},control:d,disabled:h,disableTypography:b,label:S,labelPlacement:k="end",required:m,slotProps:y={}}=c,v=ui(c,Ml),C=cc(),V=(a=h??d.props.disabled)!=null?a:C==null?void 0:C.disabled,K=m??d.props.required,N={disabled:V,required:K};["checked","name","onChange","value","inputRef"].forEach(I=>{typeof d.props[I]>"u"&&typeof c[I]<"u"&&(N[I]=c[I])});const Z=lc({props:c,muiFormControl:C,states:["error"]}),F=te({},c,{disabled:V,labelPlacement:k,required:K,error:Z.error}),O=Tl(F),q=(s=y.typography)!=null?s:l.typography;let T=S;return T!=null&&T.type!==R&&!b&&(T=ce.jsx(R,te({component:"span"},q,{className:Dt(O.label,q==null?void 0:q.className),children:T}))),ce.jsxs(Il,te({className:Dt(O.root,i),ownerState:F,ref:n},v,{children:[_.cloneElement(d,N),K?ce.jsxs(gi,{display:"block",children:[T,ce.jsxs(Rl,{ownerState:F,"aria-hidden":!0,className:O.asterisk,children:[" ","*"]})]}):T]}))}),Bl={};class Ai{constructor(t,n){this.root=new El(t,n)}subset(t){const n=[];return this._subset(t,a=>n.push(...a[no].map(s=>s.value))),n}entries(t){const n=[];return this._subset(t,a=>n.push(...a[no])),n}_subset(t,n){const a=t.length;function s(c,i){c<a?i.subset(t[c]).forEach(l=>s(c+1,l)):n(i.leaf)}s(0,this.root)}}let El=class qi{constructor(t,n){if(this.children=[],t>0)for(const[a,s]of Object.entries(n)){const c=new Map;for(const[i,l]of Object.entries(s))c.set(+i,new qi(t-1,l));this.children.push({mask:+a,map:c})}else this.leaf=n}subset(t){return this.children.map(({mask:n,map:a})=>a.get(t&n)).filter(n=>!!n)}};class co{constructor(t){this.root=new Ln(void 0),this.keys=t}at(t){const n=this.keys.get(t),a=n.reduce((s,c)=>s.child(c),this.root);return a.leaf||(a.leaf=new jn(t,n,this.keys,a)),a.leaf}}class Ln{constructor(t){this.children=new Map,this.parent=t}child(t){let n=this.children.get(t);return n||(n=new Ln(this),this.children.set(t,n),n)}}class jn{constructor(t,n,a,s){this.tag=Object.fromEntries(Object.entries(t).filter(([c,i])=>i!=null)),this.id=n,this.keys=a,this.internal=s}with(t){const{keys:n}=this,{id:a,firstReplacedByte:s}=n.combine(this.id,t);let c=this.internal;for(let i=s;i<n.tagLen;i++)c=c.parent;for(let i=s;i<n.tagLen;i++)c=c.child(a[i]);return c.leaf||(c.leaf=new jn({...this.tag,...t},a,n,c)),c.leaf}}class Pl{constructor(t,n){this.keys=new mi(t),this.values=new Ai(t.tagLen,n)}subset(t){return this.values.subset(this.keys.get(t))}}const lt={sum:e=>e.reduce((t,n)=>t+n,0),prod:e=>e.reduce((t,n)=>t*n,1),min:e=>Math.min(...e),max:e=>Math.max(...e),sumfrac:([e,t])=>e/(e+t),unique:([e])=>e},Fi={match:([e,t])=>e===t?0:1,thres:([e,t])=>e>=t?0:1,lookup:([e],t)=>t[e]??0},wt=e=>hc(e,"val");let Li=class{constructor(t,...n){const a=new mi(t);this.nodes=new Ai(a.tagLen,rc(n)),this.cache=new co(a).at({}),this.calc=new co(a).at({}),this.calc.val=this}withTag(t){const n=this.calc.with(t);return n.val??(n.val=Object.assign(new this.constructor(this.cache.keys),this,{cache:this.cache.with(t),calc:n}))}gather(t){return this._gather(this.cache.with(t)).pre}compute(t){return this._compute(t,this.cache)}_gather(t){if(t.val)return t.val;const n=this.nodes.entries(t.id).flatMap(({tag:a,value:s})=>s.op==="reread"?this._gather(t.with(s.tag)).pre:[this.markGathered(t.tag,a,s,this._compute(s,t))]);return t.val={pre:n}}_compute(t,n){const a=(c,i,l,d)=>Object.freeze({val:c,meta:this.computeMeta(t,c,i,l,d)}),{op:s}=t;switch(s){case"const":return a(t.ex,[],[]);case"sum":case"prod":case"min":case"max":case"sumfrac":{const c=t.x.map(i=>this._compute(i,n));return a(lt[s](wt(c)),c,[])}case"thres":case"match":case"lookup":{const c=t.br.map(h=>this._compute(h,n)),i=Fi[s](wt(c),t.ex),l=[...Array(t.x.length)],d=l[i]=this._compute(t.x[i],n);return a(d.val,l,c)}case"subscript":{const c=this._compute(t.br[0],n);return a(t.ex[c.val],[],[c])}case"vtag":return a(n.tag[t.ex]??"",[],[]);case"tag":{const c=n.with(t.tag),i=this._compute(t.x[0],c);return a(i.val,[i],[],c.tag)}case"dtag":{const c=t.br.map(d=>this._compute(d,n)),i=n.with(Object.fromEntries(c.map((d,h)=>[t.ex[h],d.val]))),l=this._compute(t.x[0],i);return a(l.val,[l],c,i.tag)}case"read":{const c=n.with(t.tag),i=this._gather(c),{pre:l}=i,d=t.ex??this.defaultAccu(c.tag)??"unique";if(d!==t.ex&&(t={...t,ex:d}),i[d])return i[d];if(uc()&&d==="unique"&&l.length!==1)throw new Error(`Ill-form read for ${fi(c.tag)}`);const h=lt[d](wt(l));return i[d]=a(h,l,[],c.tag)}case"custom":{const c=t.x.map(i=>this._compute(i,n));return a(Bl[t.ex].calc(wt(c)),c,[])}default:dc(s)}}defaultAccu(t){}markGathered(t,n,a,s){return s}computeMeta(t,n,a,s,c){}toDebug(){throw new Error("not implemented")}};const Vl={arithmetic:lt,branching:Fi};class Ol extends Li{constructor(t,n=fi,a=()=>!0){super(t.cache.keys),this.gathering=new Set,this.nodes=t.nodes,this.tagStr=n,this.filter=a,this.defaultAccu=s=>t.defaultAccu(s),this.cache=this.cache.with(t.cache.tag)}withTag(t){throw new Error("Unimplemented")}_gather(t){if(this.gathering.has(t))throw new Error(`Loop detected for ${this.tagStr(t.tag)}`);this.gathering.add(t);const n=this.__gather(t);return this.gathering.delete(t),n}__gather(t){if(t.val)return t.val;const n=this.nodes.entries(t.id).flatMap(({tag:a,value:s})=>s.op==="reread"?this._gather(t.with(s.tag)).pre.map(c=>{const i=`${this.tagStr(a)} <= ${this.tagStr(s.tag)} : ${c.meta.readSeq}`;return Object.freeze({...c,meta:{...c.meta,readSeq:i}})}):[this.markGathered(t.tag,a,s,this._compute(s,t))]);return t.val={pre:n}}_compute(t,n){try{return super._compute(t,n)}catch(a){return Object.freeze({val:NaN,meta:{formula:`${a}`,deps:[],omitted:[],val:NaN,x:[],br:[],comp:"ERR",pivot:!0,toJSON:ro}})}}markGathered(t,n,a,s){const c=`${this.tagStr(n)} <- ${this.tagStr(t)}`;return{...s,meta:{...s.meta,readSeq:c,pivot:!0}}}computeMeta(t,n,a,s,c){let i,l;const d=a.filter(m=>m).map(m=>m.meta),h=s.map(m=>m.meta),b=[],S=t.op==="read"?t.ex:t.op,k=[];if(S in lt){const m=lt[S]([]);for(const y of[...h,...d])y.val!==m||this.filter(y)?b.push(y):k.push(y)}else b.push(...h,...d);switch(t.op){case"const":i=lo(t.ex);break;case"read":l=`gather ${d.length} node(s)`,l+=` matching ${this.tagStr(c,t.ex)}`,l+=` (for ${this.tagStr(t.tag)})`,k.length&&(l+=` <${k.length} omitted>`),i=`${this.tagStr(t.tag)}`;break;default:{const m=[];t.ex&&t.op!=="subscript"&&m.push(JSON.stringify(t.ex)),t.tag&&m.push(this.tagStr(t.tag)),m.push(...b.map(y=>y.comp)),k.length&&m.push(`<${k.length} omitted>`),i=`${t.op}(`+m.join(", ")+")"}}return k.push(...b.flatMap(m=>m.pivot?[]:m.omitted)),Object.freeze({formula:`[${lo(n)}] ${l??i}`,deps:[...new Set(b.flatMap(m=>m.pivot?[m]:m.deps))],omitted:[...new Set(k)],val:n,x:d,br:h,comp:i,pivot:t.op==="read",toJSON:ro})}}const lo=e=>typeof e=="string"?`"${e}"`:e.toString();function ro(){const{formula:e,readSeq:t,deps:n}=this,a={readSeq:t,formula:e,deps:n};return a.readSeq||delete a.readSeq,a.deps.length||delete a.deps,Object.keys(a).length===1?a.formula:a}function Vt(e){const{database:t}=J();return Rn(t.chars,e)}function Al(e){const{database:t}=J();return Rn(t.charOpts,e)}function ql(e){const{database:t}=J();return Rn(t.discs,e??"")}const{arithmetic:Fl}=Vl;let Ll=class extends Li{computeMeta({op:t,ex:n,tag:a},s,c,i,l){let d=c.filter(m=>!!m);const h=jl(d,i);function b(m){return Object.freeze(l&&!m.tag?{tag:l,...m}:m)}function S(m,y){return b({op:m,ops:y,...h})}function k(m,y){let{meta:v}=m;return y!=null&&y.some(C=>!v.usedCats.has(C))&&(v={...v,usedCats:new Set([...v.usedCats,...y])}),b(v.conds===h.conds?v:{...v,...h})}if(t==="read"&&(l==null?void 0:l.qt)==="cond"){const{src:m,dst:y,sheet:v,q:C}=l;m&&v&&C&&(h.conds=zt(h.conds,{[y??"All"]:{[m]:{[v]:{[C]:s}}}}))}switch(t==="read"&&n!=="unique"&&([t,n]=[n,void 0]),t){case"sum":case"prod":case"min":case"max":case"sumfrac":if(d.length>1){const m=Fl[t]([]);d=d.filter(y=>y.val!==m)}return d.length===1?k(d[0]):S(d.length?t:"const",d);case"const":case"subscript":return S("const",[]);case"vtag":return h.usedCats=new Set([n]),S("const",[]);case"match":case"thres":case"lookup":case"read":return k(d[0]);case"tag":return k(d[0],Object.keys(a));case"dtag":return k(d[0],n);case"custom":return S(n,d);default:pc(t)}}markGathered(t,n,a,s){const{val:c}=s,i={...s.meta};let l=!1;const d=new Set([...i.usedCats,...Object.keys(n)]);return i.usedCats.size!==d.size&&(i.usedCats=d,l=!0),l?{val:c,meta:Object.freeze(i)}:s}listFormulas(t){return this.gather(t.tag).filter(n=>n.val).map(({val:n,meta:a})=>gc.withTag(a.tag)[n])}listCondFormulas(t){return this.listFormulas(t).map(n=>this.compute(n).meta.conds).reduce(zt,{})}};function jl(e,t){var i;const n=[...e.map(l=>l.meta),...t.map(l=>l.meta)];let a={},s=new Set;for(const l of n)a=zt(a,l.conds),l.usedCats.forEach(d=>s.add(d));const c=s.size;return s=((i=n.find(l=>l.usedCats.size===c))==null?void 0:i.usedCats)??s,{usedCats:s,conds:a}}function zt(e,t){if(e===t)return e;if(typeof e!="object")throw new Error(`cannot merge ${e} and ${t}`);if(Object.keys(t).length>Object.keys(e).length&&([e,t]=[t,e]),!Object.keys(t).length)return e;let n=!1;const a={...e};for(const[s,c]of Object.entries(t)){const i=a[s],l=s in a?zt(i,c):c;i!==l&&(a[s]=l,n=!0)}return Object.freeze(n?a:e)}function Hl(e){const t=new Set(e);return n=>!Wl(n,t)}function Wl(e,t){const n=e.formula.match(/(\S+) (\S+) common.count/);if(!n)return!1;const[,a,s]=n;return s==="own"&&t.has(a)}class Kl extends Ll{toDebug(){return new Ol(this,mc,Hl([...yi,...bi]))}defaultAccu(t){var s,c,i,l;const{qt:n,q:a}=t;if(!(!n||!a))switch(t.et){case"own":case"target":return(c=(s=$i[n])==null?void 0:s[a])==null?void 0:c.accu;case"enemy":return(l=(i=fc[n])==null?void 0:i[a])==null?void 0:l.accu;case"team":if(n==="common"&&a==="count")return"sum";throw new Error("non-explicit team value accumulator")}}listFormulas(t){return super.listFormulas(t).filter(n=>$c)}}function St(e,...t){return t.map(({tag:n,value:a})=>({tag:{...n,preset:e},value:a}))}function ji(e,...t){return t.map(({tag:n,value:a})=>({tag:{...n,src:e},value:a}))}function Hi(e){const{lvl:t,promotion:n,basic:a,dodge:s,special:c,chain:i,assist:l,core:d,mindscape:h}=A.char,{char:b,iso:S,[e.key]:k}=P.withAll("sheet",[]);return[b.reread(k),S.reread(k),t.add(e.level),a.add(e.basic),s.add(e.dodge),c.add(e.special),i.add(e.chain),l.add(e.assist),d.add(e.core),n.add(e.promotion),h.add(e.mindscape),Mt.base.crit_.add(.05),Mt.base.crit_dmg_.add(.5)]}function Nl(e){return[P.sheet("agg").reread(P.sheet("wengine")),...e?[A.common.count.sheet(e.key).add(1),A.wengine.lvl.add(e.level),A.wengine.modification.add(e.modification),A.wengine.phase.add(e.phase)]:[]]}function Wi(e,t){const{common:{count:n},initial:a}=wc($i,{sheet:"disc",et:"own"});return[P.sheet("agg").reread(P.sheet("disc")),P.withTag({sheet:"disc",qt:"initial"}).reread(P.sheet("dyn")),...Object.entries(e).map(([s,c])=>vc(a,s).sheet("dyn").add(c)),...Object.entries(t).map(([s,c])=>n.sheet(s).add(c))]}function Gl(e){const t={},n={};return e.forEach(({setKey:a,mainStatKey:s,substats:c,level:i,rarity:l})=>{t[a]=(t[a]??0)+1,n[s]=(n[s]??0)+xc(l,s,i),c.forEach(({key:d,upgrades:h})=>{!d||!h||(n[d]=(n[d]??0)+_c(d,l)*h)})}),Wi(n,t)}function Ki(e){const t=P.with("et","team"),{own:n,enemy:a,teamBuff:s,notOwnBuff:c}=P.sheet("agg").withAll("et",[]);return[e.map(i=>P.withTag({et:"target",dst:i}).reread(P.withTag({et:"own",dst:null,src:i}))),e.flatMap(i=>{const l=n.with("src",i);return e.map(d=>l.reread(s.withTag({dst:i,src:d,name:null})))}),e.flatMap(i=>{const l=n.with("src",i);return e.filter(d=>d!==i).map(d=>l.reread(c.withTag({dst:i,src:d,name:null})))}),e.map(i=>a.reread(P.withTag({et:"enemyDeBuff",dst:null,src:i,name:null}))),e.flatMap((i,l)=>{const{stackIn:d,stackTmp:h}=P.withAll("qt",[]),b=P.withTag({src:i,et:"own"});return[b.with("qt","stackTmp").add(yc(d,0,l+1)),b.with("qt","stackOut").add(bc(h.max.with("et","team"),l+1,d))]}),e.map(i=>t.add(P.withTag({src:i,et:"own"})))].flat()}function Ni(e){const t=xi(Tt,e);return new Kl(Tt,kc,t)}function Ul(e){return new Pl(Tt,xi(Tt,e))}function Jl({characterKey:e}){return o(It,{ns:"charNames_gen",key18:e})}function Zl({attribute:e}){return le[e]}function Ql({characterKey:e,onClick:t,charCardConfig:n}){const{level:a=0,promotion:s=0}=Vt(e)??{},c=Q(e),i=n||{cardWidth:"100%",charImgWidth:"100%",iconsSize:1.7,isEditing:!1,charNameWidth:"191px",charNameVariant:"h6",scrollingBgSize:"200px"},l=_.useCallback(()=>e&&(t==null?void 0:t(e)),[e,t]),d=_.useCallback(h=>o(zn,{onClick:l,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:h}),[l]);return o(rt,{children:o(Cc,{condition:!!t,wrapper:d,children:x(G,{sx:{display:"flex",flexDirection:"column",width:i.cardWidth},children:[o(Yl,{characterKey:e,characterStat:c,charCardConfig:i}),o(Xl,{characterKey:e,characterStat:c,promotion:s,level:a,charCardConfig:i})]})})})}function Yl({characterKey:e,characterStat:t,charCardConfig:n}){const{attribute:a,id:s}=t;return x(G,{sx:i=>({width:"100%",height:"100%",position:"relative",display:"flex",background:`${i.palette[a].main}`,zIndex:1,overflow:"hidden"}),children:[x(G,{sx:{position:"absolute",left:"0",right:"0",display:"flex",transform:"rotate(5deg) translateX(-50%)",zIndex:2},children:[o(ho,{characterKey:e,charCardConfig:n}),o(ho,{characterKey:e,charCardConfig:n})]}),o(G,{src:`https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_vertical_painting/role_vertical_painting_${s}.png`,component:Rt?Rt:"img",width:n.charImgWidth,height:"auto",position:"relative",zIndex:"2"})]})}function Xl({characterKey:e,characterStat:t,promotion:n,level:a,charCardConfig:s}){const{t:c}=H("page_characters"),{attribute:i,rarity:l,specialty:d}=t,h=Vt(e);return o(G,{sx:{width:"100%",height:"100%",padding:"8px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:x(G,{sx:{display:"flex",flexDirection:"column"},children:[x(G,{gap:1,sx:{display:"flex",alignItems:"center"},children:[o(W,{size:s.iconsSize,src:_i(l)}),o(R,{variant:s.charNameVariant,sx:{fontWeight:"900",maxWidth:s.charNameWidth,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:o(Jl,{characterKey:e})}),o(Sc,{ele:i,iconProps:{sx:{fontSize:`${s.iconsSize}em`}}}),o(W,{size:s.iconsSize,src:wi(d)}),s.isEditing?"":o(R,{variant:"h5",color:"primary",sx:{fontWeight:"900"},children:c("mindscape",{level:h?h.mindscape:0})})]}),s.isEditing?"":x(G,{sx:{mt:"12px",display:"flex",gap:"14px",flexWrap:"wrap"},children:[x(G,{sx:b=>({border:`2px solid ${b.palette.contentZzz.main}`,borderRadius:"20px",display:"flex"}),children:[o(R,{sx:{fontWeight:"900",paddingLeft:"12px",fontSize:"16px"},children:c("charLevel",{level:a})}),x(R,{color:"primary",sx:{fontWeight:"900",paddingLeft:"4px",pr:"10px"},children:["/ ",vi[n]]})]}),x(G,{gap:1.5,sx:{display:"flex",alignItems:"center"},children:[Bn.map((b,S)=>o(io,{anchorOrigin:{vertical:"bottom",horizontal:"left"},badgeContent:`${h?h[b]:0}`,color:"primary",children:o(W,{size:1.9,src:ee(b)})},S)),o(io,{anchorOrigin:{vertical:"bottom",horizontal:"left"},badgeContent:`${h?h.core:0}`,color:"primary",children:o(W,{size:1.9,src:ee("core")})},6)]})]})]})})}function ho({characterKey:e,charCardConfig:t}){const{t:n}=H("charNames_gen"),a={animation:"scroll 16s infinite linear","@keyframes scroll":{"0%":{transform:"translateX(-100%)"},"100%":{transform:"translateX(0)"}}};return o(G,{component:"span",sx:{color:"#000",marginTop:"20px",fontStyle:"italic",fontSize:t.scrollingBgSize,lineHeight:"150px",whiteSpace:"nowrap",textTransform:"uppercase",display:"flex",justifyContent:"center",fontFamily:"Impact",opacity:.1,...a},children:n(`${e}`)})}function er({mindscape:e,setMindscape:t}){const{t:n}=H("page_characters");return o(M,{sx:{display:"flex",flexWrap:"wrap",gap:2,mt:"12px"},children:En(1,6).map(a=>o(M,{children:o(rt,{sx:{position:"relative",borderRadius:"40px"},children:o(zl,{control:o(Dc,{checked:e>=a,onChange:()=>t(a===e?a-1:a)}),label:x(M,{sx:{position:"absolute",top:9,left:e>=a?75:16,transition:"left 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",textAlign:"center"},children:[o(R,{variant:"subtitle1",sx:s=>({fontWeight:900,color:e>=a?s.palette.mindscapeActive.main:s.palette.mindscapeInactive.main}),children:n("mindscape",{level:a})}),o(R,{variant:"subtitle2",sx:s=>({lineHeight:.2,fontWeight:900,color:e>=a?s.palette.mindscapeActive.main:s.palette.mindscapeInactive.main}),children:n("mindscapeTitle")})]}),sx:{margin:0}})})},a))})}function tr(e){return{new:t=>e.chars.get(t)?0:1,name:t=>ki.t(t).toString(),level:t=>{const n=e.chars.get(t);return n?n.level*(n.promotion+1):0},rarity:t=>Q(t).rarity??0}}function nr(e){return{attribute:(t,n)=>n.includes(Q(t).attribute),specialtyType:(t,n)=>n.includes(Q(t).specialty),rarity:(t,n)=>n.includes(Q(t).rarity),name:(t,n)=>n===void 0||ki.t(t).toLowerCase().includes(n.toLowerCase()),new:(t,n)=>n===void 0||n===(e.chars.get(t)?"no":"yes")}}const Gi={name:["name"],level:["level","rarity","name"],rarity:["rarity","level","name"]};function u$({show:e,onHide:t,onSelect:n,newFirst:a=!1}){const{database:s}=J(),c=Oi(s.displayCharacter),[i,l]=_.useState(""),d=_.useDeferredValue(i),h=_.useDeferredValue(c),b=_.useMemo(()=>{const{attribute:m,specialtyType:y,sortType:v,ascending:C}=h,V=[...a?["new"]:[],...Gi[v]??[]];return Mc.filter(Ci({attribute:m,specialtyType:y,name:d},nr(s))).sort(Tc(V,C,tr(s),["new"]))},[h,a,d,s]);return o(ar,{show:e,charactersToShow:b,filterSearchSortProps:{searchTerm:i,onChangeSpecialtyFilter:m=>{s.displayCharacter.set({specialtyType:m})},onChangeAttributeFilter:m=>{s.displayCharacter.set({attribute:m})},onChangeSearch:m=>{l(m.target.value)},onChangeSort:m=>{s.displayCharacter.set({sortType:m})},onChangeAsc:m=>{s.displayCharacter.set({ascending:m})}},onClose:()=>{l(""),t()},children:o(Y,{sx:{flex:"1",overflow:"auto"},children:o(_.Suspense,{fallback:o(ne,{variant:"rectangular",width:"100%",height:1e3}),children:o(j,{container:!0,spacing:.5,columns:{xs:2,sm:3,md:4,lg:5},children:b.map(m=>o(j,{item:!0,xs:1,children:o(re,{bgt:"light",sx:y=>({position:"relative",flexGrow:1,display:"flex",flexDirection:"column",borderRadius:"40px 16px 16px 40px",border:`3px solid ${y.palette.contentZzz.main}`}),children:o(sr,{characterKey:m,onClick:()=>{t(),n(m)}})})},m))})})})})}const or=Object.keys(Gi);function ar({show:e,charactersToShow:t,filterSearchSortProps:n,onClose:a,children:s}){const{t:c}=H("page_characters"),{database:i}=J(),l=Oi(i.displayCharacter),d=_.useMemo(()=>oo(Si,y=>i.chars.entries.forEach(([v,C])=>{const V=Q(C.key).specialty;y[V].total++,t.includes(v)&&y[V].current++})),[t,i.chars.entries]),h=_.useMemo(()=>oo(at,y=>Object.entries(i.chars.data).forEach(([v])=>{const C=Q(v).attribute;y[C].total++,t.includes(v)&&y[C].current++})),[t,i.chars.data]),{specialtyType:b,attribute:S,sortType:k,ascending:m}=l;return o(On,{open:e,onClose:a,containerProps:{sx:{height:"100vh",p:{xs:1}}},children:x(re,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[x(Y,{sx:{display:"flex",flexDirection:"column",gap:1},children:[x(M,{sx:{display:"flex",justifyContent:"space-between"},children:[x(M,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[o(zc,{onChange:y=>i.displayCharacter.set({specialtyType:y}),value:b,totals:d,size:"small"}),o(Bc,{onChange:y=>i.displayCharacter.set({attribute:y}),value:S,totals:h,size:"small"})]}),o(Pn,{sx:{ml:"auto"},onClick:()=>a(),children:o(Vn,{})})]}),x(M,{display:"flex",gap:1,children:[o(Ec,{autoFocus:!0,value:n.searchTerm,onChange:y=>n.onChangeSearch(y),label:c("characterName"),size:"small",sx:{height:"100%",mr:"auto"},InputProps:{sx:{height:"100%"}}}),o(Pc,{sortKeys:or,value:k,onChange:y=>n.onChangeSort(y),ascending:m,onChangeAsc:y=>n.onChangeAsc(y)})]})]}),o(ct,{}),s]})})}function sr({characterKey:e,onClick:t}){const{t:n}=H(["page_characters","charNames_gen"]),a=Ic(),s=Vt(e),{rarity:c,attribute:i}=Q(e),{level:l=1,promotion:d=0,mindscape:h=0}=s??{},b=i==="electric"?a.palette[i].light:a.palette[i].main;return o(zn,{onClick:t,children:x(M,{sx:{position:"relative",width:"100%",display:"flex",padding:"3px",gap:.5,"&::before":{content:'""',display:"block",position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:.7,background:b}},children:[o(M,{sx:{maxWidth:{xs:"33%",lg:"30%"},alignSelf:"flex-end",display:"flex",flexDirection:"column",zIndex:1,flexShrink:1},children:o(M,{component:Rt?Rt:"img",src:Rc(e,"interknot")})}),x(M,{sx:{display:"flex",flexDirection:"column",zIndex:1,justifyContent:"space-evenly"},children:[x(M,{sx:{display:"flex",alignItems:"center",gap:.5},children:[o(W,{size:1.5,src:_i(c)}),o(R,{variant:"subtitle2",sx:S=>({flexGrow:1,color:S.palette.contentNormal.main,fontWeight:"900"}),children:n(`charNames_gen:${e}`)})]}),s?x(M,{sx:S=>({display:"flex",gap:1,alignItems:"center",background:S.palette.contentNormal.main,padding:"4px 12px",borderRadius:"20px"}),children:[x(M,{sx:{textShadow:"0 0 5px gray"},children:[o(R,{variant:"body2",component:"span",whiteSpace:"nowrap",children:n("charLevel",{level:l})}),x(R,{variant:"body2",component:"span",color:"text.secondary",children:["/",vi[d]]})]}),x(R,{variant:"body2",children:["M",h]})]}):o(R,{component:"span",variant:"body2",children:o(Tn,{color:"electric",children:n("characterEditor.new")})})]})]})})}function ir(){const{t:e}=H("page_characters"),{database:t}=J(),n=Pt(),{core:a=0,promotion:s=0,key:c}=n??{},i=_.useCallback(l=>c&&t.chars.set(c,{core:l}),[t,c]);return o(Mi,{fullWidth:!0,title:e("core",{level:a}),color:"primary",startIcon:o(W,{src:ee("core"),size:1.75,sideMargin:!0}),children:En(0,Vc[s]).map(l=>o(Di,{selected:a===l,disabled:a===l,onClick:()=>i(l),children:e("core",{level:l})},l))})}const cr={xs:2*3,sm:2*3,md:3*3,lg:4*3,xl:4*3};function Ui({disc:e,onChangeId:t,slotKey:n,show:a,onClose:s}){const{t:c}=H(["page_characters","disc"]),{database:i}=J(),l=e==null?void 0:e.id,d=_.useCallback((T,I)=>({...T,...I,slotKeys:[n]}),[n]),[h,b]=_.useReducer(d,{...bl(),slotKeys:[n]}),[S,k]=Oc();_.useEffect(()=>i.discs.followAny(k),[i,k]);const m=Ac(),y=_.useMemo(()=>xl(),[]),v=i.discs.values.filter(T=>T.slotKey===h.slotKeys[0]).length,C=_.useMemo(()=>{const T=Ci(h,y);let I=i.discs.values.filter(T).map(ae=>ae.id);return l&&i.discs.get(l)&&(I=I.filter(ae=>ae!==l),I.unshift(l)),S&&I},[h,y,i.discs,l,S]),{numShow:V,setTriggerElement:K}=qc(cr[m],C.length),N=_.useMemo(()=>C.slice(0,V),[C,V]),Z=C.length!==v?`${C.length}/${v}`:`${v}`,F={numShowing:N.length,total:Z,t:c,namespace:"disc"},[O,q]=_.useState("");return _.useEffect(()=>{Fc.includes(O)?(t(null),q(""),s()):O&&(t(O),q(""),s())},[t,s,O]),o(On,{open:a,onClose:s,containerProps:{maxWidth:"xl"},children:x(re,{children:[x(Y,{sx:{py:1,display:"flex",alignItems:"center"},children:[o(R,{variant:"h6",children:c("tabEquip.swapDisc")}),o(Pn,{onClick:s,sx:{ml:"auto"},children:o(Vn,{})})]}),o(ct,{}),o(Y,{children:o(_.Suspense,{fallback:o(ne,{variant:"rectangular",width:"100%",height:200}),children:o(Lc,{filterOption:h,filterOptionDispatch:b,filteredIds:C,disableSlotFilter:!0})})}),o(ct,{}),x(Y,{children:[o(M,{pb:1,display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:o(jc,{showingTextProps:F})}),o(M,{mt:1,children:o(_.Suspense,{fallback:o(ne,{variant:"rectangular",width:"100%",height:1e3}),children:x(j,{container:!0,spacing:1,columns:{xs:2,md:3,lg:4},children:[l&&o(j,{item:!0,xs:1,children:o(re,{bgt:"light",sx:{width:"100%",height:"100%"},children:o(zn,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>q(n),children:x(M,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[o(Hc,{sx:{fontSize:"10em"}}),o(R,{children:c("disc:button.unequipDisc")})]})})})}),N.map(T=>o(j,{item:!0,xs:1,sx:I=>({...l===T&&{"> .MuiCard-root":{outline:`${I.spacing(.5)} solid ${I.palette.warning.main}`}}}),children:o(Ti,{disc:i.discs.get(T),onClick:l===T?void 0:()=>q(T)})},T))]})})}),C.length!==N.length&&o(ne,{ref:T=>{T&&K(T)},sx:{borderRadius:1,mt:1},variant:"rectangular",width:"100%",height:100})]})]})})}function lr(e){return"fieldRef"in e}var nt={},uo;function rr(){if(uo)return nt;uo=1;var e=Wc();Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=void 0;var t=e(Kc()),n=Nc(),a=(0,t.default)((0,n.jsx)("path",{d:"M6.99 11 3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"}),"SwapHoriz");return nt.default=a,nt}var dr=rr();const ut=Gc(dr),hr={xs:1,sm:2,md:3,lg:3,xl:3};function ur({setWengine:e,setDisc:t}){const{database:n}=J(),a=_.useContext(Ii),[s,c]=_.useState(),[i,l]=_.useState(""),d=_.useCallback(y=>{l(y)},[]),h=_.useCallback(y=>{c(y)},[]),b=Ri(a==null?void 0:a.equippedWengine),S=a?Q(a.key).specialty:Si[0],k=zi(a==null?void 0:a.equippedDiscs),m=ql(s);return o(M,{children:x(gi,{spacing:2,children:[o(_.Suspense,{fallback:!1,children:i&&o(Uc,{wengineId:i,footer:!0,onClose:()=>l(""),extraButtons:o($r,{wengineId:(b==null?void 0:b.id)||"",wengineTypeKey:S,onChangeId:e})})}),o(_.Suspense,{fallback:!1,children:m&&o(Jc,{disc:m,show:!!s,onShow:()=>c(s),onClose:()=>c(void 0),cancelEdit:()=>c(void 0)})}),o(M,{children:b&&b.id&&n.wengines.keys.includes(b.id)?o(Zc,{wengineId:b.id,onEdit:()=>d(b.id),extraButtons:o(fr,{wengineId:b.id,wengineTypeKey:S,onChangeId:e})}):o(pr,{wengineId:"",wengineTypeKey:S,onChangeId:e})}),o(M,{children:o(j,{item:!0,columns:hr,container:!0,spacing:1,children:!!k&&Object.entries(k).map(([y,v])=>o(j,{item:!0,xs:1,children:v!=null&&v.id&&n.discs.keys.includes(v.id)?o(Ti,{disc:v,extraButtons:o(mr,{disc:v,slotKey:y,onChangeId:C=>t(y,C)}),onEdit:()=>h(v.id),onLockToggle:()=>n.discs.set(v.id,({lock:C})=>({lock:!C}))}):o(gr,{slotKey:y,onChangeId:C=>t(y,C)})},(v==null?void 0:v.id)||y))})})]})})}function pr({wengineId:e,wengineTypeKey:t,onChangeId:n}){const[a,s,c]=dt();return x(rt,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[o(Y,{children:x(R,{children:[o(W,{src:wi(t)})," "]})}),o(ct,{}),x(M,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[o(An,{wengineId:e,wengineTypeKey:t,show:a,onClose:c,onChangeId:n}),o(de,{onClick:s,color:"info",sx:{borderRadius:"1em"},children:o(ut,{sx:{height:100,width:100}})})]})]})}function gr({slotKey:e,onChangeId:t}){const[n,a,s]=dt(),{t:c}=H("disc");return x(rt,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[o(Y,{children:o(R,{children:c("slotName",{slotKey:e})})}),o(ct,{}),x(M,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[o(Ui,{disc:void 0,slotKey:e,show:n,onClose:s,onChangeId:t}),o(de,{onClick:a,color:"info",sx:{borderRadius:"1em"},children:o(ut,{sx:{height:100,width:100}})})]})]})}function mr({disc:e,slotKey:t,onChangeId:n}){const{t:a}=H("page_characters"),[s,c,i]=dt();return x(ht,{children:[o(Bi,{title:o(R,{children:a("tabEquip.swapDisc")}),placement:"top",arrow:!0,children:o(de,{color:"info",size:"small",onClick:c,"aria-label":a("tabEquip.swapDisc"),children:o(ut,{})})}),o(Ui,{disc:e,slotKey:t,show:s,onClose:i,onChangeId:n})]})}function fr({wengineId:e,wengineTypeKey:t,onChangeId:n}){const{t:a}=H("page_characters"),[s,c,i]=dt();return x(ht,{children:[o(Bi,{title:o(R,{children:a("tabEquip.swapWengine")}),placement:"top",arrow:!0,children:o(de,{color:"info",size:"small",onClick:c,children:o(ut,{})})}),o(An,{wengineId:e,wengineTypeKey:t,onChangeId:n,show:s,onClose:i})]})}function $r({wengineId:e,wengineTypeKey:t,onChangeId:n}){const{t:a}=H("page_characters"),[s,c,i]=dt();return x(ht,{children:[o(de,{color:"info",onClick:c,startIcon:o(ut,{}),children:a("tabEquip.swapWengine")}),o(An,{wengineId:e,wengineTypeKey:t,onChangeId:n,show:s,onClose:i})]})}function yr({skillKey:e}){const{database:t}=J(),{t:n}=H("page_characters"),a=Pt(),{[e]:s=0,promotion:c=0,key:i}=a??{},l=_.useCallback(d=>i&&t.chars.set(i,{[e]:d}),[t,i,e]);return o(Mi,{fullWidth:!0,title:n(e,{level:s}),color:"primary",startIcon:o(W,{src:ee(e),size:1.75,sideMargin:!0}),children:En(1,Qc[c]).map(d=>o(Di,{selected:s===d,disabled:s===d,onClick:()=>l(d),children:n(e,{level:d})},d))})}function Ot(){const e=_.useContext(qn),t=_.useContext(Yc);return _.useMemo(()=>e==null?void 0:e.withTag(t),[e,t])}const br=(e,t)=>o(It,{ns:"sheet",key18:e,values:t});function u(e,t){return[(n,a)=>o(It,{ns:`${e}_${t}_gen`,key18:n,values:a}),(n,a)=>o(It,{ns:`${e}_${t}`,key18:n,values:a})]}function r(e){return{title:o(At,{tag:e}),fieldRef:e}}function xr(e){if(!e)return"";const{et:t,q:n,qt:a,name:s}=e;return t==="own"&&a==="formula"&&n!=="base"?s??n??"":n??""}const _r={initial:"Initial",combat:"Combat",final:"Final",base:"Base"};function At({tag:e,showPercent:t,preventRecursion:n}){return o(st,{color:o$(e),children:o(kr,{tag:e,showPercent:t,preventRecursion:n})})}function p$({tag:e,showPercent:t}){return x(ht,{children:[o(At,{tag:e,showPercent:t}),s$(e).map(n=>o(Tn,{children:Bt[n]},n)),e.attribute&&o(Tn,{color:e.attribute,children:o(Zl,{attribute:e.attribute})})]})}const wr=["hp","hp_","atk","atk_","def","def_"],vr=e=>wr.includes(e),po={dmg_:"DMG",common_dmg_:"DMG",defIgn_:"DEF Ignore",resIgn_:"Res Ignore"};function kr({tag:e,showPercent:t,preventRecursion:n}){var i;const a=Ot(),s=(i=i$.subset(e)[0])==null?void 0:i.title;if(s&&!n)return s;if(e.qt==="cond"&&e.q&&e.sheet&&a){const l=In.get(`${e.sheet}:${e.q}`);if(l)return Xc(l.label,a,a==null?void 0:a.compute(new el(e,"max")).val)}const c=xr(e);if(vr(c))return x("span",{children:[o(nl,{statKey:c,iconProps:tl})," ",x("span",{children:[(e.qt&&_r[e.qt])??e.qt," ",ol[c],t&&Ei(c)]})]});if(po[c]){const l=[...e.attribute?[le[e.attribute]]:[],...e.damageType1?[Bt[e.damageType1]]:[],...e.damageType2?[Bt[e.damageType2]]:[],po[c]];return o("span",{children:l.join(" ")})}return o(Ct,{statKey:c,showPercent:t})}function Cr(){const e=Ot();return o(rt,{children:o(Y,{children:e==null?void 0:e.listFormulas(A.listing.formulas).map((t,n)=>o(Sr,{read:t},n))})})}function Sr({read:e}){var v,C,V,K,N,Z,F;const t=Ot(),{setRead:n}=_.useContext(al),a=Pt(),s=Al(a==null?void 0:a.key),c=e.tag.sheet===((v=s==null?void 0:s.target)==null?void 0:v.sheet)&&e.tag.name===((C=s==null?void 0:s.target)==null?void 0:C.name)||((V=s==null?void 0:s.target)==null?void 0:V.q)===e.tag.q,i=_.useMemo(()=>{var O,q,T,I;return e.tag.sheet===((O=s==null?void 0:s.target)==null?void 0:O.sheet)&&e.tag.name===((q=s==null?void 0:s.target)==null?void 0:q.name)?sl(e.tag,(T=s==null?void 0:s.target)==null?void 0:T.damageType1,(I=s==null?void 0:s.target)==null?void 0:I.damageType2):e.tag},[e.tag,(K=s==null?void 0:s.target)==null?void 0:K.sheet,(N=s==null?void 0:s.target)==null?void 0:N.name,(Z=s==null?void 0:s.target)==null?void 0:Z.damageType1,(F=s==null?void 0:s.target)==null?void 0:F.damageType2]),l=_.useMemo(()=>({...e,tag:i}),[i,e]),d=t==null?void 0:t.compute(l),h=i.name||i.q,{statHighlight:b,setStatHighlight:S}=_.useContext(il),k=i.name?"":i.attribute?`${i.attribute}_${i.q}`:i.q==="cappedCrit_"?"crit_":i.q,m=k?cl(b,k):!1;if(!d)return null;const y=ll(d.val,Ei(h??""));return x(M,{onMouseEnter:()=>k&&S(k),onMouseLeave:()=>S(""),sx:{display:"flex",gap:1,alignItems:"center",p:.5,borderRadius:.5,backgroundColor:c?"rgba(0,200,0,0.2)":void 0,position:"relative","::after":{content:'""',position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:.5,backgroundColor:rl(m),transition:"background-color 0.3s ease-in-out",pointerEvents:"none"}},children:[o(M,{sx:{flexGrow:1},children:o(At,{tag:i})}),y,o(dl,{tag:i,onClick:()=>{n(l)}})]})}function g$({characterKey:e,onClose:t}){return o(On,{open:!!e,onClose:t,children:o(_.Suspense,{fallback:o(ne,{variant:"rectangular",width:"100%",height:1e3}),children:e&&o(Dr,{characterKey:e,onClose:t},e)})})}function Dr({characterKey:e,onClose:t}){const n=Vt(e);return o(re,{children:o(Y,{sx:{display:"flex",flexDirection:"column",gap:1},children:o(_.Suspense,{fallback:o(ne,{variant:"rectangular",width:"100%",height:1e3}),children:n?o(Ii.Provider,{value:n,children:o(Tr,{onClose:t})}):o(ne,{variant:"rectangular",width:"100%",height:1e3})})})})}const Mr={cardWidth:"500px",charImgWidth:"75%",iconsSize:1.5,isEditing:!0,charNameWidth:"166px",charNameVariant:"h6",scrollingBgSize:"220px"};function Tr({onClose:e}){const{t}=H(["page_characters"]),n=hl(),{database:a}=J(),s=Pt(),{key:c,equippedDiscs:i,equippedWengine:l}=s,d=_.useCallback(async()=>{const h=t(`${c}`);window.confirm(t("removeCharacter",{value:h}))&&(a.chars.remove(c),n("/characters"))},[a,n,c,t]);return x(M,{display:"flex",flexDirection:"column",gap:1,children:[x(M,{display:"flex",gap:1,children:[o(de,{color:"error",onClick:()=>d(),startIcon:o(ul,{}),sx:{marginLeft:"auto"},children:t("characterEditor.delete")}),!!e&&o(Pn,{onClick:e,children:o(Vn,{})})]}),o(M,{children:x(j,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[o(j,{item:!0,xs:6,sm:4,md:4,lg:4,xl:4,children:x(re,{sx:{height:"100%",display:"flex",flexDirection:"column",gap:1},children:[o(Ql,{characterKey:c,charCardConfig:Mr}),o(M,{sx:{px:1},children:o(pl,{level:s.level,milestone:s.promotion,setBoth:({level:h,milestone:b})=>a.chars.set(c,{level:h,promotion:b})})}),o(Cr,{}),o(er,{mindscape:s.mindscape,setMindscape:h=>a.chars.set(c,{mindscape:h})})]})}),x(j,{item:!0,xs:6,sm:8,md:8,lg:8,xl:8,sx:{display:"flex",flexDirection:"column",gap:1},children:[o(M,{children:x(j,{container:!0,columns:3,spacing:1,children:[Bn.map(h=>o(j,{item:!0,xs:1,children:o(yr,{skillKey:h},h)},h)),o(j,{item:!0,xs:1,children:o(ir,{})},"core")]})}),o(M,{children:o(ur,{setWengine:h=>{h?a.wengines.set(h,{location:c}):l&&a.wengines.set(l,{location:""})},setDisc:(h,b)=>{b?a.discs.set(b,{location:c}):i[h]&&a.discs.set(i[h],{location:""})}})})]})]})})]})}function m$({character:e,charOpt:t,wengineId:n,discIds:a,children:s}){const c=Ir(e,n,a),i=_.useMemo(()=>Ni([...Ki([e.key]),...c,Mt.common.critMode.add(t.critMode),U.common.lvl.add(t.enemyLvl),U.common.def.add(t.enemyDef),U.common.isStunned.add(t.enemyisStunned?1:0),U.common.stun_.add(t.enemyStunMultiplier/100),U.common.unstun_.add(1),...t.conditionals.flatMap(({sheet:d,src:h,dst:b,condKey:S,condValue:k})=>St("preset0",Pi(d,h,b)(S,k))),...t.bonusStats.filter(({disabled:d})=>!d).flatMap(({tag:d,value:h})=>St("preset0",{tag:{...d,src:e.key,sheet:"agg",et:"own"},value:ao(so(h,d.q??""))})),...t.enemyStats.flatMap(({tag:d,value:h})=>St("preset0",{tag:{...d,qt:"common",et:"enemy",sheet:"agg"},value:ao(so(h,d.q??""))}))]),[c,t,e.key]),l=_.useMemo(()=>i&&new Map,[i]);return o(gl.Provider,{value:l,children:o(qn.Provider,{value:i,children:s})})}function Ir(e,t,n){const a=Ri(t),s=zi(n),c=_.useMemo(()=>Nl(a),[a]),i=_.useMemo(()=>Gl(Object.values(s).filter(ml)),[s]);return _.useMemo(()=>ji(e.key,...Hi(e),...c,...i),[e,c,i])}function f$({character:e,conditionals:t,children:n}){const a=_.useMemo(()=>Ni([...Ki([e.key]),...ji(e.key,...Hi(e),...Wi({},Vi(bi,()=>4)),P.sheet("agg").reread(P.sheet("wengine")),A.wengine.lvl.add(60),A.wengine.modification.add(5),A.wengine.phase.add(1),...yi.map(s=>A.common.count.sheet(s).add(1))),Mt.common.critMode.add("avg"),U.common.lvl.add(100),U.common.def.add(900),U.common.isStunned.add(0),U.common.stun_.add(1.5),U.common.unstun_.add(1),...t.flatMap(({sheet:s,src:c,dst:i,condKey:l,condValue:d})=>St("preset0",Pi(s,c,i)(l,d)))]),[e,t]);return o(qn.Provider,{value:a,children:n})}function D(e,t={}){return{...Rr(e,t==null?void 0:t.perSkillAbility),core:Br(e,t==null?void 0:t.core,t==null?void 0:t.ability),m1:se(e,1,t==null?void 0:t.m1),m2:se(e,2,t==null?void 0:t.m2),m3:se(e,3,t==null?void 0:t.m3),m4:se(e,4,t==null?void 0:t.m4),m5:se(e,5,t==null?void 0:t.m5),m6:se(e,6,t==null?void 0:t.m6)}}function ot(e){return{title:o(At,{tag:e.tag,preventRecursion:!0}),fieldRef:e.tag}}function Rr(e,t){const n=w.char[e],a=Fn[e],[s,c]=u("char",e);return Vi(Bn,i=>({title:i,img:ee(`${i}Flat`),documents:Object.keys(n[i]).flatMap(l=>{var d;return[{type:"text",header:{icon:o(W,{src:ee(`${i}Flat`),size:1.5}),text:s(`${i}.${l}.name`)},text:s(`${i}.${l}.desc`)},{type:"fields",fields:Object.values(a).filter(h=>h.name.includes(l)).map(h=>({title:zr(e,i,h.name),fieldRef:h.tag}))},...((d=t==null?void 0:t[i])==null?void 0:d[l])??[]]})}))}function zr(e,t,n){const[a,s,c]=n.split("_");return br(c,{val:`$t(char_${e}_gen:${t}.${a}.params.${s})`})}function Br(e,t=[],n=[]){const[a,s]=u("char",e);return{title:"core",documents:[{type:"text",header:{icon:o(W,{src:ee("coreFlat"),size:1.5}),text:a("core.name")},text:c=>a(`core.desc.${c.compute(A.char.core).val}`)},...t,{type:"text",header:{icon:o(W,{src:ee("coreFlat"),size:1.5}),text:a("ability.name")},text:a("ability.desc")},...n]}}function se(e,t,n=[]){const[a,s]=u("char",e);return{title:`mindscape${t}`,documents:[{type:"text",header:{icon:o(W,{src:fl(t),size:1.5}),text:a(`mindscapes.${t}.name`)},text:x(ht,{children:[a(`mindscapes.${t}.desc`),o("br",{}),o("br",{}),o("i",{children:a(`mindscapes.${t}.flavor`)})]})},...n]}}const qt="Anby",[,vt]=u("char",qt),un=g[qt],ie=p[qt],Er=D(qt,{core:[{type:"conditional",conditional:{label:vt("coreCond"),metadata:un.core_after3rdBasic,fields:[{title:vt("core_dazeInc_"),fieldRef:ie.core_after3rdBasic_dazeInc_.tag}]}}],m1:[{type:"conditional",conditional:{label:vt("m1Cond"),metadata:un.m1After4thBasicHit,fields:[ot(ie.m1_after4thHit_energyRegen_)]}}],m2:[{type:"fields",fields:[ot(ie.m2_stunned_basic_dmg_),ot(ie.m2_unstunned_ex_dazeInc_)]}],m6:[{type:"conditional",conditional:{label:vt("m6Cond"),metadata:un.m6ChargeConsumed,fields:[ot(ie.m6_charge_basic_dmg_),ot(ie.m6_charge_exSpecial_dmg_)]}}]}),Pr="Anton",Vr=D(Pr),Or="Astra",Ar=D(Or),qr="Ben",Fr=D(qr),Lr="Billy",jr=D(Lr),Hr="Burnice",Wr=D(Hr),Kr="Caesar",Nr=D(Kr),Gr="Corin",Ur=D(Gr),Jr="Ellen",Zr=D(Jr),Qr="Evelyn",Yr=D(Qr),Xr="Grace",ed=D(Xr),td="Harumasa",nd=D(td),od="Hugo",ad=D(od),sd="Jane",id=D(sd),cd="Koleda",ld=D(cd),rd="Lighter",dd=D(rd),hd="Lucy",ud=D(hd),pd="Lycaon",gd=D(pd),md="Miyabi",fd=D(md),$d="Nekomata",yd=D($d),bd="Nicole",xd=D(bd),_d="Piper",wd=D(_d),vd="Pulchra",kd=D(vd),Cd="QingYi",Sd=D(Cd),Dd="Rina",Md=D(Dd),Td="Seth",Id=D(Td),Rd="Soldier0Anby",zd=D(Rd),Bd="Soldier11",Ed=D(Bd),Pd="Soukaku",Vd=D(Pd),Od="Trigger",Ad=D(Od),qd="Vivian",Fd=D(qd),Ld="Yanagi",jd=D(Ld),Hd="ZhuYuan",Wd=D(Hd),Kd={Anby:Er,Anton:Vr,Astra:Ar,Ben:Fr,Billy:jr,Burnice:Wr,Caesar:Nr,Corin:Ur,Ellen:Zr,Evelyn:Yr,Grace:ed,Harumasa:nd,Hugo:ad,Jane:id,Koleda:ld,Lighter:dd,Lucy:ud,Lycaon:gd,Miyabi:fd,Nekomata:yd,Nicole:xd,Piper:wd,Pulchra:kd,QingYi:Sd,Rina:Md,Seth:Id,Soldier0Anby:zd,Soldier11:Ed,Soukaku:Vd,Trigger:Ad,Vivian:Fd,Yanagi:jd,ZhuYuan:Wd},Ft="AstralVoice",[go,Nd]=u("disc",Ft),mo=z(Ft),Gd=g[Ft],Ud=p[Ft],Jd={2:{title:o(B,{}),img:mo,documents:[{type:"text",text:go("desc2")}]},4:{title:o(E,{}),img:mo,documents:[{type:"text",text:go("desc4")},{type:"conditional",conditional:{label:Nd("set4_cond"),metadata:Gd.astral,fields:[r(Ud.set4_team_dmg_.tag)]}}]}},Lt="BranchBladeSong",[fo,Zd]=u("disc",Lt),$o=z(Lt),Qd=g[Lt],yo=p[Lt],Yd={2:{title:o(B,{}),img:$o,documents:[{type:"text",text:fo("desc2")}]},4:{title:o(E,{}),img:$o,documents:[{type:"text",text:fo("desc4")},{type:"fields",fields:[r(yo.set4_passive.tag)]},{type:"conditional",conditional:{label:Zd("set4_cond"),metadata:Qd.apply_or_trigger,fields:[r(yo.set4_cond.tag)]}}]}},jt="ChaosJazz",[bo,Xd]=u("disc",jt),xo=z(jt),eh=g[jt],kt=p[jt],th={2:{title:o(B,{}),img:xo,documents:[{type:"text",text:bo("desc2")}]},4:{title:o(E,{}),img:xo,documents:[{type:"text",text:bo("desc4")},{type:"fields",fields:[r(kt.set4_passive_fire_dmg_.tag),r(kt.set4_passive_electric_dmg_.tag)]},{type:"conditional",conditional:{label:Xd("set4_cond"),metadata:eh.while_off_field,fields:[{title:"EX Special Attack DMG",fieldRef:kt.set4_off_field_special_dmg_.tag},{title:"Assist Attack Attack DMG",fieldRef:kt.set4_off_field_assist_dmg_.tag}]}}]}},Ht="ChaoticMetal",[_o,nh]=u("disc",Ht),wo=z(Ht),oh=g[Ht],vo=p[Ht],ah={2:{title:o(B,{}),img:wo,documents:[{type:"text",text:_o("desc2")}]},4:{title:o(E,{}),img:wo,documents:[{type:"text",text:_o("desc4")},{type:"fields",fields:[r(vo.set4_passive.tag)]},{type:"conditional",conditional:{label:nh("set4_cond"),metadata:oh.trigger_corruption,fields:[r(vo.set4_cond_trigger_corruption.tag)]}}]}},Wt="FangedMetal",[ko,sh]=u("disc",Wt),Co=z(Wt),ih=g[Wt],ch=p[Wt],lh={2:{title:o(B,{}),img:Co,documents:[{type:"text",text:ko("desc2")}]},4:{title:o(E,{}),img:Co,documents:[{type:"text",text:ko("desc4")},{type:"conditional",conditional:{label:sh("set4_cond"),metadata:ih.inflict_assault,fields:[r(ch.set4_cond_inflict_assault.tag)]}}]}},Kt="FreedomBlues",[So,rh]=u("disc",Kt),Do=z(Kt),dh=g[Kt],hh=p[Kt],uh={2:{title:o(B,{}),img:Do,documents:[{type:"text",text:So("desc2")}]},4:{title:o(E,{}),img:Do,documents:[{type:"text",text:So("desc4")},{type:"conditional",conditional:{label:rh("set4_cond"),metadata:dh.exSpecialHit,fields:[r(hh.anomBuildupRes_.tag)]}}]}},Nt="HormonePunk",[Mo,ph]=u("disc",Nt),To=z(Nt),gh=g[Nt],mh=p[Nt],fh={2:{title:o(B,{}),img:To,documents:[{type:"text",text:Mo("desc2")}]},4:{title:o(E,{}),img:To,documents:[{type:"text",text:Mo("desc4")},{type:"conditional",conditional:{label:ph("set4_cond"),metadata:gh.entering_combat,fields:[r(mh.set4_cond_entering_combat.tag)]}}]}},Gt="InfernoMetal",[Io,$h]=u("disc",Gt),Ro=z(Gt),yh=g[Gt],bh=p[Gt],xh={2:{title:o(B,{}),img:Ro,documents:[{type:"text",text:Io("desc2")}]},4:{title:o(E,{}),img:Ro,documents:[{type:"text",text:Io("desc4")},{type:"conditional",conditional:{label:$h("set4_cond"),metadata:yh.hitting_burning_enemy,fields:[r(bh.set4_cond_hitting_burning_enemy.tag)]}}]}},Ut="PhaethonsMelody",[zo,Bo]=u("disc",Ut),Eo=z(Ut),Po=g[Ut],Vo=p[Ut],_h={2:{title:o(B,{}),img:Eo,documents:[{type:"text",text:zo("desc2")}]},4:{title:o(E,{}),img:Eo,documents:[{type:"text",text:zo("desc4")},{type:"conditional",conditional:{label:Bo("set4_cond_squad_use_ex"),metadata:Po.squad_use_ex,fields:[r(Vo.set4_squad_anomProf.tag)]}},{type:"conditional",conditional:{label:Bo("set4_cond_not_char_use_ex"),metadata:Po.not_char_use_ex,fields:[r(Vo.set4_not_self_ether_.tag)]}}]}},Jt="PolarMetal",[Oo,wh]=u("disc",Jt),Ao=z(Jt),vh=g[Jt],qo=p[Jt],kh={2:{title:o(B,{}),img:Ao,documents:[{type:"text",text:Oo("desc2")}]},4:{title:o(E,{}),img:Ao,documents:[{type:"text",text:Oo("desc4")},{type:"conditional",conditional:{label:wh("set4_cond"),metadata:vh.freeze_shatter}},{type:"fields",fields:[{title:"Basic Attack DMG",fieldRef:qo.set4_basic_dmg_.tag},{title:"Dash Attack DMG",fieldRef:qo.set4_dash_dmg_.tag}]}]}},Zt="ProtoPunk",[Fo,Ch]=u("disc",Zt),Lo=z(Zt),Sh=g[Zt],Dh=p[Zt],Mh={2:{title:o(B,{}),img:Lo,documents:[{type:"text",text:Fo("desc2")}]},4:{title:o(E,{}),img:Lo,documents:[{type:"text",text:Fo("desc4")},{type:"conditional",conditional:{label:Ch("set4_cond"),metadata:Sh.def_assist_or_evasive_assist,fields:[r(Dh.set4_cond_def_assist_or_evasive_assist_dmg_.tag)]}}]}},Qt="PufferElectro",[jo,Th]=u("disc",Qt),Ho=z(Qt),Ih=g[Qt],Wo=p[Qt],Rh={2:{title:o(B,{}),img:Ho,documents:[{type:"text",text:jo("desc2")}]},4:{title:o(E,{}),img:Ho,documents:[{type:"text",text:jo("desc4")},{type:"fields",fields:[{title:"Ultimate DMG",fieldRef:Wo.set4_dmg_.tag}]},{type:"conditional",conditional:{label:Th("set4_cond"),metadata:Ih.launching_ult,fields:[r(Wo.set4_cond_launching_ult_atk_.tag)]}}]}},Yt="ShadowHarmony",[Ko,zh]=u("disc",Yt),No=z(Yt),Bh=g[Yt],Go=p[Yt],Eh={2:{title:o(B,{}),img:No,documents:[{type:"text",text:Ko("desc2")}]},4:{title:o(E,{}),img:No,documents:[{type:"text",text:Ko("desc4")},{type:"conditional",conditional:{label:zh("set4_cond_stacks"),metadata:Bh.stacks,fields:[r(Go.set4_stack_atk_.tag),r(Go.set4_stack_crit_.tag)]}}]}},Hn="ShockstarDisco",[Uo,$$]=u("disc",Hn),Jo=z(Hn),pn=p[Hn],Ph={2:{title:o(B,{}),img:Jo,documents:[{type:"text",text:Uo("desc2")}]},4:{title:o(E,{}),img:Jo,documents:[{type:"text",text:Uo("desc4")},{type:"fields",fields:[{title:"Basic Attack Daze",fieldRef:pn.set4_basic_daze_.tag},{title:"Dash Attack Daze",fieldRef:pn.set4_dash_daze_.tag},{title:"Dodge Counter Daze",fieldRef:pn.set4_dodgeCounter_daze_.tag}]}]}},Ji="SoulRock",[Zo,y$]=u("disc",Ji),Qo=z(Ji),Vh={2:{title:o(B,{}),img:Qo,documents:[{type:"text",text:Zo("desc2")}]},4:{title:o(E,{}),img:Qo,documents:[{type:"text",text:Zo("desc4")}]}},Xt="SwingJazz",[Yo,Oh]=u("disc",Xt),Xo=z(Xt),Ah=g[Xt],qh=p[Xt],Fh={2:{title:o(B,{}),img:Xo,documents:[{type:"text",text:Yo("desc2")}]},4:{title:o(E,{}),img:Xo,documents:[{type:"text",text:Yo("desc4")},{type:"conditional",conditional:{label:Oh("set4_cond"),metadata:Ah.chain_or_ult,fields:[r(qh.set4_cond_chain_or_ult.tag)]}}]}},en="ThunderMetal",[ea,Lh]=u("disc",en),ta=z(en),jh=g[en],Hh=p[en],Wh={2:{title:o(B,{}),img:ta,documents:[{type:"text",text:ea("desc2")}]},4:{title:o(E,{}),img:ta,documents:[{type:"text",text:ea("desc4")},{type:"conditional",conditional:{label:Lh("set4_cond"),metadata:jh.enemy_shocked,fields:[r(Hh.set4_cond_enemy_shocked_atk_.tag)]}}]}},tn="WoodpeckerElectro",[na,Kh]=u("disc",tn),oa=z(tn),Nh=g[tn],Gh=p[tn],Uh={2:{title:o(B,{}),img:oa,documents:[{type:"text",text:na("desc2")}]},4:{title:o(E,{}),img:oa,documents:[{type:"text",text:na("desc4")},{type:"conditional",conditional:{label:Kh("set4_cond"),metadata:Nh.crit_basic_dodge_ex,fields:[r(Gh.set4_cond_crit_basic_dodge_ex_atk_.tag)]}}]}},Jh={AstralVoice:Jd,BranchBladeSong:Yd,ChaosJazz:th,ChaoticMetal:ah,FangedMetal:lh,FreedomBlues:uh,HormonePunk:fh,InfernoMetal:xh,PhaethonsMelody:_h,PolarMetal:kh,ProtoPunk:Mh,PufferElectro:Rh,ShadowHarmony:Eh,ShockstarDisco:Ph,SoulRock:Vh,SwingJazz:Fh,ThunderMetal:Wh,WoodpeckerElectro:Uh};function B(){return"2-Set"}function E(){return"4-Set"}function f({wKey:e,children:t}){const n=Ot();let a=1;return n&&n.compute(A.common.count.sheet(e)).val&&(a=n.compute(A.wengine.phase).val??1),t(a)}const he="BashfulDemon",[aa,Zh]=u("wengine",he),Qh=w.wengine[he],Yh=$(he,"icon"),Xh=g[he],sa=p[he],eu={title:aa("phase"),img:Yh,documents:[{type:"text",text:o(f,{wKey:he,children:e=>aa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(sa.passive_ice_dmg_.tag)]},{type:"conditional",conditional:{label:Zh("cond"),metadata:Xh.launch_ex_attack,fields:[r(sa.team_atk_.tag),{title:"Duration",fieldValue:Qh.duration}]}}]},ue="BigCylinder",[ia,b$]=u("wengine",ue),tu=w.wengine[ue],nu=$(ue,"icon"),ou=p[ue],au=Fn[ue],su={title:ia("phase"),img:nu,documents:[{type:"text",text:o(f,{wKey:ue,children:e=>ia(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(ou.passive_dmg_red_.tag)]},{type:"fields",fields:[{title:"Additional DMG",fieldRef:au.damage.tag},{title:"Cooldown",fieldValue:tu.cooldown}]}]},pe="BlazingLaurel",[ca,la]=u("wengine",pe),ra=w.wengine[pe],iu=$(pe,"icon"),da=g[pe],gn=p[pe],cu={title:ca("phase"),img:iu,documents:[{type:"text",text:o(f,{wKey:pe,children:e=>ca(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:la("cond1"),metadata:da.quickOrPerfectAssistUsed,fields:[r(gn.impact_.tag),{title:"Duration",fieldValue:ra.duration}]}},{type:"conditional",conditional:{label:la("cond2"),metadata:da.wilt,fields:[r(gn.crit_dmg_ice_.tag),r(gn.crit_dmg_fire_.tag),{title:"Duration",fieldValue:ra.wilt_duration}]}}]},ge="BoxCutter",[ha,lu]=u("wengine",ge),ru=w.wengine[ge],du=$(ge,"icon"),hu=g[ge],ua=p[ge],uu={title:ha("phase"),img:du,documents:[{type:"text",text:o(f,{wKey:ge,children:e=>ha(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:lu("cond"),metadata:hu.launchedAftershock,fields:[r(ua.physical_dmg_.tag),r(ua.daze_.tag),{title:"Duration",fieldValue:ru.duration}]}}]},pt="BunnyBand",[pa,pu]=u("wengine",pt),gu=$(pt,"icon"),mu=g[pt],ga=p[pt],fu={title:pa("phase"),img:gu,documents:[{type:"text",text:o(f,{wKey:pt,children:e=>pa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(ga.passive_hp_.tag)]},{type:"conditional",conditional:{label:pu("cond"),metadata:mu.wearerShielded,fields:[r(ga.atk_.tag)]}}]},oe="CannonRotor",[ma,x$]=u("wengine",oe),$u=w.wengine[oe],yu=$(oe,"icon"),bu=Fn[oe],xu=p[oe],_u={title:ma("phase"),img:yu,documents:[{type:"text",text:o(f,{wKey:oe,children:e=>ma(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(xu.passive_atk_.tag)]},{type:"fields",fields:[{title:"Additional DMG",fieldRef:bu.damage.tag},{title:"Cooldown",fieldValue:o(f,{wKey:oe,children:e=>$u.cooldown[e]})}]}]},me="DeepSeaVisitor",[fa,$a]=u("wengine",me),ya=w.wengine[me],wu=$(me,"icon"),ba=g[me],mn=p[me],vu={title:fa("phase"),img:wu,documents:[{type:"text",text:o(f,{wKey:me,children:e=>fa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(mn.passive_ice_dmg_.tag)]},{type:"conditional",conditional:{label:$a("cond1"),metadata:ba.basicHit,fields:[r(mn.crit_.tag),{title:"Duration",fieldValue:ya.duration}]}},{type:"conditional",conditional:{label:$a("cond2"),metadata:ba.iceDashAtkHit,fields:[r(mn.extra_crit_.tag),{title:"Duration",fieldValue:ya.extra_duration}]}}]},fe="DemaraBatteryMarkII",[xa,ku]=u("wengine",fe),Cu=w.wengine[fe],Su=$(fe,"icon"),Du=g[fe],_a=p[fe],Mu={title:xa("phase"),img:Su,documents:[{type:"text",text:o(f,{wKey:fe,children:e=>xa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(_a.passive_electric_dmg_.tag)]},{type:"conditional",conditional:{label:ku("cond"),metadata:Du.dodgeCounterOrAssistHit,fields:[r(_a.enerRegen_.tag),{title:"Duration",fieldValue:Cu.duration}]}}]},$e="DrillRigRedAxis",[wa,Tu]=u("wengine",$e),va=w.wengine[$e],Iu=$($e,"icon"),Ru=g[$e],ka=p[$e],zu={title:wa("phase"),img:Iu,documents:[{type:"text",text:o(f,{wKey:$e,children:e=>wa(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Tu("cond"),metadata:Ru.exSpecialOrChainUsed,fields:[r(ka.basic_eletric_dmg_.tag),r(ka.dash_eletric_dmg_.tag),{title:"Duration",fieldValue:va.duration},{title:"Cooldown",fieldValue:va.cooldown}]}}]},gt="ElectroLipGloss",[Ca,Bu]=u("wengine",gt),Eu=$(gt,"icon"),Pu=g[gt],Sa=p[gt],Vu={title:Ca("phase"),img:Eu,documents:[{type:"text",text:o(f,{wKey:gt,children:e=>Ca(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Bu("cond"),metadata:Pu.anomalyOnEnemy,fields:[r(Sa.atk_.tag),r(Sa.common_dmg_.tag)]}}]},ye="ElegantVanity",[Da,Ou]=u("wengine",ye),Au=w.wengine[ye],qu=$(ye,"icon"),Fu=g[ye],Lu=p[ye],ju={title:Da("phase"),img:qu,documents:[{type:"text",text:o(f,{wKey:ye,children:e=>Da(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Ou("cond"),metadata:Fu.consumed25Energy,fields:[r(Lu.common_dmg_.tag),{title:"Duration",fieldValue:Au.buffDuration}]}}]},be="FlamemakerShaker",[Ma,Ta]=u("wengine",be),fn=w.wengine[be],Hu=$(be,"icon"),Ia=g[be],$n=p[be],Wu={title:Ma("phase"),img:Hu,documents:[{type:"text",text:o(f,{wKey:be,children:e=>Ma(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Ta("cond1"),metadata:Ia.offField,fields:[r($n.enerRegen.tag)]}},{type:"conditional",conditional:{label:Ta("cond2"),metadata:Ia.exSpecialAssistHits,fields:[r($n.common_dmg_.tag),{title:"Duration",fieldValue:fn.duration},{title:"Cooldown",fieldValue:fn.cooldown},r($n.anomProf.tag),{title:"Duration",fieldValue:fn.anomProfDuration}]}}]},xe="FlightOfFancy",[Ra,Ku]=u("wengine",xe),za=w.wengine[xe],Nu=$(xe,"icon"),Gu=g[xe],Ba=p[xe],Uu={title:Ra("phase"),img:Nu,documents:[{type:"text",text:o(f,{wKey:xe,children:e=>Ra(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Ba.anomBuildup_.tag)]},{type:"conditional",conditional:{label:Ku("cond"),metadata:Gu.etherDmg,fields:[r(Ba.etherDmg_anomProf.tag),{title:"Duration",fieldValue:za.duration},{title:"Cooldown",fieldValue:za.cd}]}}]},_e="FusionCompiler",[Ea,Ju]=u("wengine",_e),Zu=w.wengine[_e],Qu=$(_e,"icon"),Yu=g[_e],Pa=p[_e],Xu={title:Ea("phase"),img:Qu,documents:[{type:"text",text:o(f,{wKey:_e,children:e=>Ea(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Pa.passive_atk_.tag)]},{type:"conditional",conditional:{label:Ju("cond"),metadata:Yu.specialUsed,fields:[r(Pa.anomProf.tag),{title:"Duration",fieldValue:Zu.duration}]}}]},nn="GildedBlossom",[Va,_$]=u("wengine",nn),ep=$(nn,"icon"),Oa=p[nn],tp={title:Va("phase"),img:ep,documents:[{type:"text",text:o(f,{wKey:nn,children:e=>Va(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Oa.passive_atk_.tag),r(Oa.passive_exSpecial_dmg_.tag)]}]},we="HailstormShrine",[Aa,np]=u("wengine",we),op=w.wengine[we],ap=$(we,"icon"),sp=g[we],qa=p[we],ip={title:Aa("phase"),img:ap,documents:[{type:"text",text:o(f,{wKey:we,children:e=>Aa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(qa.passive_crit_dmg_.tag)]},{type:"conditional",conditional:{label:np("cond"),metadata:sp.exSpecialOrAnomaly,fields:[r(qa.ice_dmg_.tag),{title:"Duration",fieldValue:op.duration}]}}]},ve="HeartstringNocturne",[Fa,cp]=u("wengine",ve),lp=w.wengine[ve],rp=$(ve,"icon"),dp=g[ve],yn=p[ve],hp={title:Fa("phase"),img:rp,documents:[{type:"text",text:o(f,{wKey:ve,children:e=>Fa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(yn.passive_crit_dmg_.tag)]},{type:"conditional",conditional:{label:cp("cond"),metadata:dp.heartstring,fields:[r(yn.chain_resIgn_fire_.tag),r(yn.ult_resIgn_fire_.tag),{title:"Duration",fieldValue:lp.duration}]}}]},ke="HellfireGears",[La,ja]=u("wengine",ke),up=w.wengine[ke],pp=$(ke,"icon"),Ha=g[ke],Wa=p[ke],gp={title:La("phase"),img:pp,documents:[{type:"text",text:o(f,{wKey:ke,children:e=>La(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ja("cond1"),metadata:Ha.offField,fields:[r(Wa.enerRegen.tag)]}},{type:"conditional",conditional:{label:ja("cond1"),metadata:Ha.exSpecialUsed,fields:[r(Wa.impact_.tag),{title:"Duration",fieldValue:up.duration}]}}]},Ce="Housekeeper",[Ka,Na]=u("wengine",Ce),mp=w.wengine[Ce],fp=$(Ce,"icon"),Ga=g[Ce],Ua=p[Ce],$p={title:Ka("phase"),img:fp,documents:[{type:"text",text:o(f,{wKey:Ce,children:e=>Ka(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Na("cond1"),metadata:Ga.offField,fields:[r(Ua.enerRegen.tag)]}},{type:"conditional",conditional:{label:Na("cond2"),metadata:Ga.exSpecialHits,fields:[r(Ua.physical_dmg_.tag),{title:"Duration",fieldValue:mp.duration}]}}]},Se="IceJadeTeapot",[Ja,yp]=u("wengine",Se),Za=w.wengine[Se],bp=$(Se,"icon"),xp=g[Se],Qa=p[Se],_p={title:Ja("phase"),img:bp,documents:[{type:"text",text:o(f,{wKey:Se,children:e=>Ja(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:yp("cond"),metadata:xp.teariffic,fields:[r(Qa.impact_.tag),{title:"Duration",fieldValue:Za.duration},r(Qa.common_dmg_.tag),{title:"Duration",fieldValue:Za.teamBuffDuration}]}}]},De="IdentityBase",[Ya,wp]=u("wengine",De),vp=w.wengine[De],kp=$(De,"icon"),Cp=g[De],Sp=p[De],Dp={title:Ya("phase"),img:kp,documents:[{type:"text",text:o(f,{wKey:De,children:e=>Ya(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:wp("cond"),metadata:Cp.equipperAttacked,fields:[r(Sp.def_.tag),{title:"Duration",fieldValue:vp.duration}]}}]},Wn="IdentityInflection",[Xa,w$]=u("wengine",Wn),Mp=$(Wn,"icon"),Tp={title:Xa("phase"),img:Mp,documents:[{type:"text",text:o(f,{wKey:Wn,children:e=>Xa(`phaseDescs.${e-1}`)})}]},Me="KaboomTheCannon",[es,Ip]=u("wengine",Me),Rp=w.wengine[Me],zp=$(Me,"icon"),Bp=g[Me],Ep=p[Me],Pp={title:es("phase"),img:zp,documents:[{type:"text",text:o(f,{wKey:Me,children:e=>es(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Ip("cond"),metadata:Bp.allyHitsEnemy,fields:[r(Ep.atk_.tag),{title:"Duration",fieldValue:Rp.duration}]}}]},Te="LunarDecrescent",[ts,Vp]=u("wengine",Te),Op=w.wengine[Te],Ap=$(Te,"icon"),qp=g[Te],Fp=p[Te],Lp={title:ts("phase"),img:Ap,documents:[{type:"text",text:o(f,{wKey:Te,children:e=>ts(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Vp("cond"),metadata:qp.chainOrUltUsed,fields:[r(Fp.common_dmg_.tag),{title:"Duration",fieldValue:Op.duration}]}}]},Kn="LunarNoviluna",[ns,v$]=u("wengine",Kn),jp=$(Kn,"icon"),Hp={title:ns("phase"),img:jp,documents:[{type:"text",text:o(f,{wKey:Kn,children:e=>ns(`phaseDescs.${e-1}`)})}]},on="LunarPleniluna",[os,k$]=u("wengine",on),Wp=$(on,"icon"),bn=p[on],Kp={title:os("phase"),img:Wp,documents:[{type:"text",text:o(f,{wKey:on,children:e=>os(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(bn.basic_dmg_.tag),r(bn.dash_dmg_.tag),r(bn.dodgeCounter_dmg_.tag)]}]},Ie="MagneticStormAlpha",[as,Np]=u("wengine",Ie),ss=w.wengine[Ie],Gp=$(Ie,"icon"),Up=g[Ie],Jp=p[Ie],Zp={title:as("phase"),img:Gp,documents:[{type:"text",text:o(f,{wKey:Ie,children:e=>as(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Np("cond"),metadata:Up.anomalyBuildupIncreased,fields:[r(Jp.anomMas.tag),{title:"Duration",fieldValue:ss.duration},{title:"Cooldown",fieldValue:ss.cooldown}]}}]},Re="MagneticStormBravo",[is,Qp]=u("wengine",Re),cs=w.wengine[Re],Yp=$(Re,"icon"),Xp=g[Re],eg=p[Re],tg={title:is("phase"),img:Yp,documents:[{type:"text",text:o(f,{wKey:Re,children:e=>is(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Qp("cond"),metadata:Xp.anomalyBuildupIncreased,fields:[r(eg.anomProf.tag),{title:"Duration",fieldValue:cs.duration},{title:"Cooldown",fieldValue:cs.cooldown}]}}]},Nn="MagneticStormCharlie",[ls,C$]=u("wengine",Nn),ng=$(Nn,"icon"),og={title:ls("phase"),img:ng,documents:[{type:"text",text:o(f,{wKey:Nn,children:e=>ls(`phaseDescs.${e-1}`)})}]},ze="MarcatoDesire",[rs,ds]=u("wengine",ze),ag=w.wengine[ze],sg=$(ze,"icon"),hs=g[ze],ig=p[ze],cg={title:rs("phase"),img:sg,documents:[{type:"text",text:o(f,{wKey:ze,children:e=>rs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ds("cond1"),metadata:hs.exSpecialOrChainHitsEnemy,fields:[r(ig.atk_.tag),{title:"Duration",fieldValue:ag.duration}]}},{type:"conditional",conditional:{label:ds("cond2"),metadata:hs.attributeAnomalyInflicted}}]},Be="MyriadEclipse",[us,lg]=u("wengine",Be),rg=w.wengine[Be],dg=$(Be,"icon"),hg=g[Be],ps=p[Be],ug={title:us("phase"),img:dg,documents:[{type:"text",text:o(f,{wKey:Be,children:e=>us(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(ps.crit_dmg_.tag)]},{type:"conditional",conditional:{label:lg("cond"),metadata:hg.deathSentence,fields:[r(ps.deathSentence_defIgn_.tag),{title:"Duration",fieldValue:rg.duration}]}}]},Ee="OriginalTransmorpher",[gs,pg]=u("wengine",Ee),gg=w.wengine[Ee],mg=$(Ee,"icon"),fg=g[Ee],ms=p[Ee],$g={title:gs("phase"),img:mg,documents:[{type:"text",text:o(f,{wKey:Ee,children:e=>gs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(ms.passive_hp_.tag)]},{type:"conditional",conditional:{label:pg("cond"),metadata:fg.equipperHit,fields:[r(ms.impact_.tag),{title:"Duration",fieldValue:gg.duration}]}}]},mt="PeacekeeperSpecialized",[fs,yg]=u("wengine",mt),bg=$(mt,"icon"),xg=g[mt],xn=p[mt],_g={title:fs("phase"),img:bg,documents:[{type:"text",text:o(f,{wKey:mt,children:e=>fs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:yg("cond"),metadata:xg.shielded,fields:[r(xn.enerRegen.tag)]}},{type:"fields",fields:[r(xn.passive_exSpecial_anomBuildup_.tag),r(xn.passive_assist_anomBuildup_.tag)]}]},ft="PreciousFossilizedCore",[$s,ys]=u("wengine",ft),wg=$(ft,"icon"),bs=g[ft],vg=p[ft],kg={title:$s("phase"),img:wg,documents:[{type:"text",text:o(f,{wKey:ft,children:e=>$s(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ys("cond1"),metadata:bs.enemyHpGE50,fields:[r(vg.daze_.tag)]}},{type:"conditional",conditional:{label:ys("cond2"),metadata:bs.enemyHpGE75}}]},Pe="RainforestGourmet",[xs,Cg]=u("wengine",Pe),Sg=w.wengine[Pe],Dg=$(Pe,"icon"),Mg=g[Pe],Tg=p[Pe],Ig={title:xs("phase"),img:Dg,documents:[{type:"text",text:o(f,{wKey:Pe,children:e=>xs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Cg("cond"),metadata:Mg.energyConsumed,fields:[r(Tg.atk_.tag),{title:"Duration",fieldValue:Sg.duration}]}}]},Ve="ReverbMarkI",[_s,Rg]=u("wengine",Ve),zg=w.wengine[Ve],Bg=$(Ve,"icon"),Eg=g[Ve],Pg=p[Ve],Vg={title:_s("phase"),img:Bg,documents:[{type:"text",text:o(f,{wKey:Ve,children:e=>_s(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Rg("cond"),metadata:Eg.exSpecialUsed,fields:[r(Pg.impact_.tag),{title:"Duration",fieldValue:zg.duration}]}}]},Oe="ReverbMarkII",[ws,Og]=u("wengine",Oe),Ag=w.wengine[Oe],qg=$(Oe,"icon"),Fg=g[Oe],vs=p[Oe],Lg={title:ws("phase"),img:qg,documents:[{type:"text",text:o(f,{wKey:Oe,children:e=>ws(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Og("cond"),metadata:Fg.exSpecialOrChainUsed,fields:[r(vs.anomMas.tag),r(vs.anomProf.tag),{title:"Duration",fieldValue:Ag.duration}]}}]},Ae="ReverbMarkIII",[ks,jg]=u("wengine",Ae),Hg=w.wengine[Ae],Wg=$(Ae,"icon"),Kg=g[Ae],Ng=p[Ae],Gg={title:ks("phase"),img:Wg,documents:[{type:"text",text:o(f,{wKey:Ae,children:e=>ks(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:jg("cond"),metadata:Kg.chainOrUltUsed,fields:[r(Ng.atk_.tag),{title:"Duration",fieldValue:Hg.duration}]}}]},$t="RiotSuppressorMarkVI",[Cs,Ug]=u("wengine",$t),Jg=$($t,"icon"),Zg=g[$t],Ss=p[$t],Qg={title:Cs("phase"),img:Jg,documents:[{type:"text",text:o(f,{wKey:$t,children:e=>Cs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Ss.passive_crit_.tag)]},{type:"conditional",conditional:{label:Ug("cond"),metadata:Zg.charge,fields:[r(Ss.basic_ether_dmg_.tag)]}}]},qe="RoaringRide",[Ds,_n]=u("wengine",qe),wn=w.wengine[qe],Yg=$(qe,"icon"),vn=g[qe],kn=p[qe],Xg={title:Ds("phase"),img:Yg,documents:[{type:"text",text:o(f,{wKey:qe,children:e=>Ds(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:_n("cond_atk_"),metadata:vn.atk_,fields:[r(kn.atk_.tag),{title:"Duration",fieldValue:wn.duration}]}},{type:"conditional",conditional:{label:_n("cond_anomProf"),metadata:vn.anomProf,fields:[r(kn.anomProf.tag),{title:"Duration",fieldValue:wn.duration}]}},{type:"conditional",conditional:{label:_n("cond_anomBuildup_"),metadata:vn.anomBuildup_,fields:[r(kn.anomBuildup_.tag),{title:"Duration",fieldValue:wn.duration}]}}]},Fe="SeveredInnocence",[Ms,em]=u("wengine",Fe),tm=w.wengine[Fe],nm=$(Fe,"icon"),om=g[Fe],Cn=p[Fe],am={title:Ms("phase"),img:nm,documents:[{type:"text",text:o(f,{wKey:Fe,children:e=>Ms(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Cn.passive_crit_dmg_.tag)]},{type:"conditional",conditional:{label:em("cond"),metadata:om.basicSpecialAftershockHit,fields:[r(Cn.crit_dmg_.tag),r(Cn.electric_dmg_.tag),{title:"Duration",fieldValue:tm.duration}]}}]},Le="SharpenedStinger",[Ts,sm]=u("wengine",Le),im=w.wengine[Le],cm=$(Le,"icon"),lm=g[Le],Is=p[Le],rm={title:Ts("phase"),img:cm,documents:[{type:"text",text:o(f,{wKey:Le,children:e=>Ts(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:sm("cond"),metadata:lm.predatoryInstinct,fields:[r(Is.physical_dmg_.tag),{title:"Duration",fieldValue:im.duration}]}},{type:"fields",fields:[r(Is.anomBuildup_.tag)]}]},yt="SixShooter",[Rs,dm]=u("wengine",yt),hm=$(yt,"icon"),um=g[yt],pm=p[yt],gm={title:Rs("phase"),img:hm,documents:[{type:"text",text:o(f,{wKey:yt,children:e=>Rs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:dm("cond"),metadata:um.charge,fields:[r(pm.exSpecial_daze_.tag)]}}]},Gn="SliceOfTime",[zs,S$]=u("wengine",Gn),mm=$(Gn,"icon"),fm={title:zs("phase"),img:mm,documents:[{type:"text",text:o(f,{wKey:Gn,children:e=>zs(`phaseDescs.${e-1}`)})}]},je="SpectralGaze",[Bs,Es]=u("wengine",je),Ps=w.wengine[je],$m=$(je,"icon"),Vs=g[je],Os=p[je],ym={title:Bs("phase"),img:$m,documents:[{type:"text",text:o(f,{wKey:je,children:e=>Bs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Es("cond1"),metadata:Vs.hit_aftershock_electric,fields:[r(Os.cond_defRed_.tag),{title:"Duration",fieldValue:Ps.duration1}]}},{type:"conditional",conditional:{label:Es("cond2"),metadata:Vs.spiritLock,fields:[r(Os.cond_impact_.tag),{title:"Duration",fieldValue:Ps.duration2}]}}]},He="SpringEmbrace",[As,bm]=u("wengine",He),xm=w.wengine[He],_m=$(He,"icon"),wm=g[He],qs=p[He],vm={title:As("phase"),img:_m,documents:[{type:"text",text:o(f,{wKey:He,children:e=>As(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(qs.passive_dmg_red_.tag)]},{type:"conditional",conditional:{label:bm("cond"),metadata:wm.when_attacked,fields:[r(qs.cond_enerRegen_.tag),{title:"Duration",fieldValue:xm.duration}]}}]},We="StarlightEngine",[Fs,km]=u("wengine",We),Cm=w.wengine[We],Sm=$(We,"icon"),Dm=g[We],Mm=p[We],Tm={title:Fs("phase"),img:Sm,documents:[{type:"text",text:o(f,{wKey:We,children:e=>Fs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:km("cond"),metadata:Dm.dodgecounter_quickassist,fields:[r(Mm.cond_dmg_.tag),{title:"Duration",fieldValue:Cm.duration}]}}]},Ke="StarlightEngineReplica",[Ls,Im]=u("wengine",Ke),Rm=w.wengine[Ke],zm=$(Ke,"icon"),Bm=g[Ke],Em=p[Ke],Pm={title:Ls("phase"),img:zm,documents:[{type:"text",text:o(f,{wKey:Ke,children:e=>Ls(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Im("cond"),metadata:Bm.hit_away,fields:[r(Em.cond_dmg_.tag),{title:"Duration",fieldValue:Rm.duration}]}}]},Ne="SteamOven",[js,Vm]=u("wengine",Ne),Om=w.wengine[Ne],Am=$(Ne,"icon"),qm=g[Ne],Fm=p[Ne],Lm={title:js("phase"),img:Am,documents:[{type:"text",text:o(f,{wKey:Ne,children:e=>js(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Vm("cond"),metadata:qm.stacks,fields:[r(Fm.cond_impact_.tag),{title:"Duration",fieldValue:Om.duration}]}}]},bt="SteelCushion",[Hs,jm]=u("wengine",bt),Hm=$(bt,"icon"),Wm=g[bt],Ws=p[bt],Km={title:Hs("phase"),img:Hm,documents:[{type:"text",text:o(f,{wKey:bt,children:e=>Hs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Ws.passive_physical_dmg_.tag)]},{type:"conditional",conditional:{label:jm("cond"),metadata:Wm.hit_behind,fields:[r(Ws.cond_dmg_.tag)]}}]},xt="StreetSuperstar",[Ks,Nm]=u("wengine",xt),Gm=$(xt,"icon"),Um=g[xt],Jm=p[xt],Zm={title:Ks("phase"),img:Gm,documents:[{type:"text",text:o(f,{wKey:xt,children:e=>Ks(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Nm("cond"),metadata:Um.charge,fields:[r(Jm.cond_ult_dmg_.tag)]}}]},Ge="TheBrimstone",[Ns,Qm]=u("wengine",Ge),Ym=w.wengine[Ge],Xm=$(Ge,"icon"),ef=g[Ge],tf=p[Ge],nf={title:Ns("phase"),img:Xm,documents:[{type:"text",text:o(f,{wKey:Ge,children:e=>Ns(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Qm("cond"),metadata:ef.hit_basic_dash_dodge,fields:[r(tf.cond_atk_.tag),{title:"Duration",fieldValue:Ym.duration}]}}]},Ue="TheRestrained",[Gs,of]=u("wengine",Ue),af=w.wengine[Ue],sf=$(Ue,"icon"),cf=g[Ue],Us=p[Ue],lf={title:Gs("phase"),img:sf,documents:[{type:"text",text:o(f,{wKey:Ue,children:e=>Gs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:of("cond"),metadata:cf.dmg_daze_,fields:[r(Us.basic_dmg_.tag),r(Us.basic_daze_.tag),{title:"Duration",fieldValue:af.duration}]}}]},Je="TheVault",[Js,rf]=u("wengine",Je),df=w.wengine[Je],hf=$(Je,"icon"),uf=g[Je],pf=p[Je],gf={title:Js("phase"),img:hf,documents:[{type:"text",text:o(f,{wKey:Je,children:e=>Js(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:rf("cond"),metadata:uf.ether_hit,fields:[r(pf.cond_dmg_.tag),{title:"Duration",fieldValue:df.duration}]}}]},Ze="Timeweaver",[Zs,mf]=u("wengine",Ze),ff=w.wengine[Ze],$f=$(Ze,"icon"),yf=g[Ze],Sn=p[Ze],bf={title:Zs("phase"),img:$f,documents:[{type:"text",text:o(f,{wKey:Ze,children:e=>Zs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Sn.passive_electric_anomBuildup_.tag),r(Sn.passive_disorder_dmg_.tag)]},{type:"conditional",conditional:{label:mf("cond"),metadata:yf.hit_anomaly,fields:[r(Sn.cond_anomProf.tag),{title:"Duration",fieldValue:ff.duration}]}}]},Qe="TusksOfFury",[Qs,xf]=u("wengine",Qe),_f=w.wengine[Qe],wf=$(Qe,"icon"),vf=g[Qe],Dn=p[Qe],kf={title:Qs("phase"),img:wf,documents:[{type:"text",text:o(f,{wKey:Qe,children:e=>Qs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Dn.passive_shield_.tag)]},{type:"conditional",conditional:{label:xf("cond"),metadata:vf.interrupt_perfdodge,fields:[r(Dn.cond_dmg_.tag),r(Dn.daze_.tag),{title:"Duration",fieldValue:_f.duration}]}}]},Ye="UnfetteredGameBall",[Ys,Cf]=u("wengine",Ye),Sf=w.wengine[Ye],Df=$(Ye,"icon"),Mf=g[Ye],Tf=p[Ye],If={title:Ys("phase"),img:Df,documents:[{type:"text",text:o(f,{wKey:Ye,children:e=>Ys(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Cf("cond"),metadata:Mf.anomaly_counter,fields:[r(Tf.cond_crit_.tag),{title:"Duration",fieldValue:Sf.duration}]}}]},an="VortexArrow",[Xs,D$]=u("wengine",an),Rf=$(an,"icon"),zf=p[an],Bf={title:Xs("phase"),img:Rf,documents:[{type:"text",text:o(f,{wKey:an,children:e=>Xs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(zf.passive_daze_.tag)]}]},Xe="VortexHatchet",[ei,Ef]=u("wengine",Xe),ti=w.wengine[Xe],Pf=$(Xe,"icon"),Vf=g[Xe],Of=p[Xe],Af={title:ei("phase"),img:Pf,documents:[{type:"text",text:o(f,{wKey:Xe,children:e=>ei(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Ef("cond"),metadata:Vf.entering,fields:[r(Of.cond_impact_.tag),{title:"Duration",fieldValue:ti.duration},{title:"Cooldown",fieldValue:ti.cooldown}]}}]},sn="VortexRevolver",[ni,M$]=u("wengine",sn),qf=$(sn,"icon"),Ff=p[sn],Lf={title:ni("phase"),img:qf,documents:[{type:"text",text:o(f,{wKey:sn,children:e=>ni(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Ff.passive_exSpecial_daze_.tag)]}]},et="WeepingCradle",[oi,ai]=u("wengine",et),jf=w.wengine[et],Hf=$(et,"icon"),si=g[et],Wf=p[et],Kf={title:oi("phase"),img:Hf,documents:[{type:"text",text:o(f,{wKey:et,children:e=>oi(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ai("cond_atk"),metadata:si.attack}},{type:"conditional",conditional:{label:ai("cond_stacks"),metadata:si.stacks,fields:[r(Wf.cond_dmg_.tag),{title:"Duration",fieldValue:jf.duration}]}}]},_t="WeepingGemini",[ii,Nf]=u("wengine",_t),Gf=$(_t,"icon"),Uf=g[_t],Jf=p[_t],Zf={title:ii("phase"),img:Gf,documents:[{type:"text",text:o(f,{wKey:_t,children:e=>ii(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Nf("cond"),metadata:Uf.anomaly_stack,fields:[r(Jf.anomProf.tag)]}}]},tt="ZanshinHerbCase",[ci,Qf]=u("wengine",tt),Yf=w.wengine[tt],Xf=$(tt,"icon"),e$=g[tt],Mn=p[tt],t$={title:ci("phase"),img:Xf,documents:[{type:"text",text:o(f,{wKey:tt,children:e=>ci(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Mn.passive_crit_.tag),r(Mn.passive_electric_dmg_.tag)]},{type:"conditional",conditional:{label:Qf("cond"),metadata:e$.apply_anom_stun,fields:[r(Mn.cond_crit_.tag),{title:"Duration",fieldValue:Yf.duration}]}}]},n$={BashfulDemon:eu,BigCylinder:su,BlazingLaurel:cu,BoxCutter:uu,BunnyBand:fu,CannonRotor:_u,DeepSeaVisitor:vu,DemaraBatteryMarkII:Mu,DrillRigRedAxis:zu,ElectroLipGloss:Vu,ElegantVanity:ju,FlamemakerShaker:Wu,FlightOfFancy:Uu,FusionCompiler:Xu,GildedBlossom:tp,HailstormShrine:ip,HeartstringNocturne:hp,HellfireGears:gp,Housekeeper:$p,IceJadeTeapot:_p,IdentityBase:Dp,IdentityInflection:Tp,KaboomTheCannon:Pp,LunarDecrescent:Lp,LunarNoviluna:Hp,LunarPleniluna:Kp,MagneticStormAlpha:Zp,MagneticStormBravo:tg,MagneticStormCharlie:og,MarcatoDesire:cg,MyriadEclipse:ug,OriginalTransmorpher:$g,PeacekeeperSpecialized:_g,PreciousFossilizedCore:kg,RainforestGourmet:Ig,ReverbMarkI:Vg,ReverbMarkII:Lg,ReverbMarkIII:Gg,RiotSuppressorMarkVI:Qg,RoaringRide:Xg,SeveredInnocence:am,SharpenedStinger:rm,SixShooter:gm,SliceOfTime:fm,SpectralGaze:ym,SpringEmbrace:vm,StarlightEngine:Tm,StarlightEngineReplica:Pm,SteamOven:Lm,SteelCushion:Km,StreetSuperstar:Zm,TheBrimstone:nf,TheRestrained:lf,TheVault:gf,Timeweaver:bf,TusksOfFury:kf,UnfetteredGameBall:If,VortexArrow:Bf,VortexHatchet:Af,VortexRevolver:Lf,WeepingCradle:Kf,WeepingGemini:Zf,ZanshinHerbCase:t$};function o$(e){const{attribute:t}=e;if(t)return t}function a$(e){const{q:t}=e;return["standardDmg","anomalyDmg"].includes(t)}function s$(e){const{damageType1:t,damageType2:n}=e,a=[];return a$(e)?(t&&a.push(t),n&&a.push(n),a):[]}const Bt={basic:"Basic",dash:"Dash",dodgeCounter:"Dodge Counter",special:"Special",exSpecial:"EX Special",chain:"Chain",ult:"Ultimate",quickAssist:"Quick Assist",defensiveAssist:"Defensive Assist",evasiveAssist:"Evasive Assist",assistFollowUp:"Assist Follow Up",anomaly:"Anomaly",disorder:"Disorder",aftershock:"Aftershock",elemental:"Elemental"},Zi=["crit_","crit_dmg_","impact","pen","pen_","enerRegen","anomProf","anomMas"].map(e=>{if($l.includes(e)){const t={...A.final.dmg_.tag,attribute:e.slice(0,-5)};return{title:o(Ct,{statKey:e}),fieldRef:t}}return e==="crit_"?{fieldRef:A.common.cappedCrit_.tag,title:o(Ct,{statKey:e})}:{fieldRef:A.final[e].tag,title:o(Ct,{statKey:e})}});Zi.push(...at.map(e=>({fieldRef:{et:"own",qt:"formula",q:"standardDmg",attribute:e,name:"standardDmgInst"},title:x(st,{color:e,children:[le[e]," Damage"]})})),...at.flatMap(e=>yl.map(t=>({fieldRef:{et:"own",qt:"formula",q:"standardDmg",attribute:e,damageType1:t,name:"standardDmgInst"},title:x(st,{color:e,children:[le[e]," ",Bt[t]," Damage"]})}))),...at.map(e=>({fieldRef:{et:"own",qt:"formula",q:"anomalyDmg",attribute:e,damageType1:"anomaly",name:"anomalyDmgInst"},title:x(st,{color:e,children:[le[e]," Anomaly Damage"]})})),...at.map(e=>({fieldRef:{et:"own",qt:"formula",q:"anomBuildup",attribute:e,name:"anomalyBuildupInst"},title:x(st,{color:e,children:[le[e]," Anomaly Buildup"]})})),{fieldRef:{et:"own",qt:"formula",q:"dazeBuildup",name:"dazeInst"},title:"Daze Buildup"});const Un=[];Object.values(Kd).forEach(e=>Object.values(e).forEach(t=>t.documents.forEach(n=>n.type==="fields"&&n.fields.forEach(a=>lr(a)&&Un.push({tag:a.fieldRef,value:a})))));Zi.forEach(e=>{Un.push({tag:e.fieldRef,value:e})});const i$=Ul(Un),In=new Map;function Qi(e,t){if(In.get(e))throw new Error(`Duplicate conditional ${e}`);In.set(e,t)}Object.values(n$).forEach(({documents:e})=>{e.forEach(t=>{t.type==="conditional"&&Qi(`${t.conditional.metadata.sheet}:${t.conditional.metadata.name}`,t.conditional)})});Object.values(Jh).forEach(e=>Object.values(e).forEach(({documents:t})=>{t.forEach(n=>{n.type==="conditional"&&Qi(`${n.conditional.metadata.sheet}:${n.conditional.metadata.name}`,n.conditional)})}));export{Zl as A,f$ as C,co as D,p$ as F,At as T,lt as a,Fi as b,Vl as c,Bl as d,Jh as e,Bt as f,xr as g,Kd as h,Ot as i,Cr as j,m$ as k,g$ as l,Ql as m,Vt as n,Jl as o,u$ as p,_r as q,nr as r,tr as s,Gi as t,Al as u,n$ as w};
