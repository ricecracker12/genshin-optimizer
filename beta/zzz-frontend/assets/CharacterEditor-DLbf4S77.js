import{cw as ke,E as ze,z as Te,c as g,H as Re,_ as $e,L as F,cx as Se,V as J,U as ee,Q as q,cy as O,W as We,cz as st,cA as lt,T as y,w as Be,u as $,af as Me,cB as ct,cC as dt,j as e,a$ as pt,aZ as ht,h as I,d,cD as we,cE as ut,bc as gt,bd as mt,n as f,aX as ft,aV as xt,aW as bt,aY as vt,c6 as le,cF as yt,aD as z,b5 as te,cG as Y,b3 as E,cn as Ee,cH as Ct,cI as Le,cJ as Fe,cK as Ne,cL as K,aJ as ce,cM as St,cN as je,ca as wt,k as Ae,cr as It,e as L,G as P,C as H,S as N,N as _t,ce as Dt,aT as Ot,cs as Ie,b_ as qe,bf as Pt,ct as kt,cu as zt,I as de,q as pe,a1 as Tt,cO as Rt,s as Z,M as he,bt as ue,aK as He,aL as Ue,cP as $t,r as Wt,a as Bt,b as Mt,g as Et,i as Lt,l as Ft,m as Nt,bQ as jt,D as At,cv as qt,cQ as Ht,o as Ve,c3 as Ge,bp as Ut,bq as Vt,cR as Gt,y as Zt,cS as Xt,x as X,B as U,cT as ge,F as me,cU as Ze,cV as Qt,cq as Jt,cW as Yt,cX as Kt}from"./index-CLywPHVD.js";import{u as Xe}from"./useDataEntryBase-89FTvLas.js";import{i as ea,d as ta}from"./discSortUtil-DGDdw8GP.js";function aa(a){const{badgeContent:n,invisible:t=!1,max:r=99,showZero:i=!1}=a,o=ke({badgeContent:n,max:r});let s=t;t===!1&&n===0&&!i&&(s=!0);const{badgeContent:l,max:p=r}=s?o:a,c=l&&Number(l)>p?`${p}+`:l;return{badgeContent:l,invisible:s,max:p,displayValue:c}}function na(a){return Te("MuiBadge",a)}const M=ze("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),ra=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],oe=10,se=4,ia=a=>{const{color:n,anchorOrigin:t,invisible:r,overlap:i,variant:o,classes:s={}}=a,l={root:["root"],badge:["badge",o,r&&"invisible",`anchorOrigin${O(t.vertical)}${O(t.horizontal)}`,`anchorOrigin${O(t.vertical)}${O(t.horizontal)}${O(i)}`,`overlap${O(i)}`,n!=="default"&&`color${O(n)}`]};return We(l,na,s)},oa=ee("span",{name:"MuiBadge",slot:"Root",overridesResolver:(a,n)=>n.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),sa=ee("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(a,n)=>{const{ownerState:t}=a;return[n.badge,n[t.variant],n[`anchorOrigin${O(t.anchorOrigin.vertical)}${O(t.anchorOrigin.horizontal)}${O(t.overlap)}`],t.color!=="default"&&n[`color${O(t.color)}`],t.invisible&&n.invisible]}})(({theme:a})=>{var n;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:a.typography.fontFamily,fontWeight:a.typography.fontWeightMedium,fontSize:a.typography.pxToRem(12),minWidth:oe*2,lineHeight:1,padding:"0 6px",height:oe*2,borderRadius:oe,zIndex:1,transition:a.transitions.create("transform",{easing:a.transitions.easing.easeInOut,duration:a.transitions.duration.enteringScreen}),variants:[...Object.keys(((n=a.vars)!=null?n:a).palette).filter(t=>{var r,i;return((r=a.vars)!=null?r:a).palette[t].main&&((i=a.vars)!=null?i:a).palette[t].contrastText}).map(t=>({props:{color:t},style:{backgroundColor:(a.vars||a).palette[t].main,color:(a.vars||a).palette[t].contrastText}})),{props:{variant:"dot"},style:{borderRadius:se,height:se*2,minWidth:se*2,padding:0}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${M.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${M.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${M.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${M.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${M.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="right"&&t.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${M.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="top"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${M.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:t})=>t.anchorOrigin.vertical==="bottom"&&t.anchorOrigin.horizontal==="left"&&t.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${M.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:a.transitions.create("transform",{easing:a.transitions.easing.easeInOut,duration:a.transitions.duration.leavingScreen})}}]}}),_e=g.forwardRef(function(n,t){var r,i,o,s,l,p;const c=Re({props:n,name:"MuiBadge"}),{anchorOrigin:u={vertical:"top",horizontal:"right"},className:C,component:w,components:m={},componentsProps:h={},children:b,overlap:x="rectangular",color:_="default",invisible:W=!1,max:B=99,badgeContent:j,slots:R,slotProps:D,showZero:k=!1,variant:v="standard"}=c,S=$e(c,ra),{badgeContent:A,invisible:Ye,max:Ke,displayValue:et}=aa({max:B,invisible:W,badgeContent:j,showZero:k}),tt=ke({anchorOrigin:u,color:_,overlap:x,variant:v,badgeContent:j}),fe=Ye||A==null&&v!=="dot",{color:at=_,overlap:nt=x,anchorOrigin:rt=u,variant:xe=v}=fe?tt:c,be=xe!=="dot"?et:void 0,ne=F({},c,{badgeContent:A,invisible:fe,max:Ke,displayValue:be,showZero:k,anchorOrigin:rt,color:at,overlap:nt,variant:xe}),ve=ia(ne),ye=(r=(i=R==null?void 0:R.root)!=null?i:m.Root)!=null?r:oa,Ce=(o=(s=R==null?void 0:R.badge)!=null?s:m.Badge)!=null?o:sa,re=(l=D==null?void 0:D.root)!=null?l:h.root,ie=(p=D==null?void 0:D.badge)!=null?p:h.badge,it=Se({elementType:ye,externalSlotProps:re,externalForwardedProps:S,additionalProps:{ref:t,as:w},ownerState:ne,className:J(re==null?void 0:re.className,ve.root,C)}),ot=Se({elementType:Ce,externalSlotProps:ie,ownerState:ne,className:J(ve.badge,ie==null?void 0:ie.className)});return q.jsxs(ye,F({},it,{children:[b,q.jsx(Ce,F({},ot,{children:be}))]}))});function la(a){return Te("MuiFormControlLabel",a)}const G=ze("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),ca=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],da=a=>{const{classes:n,disabled:t,labelPlacement:r,error:i,required:o}=a,s={root:["root",t&&"disabled",`labelPlacement${O(r)}`,i&&"error",o&&"required"],label:["label",t&&"disabled"],asterisk:["asterisk",i&&"error"]};return We(s,la,n)},pa=ee("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(a,n)=>{const{ownerState:t}=a;return[{[`& .${G.label}`]:n.label},n.root,n[`labelPlacement${O(t.labelPlacement)}`]]}})(({theme:a,ownerState:n})=>F({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${G.disabled}`]:{cursor:"default"}},n.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},n.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},n.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${G.label}`]:{[`&.${G.disabled}`]:{color:(a.vars||a).palette.text.disabled}}})),ha=ee("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(a,n)=>n.asterisk})(({theme:a})=>({[`&.${G.error}`]:{color:(a.vars||a).palette.error.main}})),ua=g.forwardRef(function(n,t){var r,i;const o=Re({props:n,name:"MuiFormControlLabel"}),{className:s,componentsProps:l={},control:p,disabled:c,disableTypography:u,label:C,labelPlacement:w="end",required:m,slotProps:h={}}=o,b=$e(o,ca),x=st(),_=(r=c??p.props.disabled)!=null?r:x==null?void 0:x.disabled,W=m??p.props.required,B={disabled:_,required:W};["checked","name","onChange","value","inputRef"].forEach(S=>{typeof p.props[S]>"u"&&typeof o[S]<"u"&&(B[S]=o[S])});const j=lt({props:o,muiFormControl:x,states:["error"]}),R=F({},o,{disabled:_,labelPlacement:w,required:W,error:j.error}),D=da(R),k=(i=h.typography)!=null?i:l.typography;let v=C;return v!=null&&v.type!==y&&!u&&(v=q.jsx(y,F({component:"span"},k,{className:J(D.label,k==null?void 0:k.className),children:v}))),q.jsxs(pa,F({className:J(D.root,s),ownerState:R,ref:t},b,{children:[g.cloneElement(p,B),W?q.jsxs(Be,{display:"block",children:[v,q.jsxs(ha,{ownerState:R,"aria-hidden":!0,className:D.asterisk,children:["â€‰","*"]})]}):v]}))});function ae(a){const{database:n}=$();return Me(n.chars,a)}function ga(a){const{database:n}=$();return Me(n.discs,a??"")}function T(a){return ct.char[a]}function ma(a,n,t){const{promotionStats:r,coreStats:i,stats:{atk_base:o,atk_growth:s,def_base:l,def_growth:p,hp_base:c,hp_growth:u,anomMas_base:C,anomProf:w}}=T(a),m=r[Math.floor(n/10)>0?Math.floor(n/10)-1:0],h={charLvl:n,crit_:.05,crit_dmg_:.5,anomMas_base:C,anomProf:w,atk_base:o+s*(n-1)+m.atk,def_base:l+p*(n-1)+m.def,hp_base:c+u*(n-1)+m.hp};return t>1&&i[t-1]&&dt(h,i[t-1]),h}function fa({characterKey:a}){return e(pt,{ns:"charNames_gen",key18:a})}function Ua({attribute:a}){return ht[a]}function xa({bgt:a,character:n}){const{t}=I("page_characters"),{key:r,level:i,core:o}=n,s=ma(r,i,o),l=T(r),p=["anomMas_base","anomProf","atk_base","crit_","crit_dmg_","def_base","hp_base"],c=[...new Set(l.coreStats.flatMap(Object.keys))][1];return d(ut,{bgt:a,sx:{width:"100%",borderRadius:0},children:[p.map(u=>e(we,{children:e(De,{substat:u,value:s[u]})},u)),d(we,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(y,{flexGrow:1,children:e("strong",{children:t("characterCard.coreStat")})}),o?e(De,{substat:c,value:l.coreStats[o-1][c]}):e(y,{children:e("strong",{children:t("characterCard.notUnlocked")})})]})]})}function De({substat:a,value:n}){if(!n)return null;const t=gt(n,a).toFixed(mt(a));return d(y,{variant:"subtitle2",sx:{display:"flex",alignItems:"center",justifyContent:"space-between",fontWeight:"bold",gap:1},children:[d(f,{sx:{display:"flex",alignItems:"center",gap:1},children:[e(bt,{statKey:a,iconProps:xt}),ft[a]]}),d("span",{children:[t,vt(a)]})]})}function ba({characterKey:a,onClick:n,charCardConfig:t}){const{level:r=0,promotion:i=0}=ae(a)??{},o=T(a),s=t||{cardWidth:"100%",charImgWidth:"100%",iconsSize:1.7,isEditing:!1,charNameWidth:"191px",charNameVariant:"h6",scrollingBgSize:"200px"},l=g.useCallback(()=>a&&(n==null?void 0:n(a)),[a,n]),p=g.useCallback(c=>e(le,{onClick:l,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:c}),[l]);return e(te,{children:e(yt,{condition:!!n,wrapper:p,children:d(z,{sx:{display:"flex",flexDirection:"column",width:s.cardWidth},children:[e(va,{characterKey:a,characterStat:o,charCardConfig:s}),e(ya,{characterKey:a,characterStat:o,promotion:i,level:r,charCardConfig:s})]})})})}function va({characterKey:a,characterStat:n,charCardConfig:t}){const{attribute:r,id:i}=n;return d(z,{sx:s=>({width:"100%",height:"100%",position:"relative",display:"flex",background:`${s.palette[r].main}`,zIndex:1,overflow:"hidden"}),children:[d(z,{sx:{position:"absolute",left:"0",right:"0",display:"flex",transform:"rotate(5deg) translateX(-50%)",zIndex:2},children:[e(Oe,{characterKey:a,charCardConfig:t}),e(Oe,{characterKey:a,charCardConfig:t})]}),e(z,{src:`https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_vertical_painting/role_vertical_painting_${i}.png`,component:Y?Y:"img",width:t.charImgWidth,height:"auto",position:"relative",zIndex:"2"})]})}function ya({characterKey:a,characterStat:n,promotion:t,level:r,charCardConfig:i}){const{t:o}=I("page_characters"),{attribute:s,rarity:l,specialty:p}=n,c=ae(a);return e(z,{sx:{width:"100%",height:"100%",padding:"8px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:d(z,{sx:{display:"flex",flexDirection:"column"},children:[d(z,{gap:1,sx:{display:"flex",alignItems:"center"},children:[e(E,{size:i.iconsSize,src:Ee(l)}),e(y,{variant:i.charNameVariant,sx:{fontWeight:"900",maxWidth:i.charNameWidth,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:e(fa,{characterKey:a})}),e(Ct,{ele:s,iconProps:{sx:{fontSize:`${i.iconsSize}em`}}}),e(E,{size:i.iconsSize,src:Le(p)}),i.isEditing?"":e(y,{variant:"h5",color:"primary",sx:{fontWeight:"900"},children:o("mindscape",{level:c?c.mindscape:0})})]}),i.isEditing?"":d(z,{sx:{mt:"12px",display:"flex",gap:"14px",flexWrap:"wrap"},children:[d(z,{sx:u=>({border:`2px solid ${u.palette.contentZzz.main}`,borderRadius:"20px",display:"flex"}),children:[e(y,{sx:{fontWeight:"900",paddingLeft:"12px",fontSize:"16px"},children:o("charLevel",{level:r})}),d(y,{color:"primary",sx:{fontWeight:"900",paddingLeft:"4px",pr:"10px"},children:["/ ",Fe[t]]})]}),d(z,{gap:1.5,sx:{display:"flex",alignItems:"center"},children:[Ne.map((u,C)=>e(_e,{anchorOrigin:{vertical:"bottom",horizontal:"left"},badgeContent:`${c?c[u]:0}`,color:"primary",children:e(E,{size:1.9,src:K(u)})},C)),e(_e,{anchorOrigin:{vertical:"bottom",horizontal:"left"},badgeContent:`${c?c.core:0}`,color:"primary",children:e(E,{size:1.9,src:K("core")})},6)]})]})]})})}function Oe({characterKey:a,charCardConfig:n}){const{t}=I("charNames_gen"),r={animation:"scroll 16s infinite linear","@keyframes scroll":{"0%":{transform:"translateX(-100%)"},"100%":{transform:"translateX(0)"}}};return e(z,{component:"span",sx:{color:"#000",marginTop:"20px",fontStyle:"italic",fontSize:n.scrollingBgSize,lineHeight:"150px",whiteSpace:"nowrap",textTransform:"uppercase",display:"flex",justifyContent:"center",fontFamily:"Impact",opacity:.1,...r},children:t(`${a}`)})}function Ca({mindscape:a,setMindscape:n}){const{t}=I("page_characters");return e(f,{sx:{display:"flex",flexWrap:"wrap",gap:2,mt:"12px"},children:ce(1,6).map(r=>e(f,{children:e(te,{sx:{position:"relative",borderRadius:"40px"},children:e(ua,{control:e(St,{checked:a>=r,onChange:()=>n(r===a?r-1:r)}),label:d(f,{sx:{position:"absolute",top:9,left:a>=r?75:16,transition:"left 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",textAlign:"center"},children:[e(y,{variant:"subtitle1",sx:i=>({fontWeight:900,color:a>=r?i.palette.mindscapeActive.main:i.palette.mindscapeInactive.main}),children:t("mindscape",{level:r})}),e(y,{variant:"subtitle2",sx:i=>({lineHeight:.2,fontWeight:900,color:a>=r?i.palette.mindscapeActive.main:i.palette.mindscapeInactive.main}),children:t("mindscapeTitle")})]}),sx:{margin:0}})})},r))})}function Sa(a){return{new:n=>a.chars.get(n)?0:1,name:n=>je.t(n).toString(),level:n=>{const t=a.chars.get(n);return t?t.level*(t.promotion+1):0},rarity:n=>T(n).rarity??0}}function wa(a){return{attribute:(n,t)=>t.includes(T(n).attribute),specialtyType:(n,t)=>t.includes(T(n).specialty),rarity:(n,t)=>t.includes(T(n).rarity),name:(n,t)=>t===void 0||je.t(n).toLowerCase().includes(t.toLowerCase()),new:(n,t)=>t===void 0||t===(a.chars.get(n)?"no":"yes")}}const Qe={name:["name"],level:["level","rarity","name"],rarity:["rarity","level","name"]};function Va({show:a,onHide:n,onSelect:t,newFirst:r=!1}){const{database:i}=$(),o=Xe(i.displayCharacter),[s,l]=g.useState(""),p=g.useDeferredValue(s),c=g.useDeferredValue(o),u=g.useMemo(()=>{const{attribute:m,specialtyType:h,sortType:b,ascending:x}=c,_=[...r?["new"]:[],...Qe[b]??[]];return wt.filter(Ae({attribute:m,specialtyType:h,name:p},wa(i))).sort(It(_,x,Sa(i),["new"]))},[c,r,p,i]);return e(_a,{show:a,charactersToShow:u,filterSearchSortProps:{searchTerm:s,onChangeSpecialtyFilter:m=>{i.displayCharacter.set({specialtyType:m})},onChangeAttributeFilter:m=>{i.displayCharacter.set({attribute:m})},onChangeSearch:m=>{l(m.target.value)},onChangeSort:m=>{i.displayCharacter.set({sortType:m})},onChangeAsc:m=>{i.displayCharacter.set({ascending:m})}},onClose:()=>{l(""),n()},children:e(L,{sx:{flex:"1",overflow:"auto"},children:e(g.Suspense,{fallback:e(N,{variant:"rectangular",width:"100%",height:1e3}),children:e(P,{container:!0,spacing:.5,columns:{xs:2,sm:3,md:4,lg:5},children:u.map(m=>e(P,{item:!0,xs:1,children:e(H,{bgt:"light",sx:h=>({position:"relative",flexGrow:1,display:"flex",flexDirection:"column",borderRadius:"40px 16px 16px 40px",border:`3px solid ${h.palette.contentZzz.main}`}),children:e(Da,{characterKey:m,onClick:()=>{n(),t(m)}})})},m))})})})})}const Ia=Object.keys(Qe);function _a({show:a,charactersToShow:n,filterSearchSortProps:t,onClose:r,children:i}){const{t:o}=I("page_characters"),{database:s}=$(),l=Xe(s.displayCharacter),p=g.useMemo(()=>Ie(qe,h=>s.chars.entries.forEach(([b,x])=>{const _=T(x.key).specialty;h[_].total++,n.includes(b)&&h[_].current++})),[n,s.chars.entries]),c=g.useMemo(()=>Ie(Pt,h=>Object.entries(s.chars.data).forEach(([b])=>{const x=T(b).attribute;h[x].total++,n.includes(b)&&h[x].current++})),[n,s.chars.data]),{specialtyType:u,attribute:C,sortType:w,ascending:m}=l;return e(he,{open:a,onClose:r,containerProps:{sx:{height:"100vh",p:{xs:1}}},children:d(H,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[d(L,{sx:{display:"flex",flexDirection:"column",gap:1},children:[d(f,{sx:{display:"flex",justifyContent:"space-between"},children:[d(f,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[e(kt,{onChange:h=>s.displayCharacter.set({specialtyType:h}),value:u,totals:p,size:"small"}),e(zt,{onChange:h=>s.displayCharacter.set({attribute:h}),value:C,totals:c,size:"small"})]}),e(de,{sx:{ml:"auto"},onClick:()=>r(),children:e(pe,{})})]}),d(f,{display:"flex",gap:1,children:[e(Tt,{autoFocus:!0,value:t.searchTerm,onChange:h=>t.onChangeSearch(h),label:o("characterName"),size:"small",sx:{height:"100%",mr:"auto"},InputProps:{sx:{height:"100%"}}}),e(Rt,{sortKeys:Ia,value:w,onChange:h=>t.onChangeSort(h),ascending:m,onChangeAsc:h=>t.onChangeAsc(h)})]})]}),e(Z,{}),i]})})}function Da({characterKey:a,onClick:n}){const{t}=I(["page_characters","charNames_gen"]),r=_t(),i=ae(a),{rarity:o,attribute:s}=T(a),{level:l=1,promotion:p=0,mindscape:c=0}=i??{},u=s==="electric"?r.palette[s].light:r.palette[s].main;return e(le,{onClick:n,children:d(f,{sx:{position:"relative",width:"100%",display:"flex",padding:"3px",gap:.5,"&::before":{content:'""',display:"block",position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:.7,background:u}},children:[e(f,{sx:{maxWidth:{xs:"33%",lg:"30%"},alignSelf:"flex-end",display:"flex",flexDirection:"column",zIndex:1,flexShrink:1},children:e(f,{component:Y?Y:"img",src:Dt(a,"interknot")})}),d(f,{sx:{display:"flex",flexDirection:"column",zIndex:1,justifyContent:"space-evenly"},children:[d(f,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e(E,{size:1.5,src:Ee(o)}),e(y,{variant:"subtitle2",sx:C=>({flexGrow:1,color:C.palette.contentNormal.main,fontWeight:"900"}),children:t(`charNames_gen:${a}`)})]}),i?d(f,{sx:C=>({display:"flex",gap:1,alignItems:"center",background:C.palette.contentNormal.main,padding:"4px 12px",borderRadius:"20px"}),children:[d(f,{sx:{textShadow:"0 0 5px gray"},children:[e(y,{variant:"body2",component:"span",whiteSpace:"nowrap",children:t("charLevel",{level:l})}),d(y,{variant:"body2",component:"span",color:"text.secondary",children:["/",Fe[p]]})]}),d(y,{variant:"body2",children:["M",c]})]}):e(y,{component:"span",variant:"body2",children:e(Ot,{color:"electric",children:t("characterEditor.new")})})]})]})})}function Oa(){const{t:a}=I("page_characters"),{database:n}=$(),t=ue(),{core:r=0,promotion:i=0,key:o}=t??{},s=g.useCallback(l=>o&&n.chars.set(o,{core:l}),[n,o]);return e(Ue,{fullWidth:!0,title:a("core",{level:r}),color:"primary",startIcon:e(E,{src:K("core"),size:1.75,sideMargin:!0}),children:ce(0,$t[i]).map(l=>e(He,{selected:r===l,disabled:r===l,onClick:()=>s(l),children:a("core",{level:l})},l))})}var V={},Pe;function Pa(){if(Pe)return V;Pe=1;var a=Wt();Object.defineProperty(V,"__esModule",{value:!0}),V.default=void 0;var n=a(Bt()),t=Mt(),r=(0,n.default)((0,t.jsx)("path",{d:"M6.99 11 3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"}),"SwapHoriz");return V.default=r,V}var ka=Pa();const Q=Et(ka),za={xs:2*3,sm:2*3,md:3*3,lg:4*3,xl:4*3};function Je({disc:a,onChangeId:n,slotKey:t,show:r,onClose:i}){const{t:o}=I(["page_characters","disc"]),{database:s}=$(),l=a==null?void 0:a.id,p=g.useCallback((v,S)=>({...v,...S,slotKeys:[t]}),[t]),[c,u]=g.useReducer(p,{...ea(),slotKeys:[t]}),[C,w]=Lt();g.useEffect(()=>s.discs.followAny(w),[s,w]);const m=Ft(),h=g.useMemo(()=>ta(),[]),b=s.discs.values.filter(v=>v.slotKey===c.slotKeys[0]).length,x=g.useMemo(()=>{const v=Ae(c,h);let S=s.discs.values.filter(v).map(A=>A.id);return l&&s.discs.get(l)&&(S=S.filter(A=>A!==l),S.unshift(l)),C&&S},[c,h,s.discs,l,C]),{numShow:_,setTriggerElement:W}=Nt(za[m],x.length),B=g.useMemo(()=>x.slice(0,_),[x,_]),j=x.length!==b?`${x.length}/${b}`:`${b}`,R={numShowing:B.length,total:j,t:o,namespace:"disc"},[D,k]=g.useState("");return g.useEffect(()=>{jt.includes(D)?(n(null),k(""),i()):D&&(n(D),k(""),i())},[n,i,D]),e(he,{open:r,onClose:i,containerProps:{maxWidth:"xl"},children:d(H,{children:[d(L,{sx:{py:1,display:"flex",alignItems:"center"},children:[e(y,{variant:"h6",children:o("tabEquip.swapDisc")}),e(de,{onClick:i,sx:{ml:"auto"},children:e(pe,{})})]}),e(Z,{}),e(L,{children:e(g.Suspense,{fallback:e(N,{variant:"rectangular",width:"100%",height:200}),children:e(At,{filterOption:c,filterOptionDispatch:u,filteredIds:x,disableSlotFilter:!0})})}),e(Z,{}),d(L,{children:[e(f,{pb:1,display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:e(qt,{showingTextProps:R})}),e(f,{mt:1,children:e(g.Suspense,{fallback:e(N,{variant:"rectangular",width:"100%",height:1e3}),children:d(P,{container:!0,spacing:1,columns:{xs:2,md:3,lg:4},children:[l&&e(P,{item:!0,xs:1,children:e(H,{bgt:"light",sx:{width:"100%",height:"100%"},children:e(le,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>k(t),children:d(f,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e(Ht,{sx:{fontSize:"10em"}}),e(y,{children:o("disc:button.unequipDisc")})]})})})}),B.map(v=>e(P,{item:!0,xs:1,sx:S=>({...l===v&&{"> .MuiCard-root":{outline:`${S.spacing(.5)} solid ${S.palette.warning.main}`}}}),children:e(Ve,{disc:s.discs.get(v),onClick:l===v?void 0:()=>k(v)})},v))]})})}),x.length!==B.length&&e(N,{ref:v=>{v&&W(v)},sx:{borderRadius:1,mt:1},variant:"rectangular",width:"100%",height:100})]})]})})}const Ta={xs:1,sm:2,md:3,lg:3,xl:3};function Ra({setWengine:a,setDisc:n}){const{database:t}=$(),r=g.useContext(Ge),[i,o]=g.useState(),[s,l]=g.useState(""),p=g.useCallback(h=>{l(h)},[]),c=g.useCallback(h=>{o(h)},[]),u=Ut(r==null?void 0:r.equippedWengine),C=r?T(r.key).specialty:qe[0],w=Vt(r==null?void 0:r.equippedDiscs),m=ga(i);return e(f,{children:d(Be,{spacing:2,children:[e(g.Suspense,{fallback:!1,children:s&&e(Gt,{wengineId:s,footer:!0,onClose:()=>l(""),extraButtons:e(Ea,{wengineId:(u==null?void 0:u.id)||"",wengineTypeKey:C,onChangeId:a})})}),e(g.Suspense,{fallback:!1,children:m&&e(Zt,{disc:m,show:!!i,onShow:()=>o(i),onClose:()=>o(void 0),cancelEdit:()=>o(void 0)})}),e(f,{children:u&&u.id&&t.wengines.keys.includes(u.id)?e(Xt,{wengineId:u.id,onEdit:()=>p(u.id),extraButtons:e(Ma,{wengineId:u.id,wengineTypeKey:C,onChangeId:a})}):e($a,{wengineId:"",wengineTypeKey:C,onChangeId:a})}),e(f,{children:e(P,{item:!0,columns:Ta,container:!0,spacing:1,children:!!w&&Object.entries(w).map(([h,b])=>e(P,{item:!0,xs:1,children:b!=null&&b.id&&t.discs.keys.includes(b.id)?e(Ve,{disc:b,extraButtons:e(Ba,{disc:b,slotKey:h,onChangeId:x=>n(h,x)}),onEdit:()=>c(b.id),onLockToggle:()=>t.discs.set(b.id,({lock:x})=>({lock:!x}))}):e(Wa,{slotKey:h,onChangeId:x=>n(h,x)})},(b==null?void 0:b.id)||h))})})]})})}function $a({wengineId:a,wengineTypeKey:n,onChangeId:t}){const[r,i,o]=X();return d(te,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[e(L,{children:d(y,{children:[e(E,{src:Le(n)})," "]})}),e(Z,{}),d(f,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[e(ge,{wengineId:a,wengineTypeKey:n,show:r,onClose:o,onChangeId:t}),e(U,{onClick:i,color:"info",sx:{borderRadius:"1em"},children:e(Q,{sx:{height:100,width:100}})})]})]})}function Wa({slotKey:a,onChangeId:n}){const[t,r,i]=X(),{t:o}=I("disc");return d(te,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[e(L,{children:e(y,{children:o("slotName",{slotKey:a})})}),e(Z,{}),d(f,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[e(Je,{disc:void 0,slotKey:a,show:t,onClose:i,onChangeId:n}),e(U,{onClick:r,color:"info",sx:{borderRadius:"1em"},children:e(Q,{sx:{height:100,width:100}})})]})]})}function Ba({disc:a,slotKey:n,onChangeId:t}){const{t:r}=I("page_characters"),[i,o,s]=X();return d(me,{children:[e(Ze,{title:e(y,{children:r("tabEquip.swapDisc")}),placement:"top",arrow:!0,children:e(U,{color:"info",size:"small",onClick:o,"aria-label":r("tabEquip.swapDisc"),children:e(Q,{})})}),e(Je,{disc:a,slotKey:n,show:i,onClose:s,onChangeId:t})]})}function Ma({wengineId:a,wengineTypeKey:n,onChangeId:t}){const{t:r}=I("page_characters"),[i,o,s]=X();return d(me,{children:[e(Ze,{title:e(y,{children:r("tabEquip.swapWengine")}),placement:"top",arrow:!0,children:e(U,{color:"info",size:"small",onClick:o,children:e(Q,{})})}),e(ge,{wengineId:a,wengineTypeKey:n,onChangeId:t,show:i,onClose:s})]})}function Ea({wengineId:a,wengineTypeKey:n,onChangeId:t}){const{t:r}=I("page_characters"),[i,o,s]=X();return d(me,{children:[e(U,{color:"info",onClick:o,startIcon:e(Q,{}),children:r("tabEquip.swapWengine")}),e(ge,{wengineId:a,wengineTypeKey:n,onChangeId:t,show:i,onClose:s})]})}function La({skillKey:a}){const{database:n}=$(),{t}=I("page_characters"),r=ue(),{[a]:i=0,promotion:o=0,key:s}=r??{},l=g.useCallback(p=>s&&n.chars.set(s,{[a]:p}),[n,s,a]);return e(Ue,{fullWidth:!0,title:t(a,{level:i}),color:"primary",startIcon:e(E,{src:K(a),size:1.75,sideMargin:!0}),children:ce(1,Qt[o]).map(p=>e(He,{selected:i===p,disabled:i===p,onClick:()=>l(p),children:t(a,{level:p})},p))})}const Fa={cardWidth:"500px",charImgWidth:"75%",iconsSize:1.5,isEditing:!0,charNameWidth:"166px",charNameVariant:"h6",scrollingBgSize:"220px"};function Na({onClose:a}){const{t:n}=I(["page_characters"]),t=Jt(),{database:r}=$(),i=ue(),{key:o,equippedDiscs:s,equippedWengine:l}=i,p=g.useCallback(async()=>{const c=n(`${o}`);window.confirm(n("removeCharacter",{value:c}))&&(r.chars.remove(o),t("/characters"))},[r,t,o,n]);return d(f,{display:"flex",flexDirection:"column",gap:1,children:[d(f,{display:"flex",gap:1,children:[e(U,{color:"error",onClick:()=>p(),startIcon:e(Yt,{}),sx:{marginLeft:"auto"},children:n("characterEditor.delete")}),!!a&&e(de,{onClick:a,children:e(pe,{})})]}),e(f,{children:d(P,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[e(P,{item:!0,xs:6,sm:4,md:4,lg:4,xl:4,children:d(H,{sx:{height:"100%",display:"flex",flexDirection:"column",gap:1},children:[e(ba,{characterKey:o,charCardConfig:Fa}),e(f,{sx:{px:1},children:e(Kt,{level:i.level,milestone:i.promotion,setBoth:({level:c,milestone:u})=>r.chars.set(o,{level:c,promotion:u})})}),e(xa,{bgt:"light",character:i}),e(Ca,{mindscape:i.mindscape,setMindscape:c=>r.chars.set(o,{mindscape:c})})]})}),d(P,{item:!0,xs:6,sm:8,md:8,lg:8,xl:8,sx:{display:"flex",flexDirection:"column",gap:1},children:[e(f,{children:d(P,{container:!0,columns:3,spacing:1,children:[Ne.map(c=>e(P,{item:!0,xs:1,children:e(La,{skillKey:c},c)},c)),e(P,{item:!0,xs:1,children:e(Oa,{})},"core")]})}),e(f,{children:e(Ra,{setWengine:c=>{c?r.wengines.set(c,{location:o}):l&&r.wengines.set(l,{location:""})},setDisc:(c,u)=>{u?r.discs.set(u,{location:o}):s[c]&&r.discs.set(s[c],{location:""})}})})]})]})})]})}function Ga({characterKey:a,onClose:n}){return e(he,{open:!!a,onClose:n,children:e(g.Suspense,{fallback:e(N,{variant:"rectangular",width:"100%",height:1e3}),children:a&&e(ja,{characterKey:a,onClose:n},a)})})}function ja({characterKey:a,onClose:n}){const t=ae(a);return e(H,{children:e(L,{sx:{display:"flex",flexDirection:"column",gap:1},children:e(g.Suspense,{fallback:e(N,{variant:"rectangular",width:"100%",height:1e3}),children:t?e(Ge.Provider,{value:t,children:e(Na,{onClose:n})}):e(N,{variant:"rectangular",width:"100%",height:1e3})})})})}export{Ua as A,Ga as C,ba as a,fa as b,Va as c,wa as d,Sa as e,Qe as f,T as g,ae as u};
