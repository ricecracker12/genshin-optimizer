import{af as C,V as f,r as K,b as G,c as J,g as U,i as T,e as a,j as e,T as p,f as x,v as k,G as o,ae as A,C as w,u as N,a as F,z as Z,c1 as v,d as m,B as u,b_ as Q,o as y,h as b,M as X,dn as Y}from"./index-DcHDviyF.js";import{T as ee}from"./TextFieldLazy-DVWnWLQ4.js";const te=C(f.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),ae=C(f.jsx("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download"),ne=C(f.jsx("path",{d:"M9 3 5 6.99h3V14h2V6.99h3L9 3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99h-3z"}),"ImportExport"),re=C(f.jsx("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload");var h={},E;function oe(){if(E)return h;E=1;var r=K();Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var s=r(G()),l=J(),g=(0,s.default)((0,l.jsx)("path",{d:"M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"}),"ContentPaste");return h.default=g,h}var se=oe();const le=U(se);function ce(){const{t:r}=T("page_settings");return a(w,{bgt:"light",children:[e(x,{sx:{py:1},children:e(p,{variant:"subtitle1",children:r("DatabaseCard.title")})}),e(k,{}),e(x,{sx:{display:"flex",flexDirection:"column",gap:2},children:e(o,{container:!0,spacing:2,columns:{xs:1,md:2},children:A(0,3).map(s=>e(o,{item:!0,xs:1,children:e(ie,{index:s})},s))})})]})}function ie({index:r}){const{databases:s,database:l,setDatabase:g}=N(),t=s[r],{name:d,lastEdit:S}=F(t.dbMeta),c=l===t,[B,W,I]=Z(),{t:n}=T("page_settings"),j=v(t.chars).length,z=v(t.discs).length,M=v(t.wengines).length,D=!!(j||z||M),V=m.useCallback(()=>navigator.clipboard.writeText(JSON.stringify(t.exportZOD())).then(()=>alert("Copied database to clipboard.")).catch(console.error),[t]),O=m.useCallback(()=>{window.confirm(`Are you sure you want to delete "${d}"?`)&&(t.clear(),t.toExtraLocalDB())},[t,d]),R=m.useCallback(()=>{const P=new Date().toISOString().split(".")[0].replace("T","_").replaceAll(":","-"),q=JSON.stringify(t.exportZOD()),L=`${d.trim().replaceAll(" ","_")}_${P}.json`,$="application/json;charset=utf-8",i=document.createElement("a");i.download=L,i.href=`data:${$},${encodeURIComponent(q)}`,i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)},[t,d]),H=m.useCallback(()=>{c||(l.toExtraLocalDB(),t.swapStorage(l),g(r,t))},[r,g,l,c,t]);return a(w,{sx:{height:"100%",boxShadow:c?"0px 0px 0px 2px green inset":void 0},children:[a(x,{sx:{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center"},children:[e(ee,{size:"small",fullWidth:!0,value:d,sx:{borderRadius:1,px:1,flexGrow:1},onChange:_=>{t.dbMeta.set({name:_}),t.toExtraLocalDB()}}),!c&&e(u,{startIcon:e(ne,{}),onClick:H,color:"warning",children:n("DatabaseCard.button.swap")}),e(Q,{color:c?"success":"secondary",sx:{alignSelf:"center"},label:c?n("DatabaseCard.currentDB"):`${n("DatabaseCard.title")} ${t.dbIndex}`})]}),e(k,{}),e(x,{children:a(y,{display:"flex",gap:2,children:[a(y,{flexGrow:1,children:[a(p,{noWrap:!0,children:[e(b,{t:n,i18nKey:"count.chars"})," ",e("strong",{children:j})]}),a(p,{noWrap:!0,children:[e(b,{t:n,i18nKey:"count.discs"})," ",e("strong",{children:z})]}),a(p,{noWrap:!0,children:[e(b,{t:n,i18nKey:"count.wengines"})," ",e("strong",{children:M})]})]}),a(y,{children:[a(o,{container:!0,spacing:1,columns:{xs:2},children:[e(o,{item:!0,xs:1,children:e(u,{fullWidth:!0,disabled:!D,color:"info",onClick:V,startIcon:e(le,{}),children:e(b,{t:n,i18nKey:"DatabaseCard.button.copy"})})}),a(o,{item:!0,xs:1,children:[e(X,{open:B,onClose:I,children:e(Y,{index:r,onReplace:I})}),e(u,{fullWidth:!0,component:"span",color:"info",startIcon:e(re,{}),onClick:W,children:n("DatabaseCard.button.upload")})]}),e(o,{item:!0,xs:1,children:e(u,{fullWidth:!0,disabled:!D,onClick:R,startIcon:e(ae,{}),children:n("DatabaseCard.button.download")})}),e(o,{item:!0,xs:1,children:e(u,{fullWidth:!0,disabled:!D,color:"error",onClick:O,startIcon:e(te,{}),children:n("DatabaseCard.button.delete")})})]}),!!S&&e(p,{noWrap:!0,align:"center",style:{paddingTop:"1.5em"},children:e("strong",{children:new Date(S).toLocaleString()})})]})]})})]})}function he(){return e(w,{sx:{my:1},children:e(x,{sx:{display:"flex",flexDirection:"column",gap:2},children:e(ce,{})})})}export{he as default};
