import{bZ as Xs,E as Ys,z as ei,c as _,H as ti,_ as ni,L as Y,b_ as Kn,V as xt,U as St,Q as ae,b$ as F,W as ai,c0 as Yi,c1 as ec,T as I,w as oi,c2 as Nn,c3 as si,c4 as tc,a3 as nc,c5 as ac,a6 as oc,c6 as ii,u as G,aL as vn,aJ as sc,c7 as ic,c8 as cc,c9 as lc,ca as ci,cb as rc,a$ as li,a_ as ri,cc as E,cd as dc,ce as uc,bv as O,b4 as hc,b5 as pc,cf as _t,cg as gc,ch as mc,ci as di,cj as wt,ck as fc,j as a,cl as xn,cm as oe,bn as J,bw as kn,cn as $c,d as x,al as K,ay as ot,co as vt,h as j,av as X,bQ as ui,cp as yc,cq as hi,cr as pi,cs as gi,ct as kt,ad as Dn,n as S,cu as bc,cv as mi,bD as xc,k as fi,bU as _c,e as Z,G as W,C as se,S as ee,N as wc,bH as vc,bb as _n,bV as Gn,bl as $i,aV as Ye,bW as kc,bX as Dc,I as Cn,q as Sn,a1 as Cc,cw as Sc,s as nt,M as Mn,aK as Mt,ab as yi,ac as bi,cx as Mc,i as Tc,l as Ic,m as Rc,ba as zc,D as Bc,bY as Ec,cy as Pc,o as xi,r as Vc,a as Oc,b as qc,g as Ac,br as _i,bz as wi,bx as vi,cz as Fc,y as Wc,cA as jc,x as st,B as ie,cB as Tn,F as Tt,cC as ki,cD as Lc,ag as In,af as Hc,aW as et,ao as Kc,b1 as Nc,cE as Gc,cF as Uc,cG as Jc,aF as Di,aD as yt,ah as Zc,cH as Qc,bt as Xc,cI as Yc,aI as el,cJ as tl,cK as nl,bT as al,cL as ol,cM as sl,cN as N,cO as Ci,a4 as Un,b3 as Jn,cP as il,cQ as cl,b9 as ll,cR as g,aw as R,cS as p,cT as w,aB as $,cU as Si,cV as rl,bC as dl}from"./index-CmZTfitn.js";import{u as Mi}from"./useDataEntryBase-DZ64_HDB.js";import{i as ul,d as hl}from"./discSortUtil-BLW5EOkU.js";function pl(e){const{badgeContent:t,invisible:n=!1,max:s=99,showZero:o=!1}=e,c=Xs({badgeContent:t,max:s});let i=n;n===!1&&t===0&&!o&&(i=!0);const{badgeContent:r,max:d=s}=i?c:e,h=r&&Number(r)>d?`${d}+`:r;return{badgeContent:r,invisible:i,max:d,displayValue:h}}function gl(e){return ei("MuiBadge",e)}const Q=Ys("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),ml=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],tn=10,nn=4,fl=e=>{const{color:t,anchorOrigin:n,invisible:s,overlap:o,variant:c,classes:i={}}=e,r={root:["root"],badge:["badge",c,s&&"invisible",`anchorOrigin${F(n.vertical)}${F(n.horizontal)}`,`anchorOrigin${F(n.vertical)}${F(n.horizontal)}${F(o)}`,`overlap${F(o)}`,t!=="default"&&`color${F(t)}`]};return ai(r,gl,i)},$l=St("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),yl=St("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${F(n.anchorOrigin.vertical)}${F(n.anchorOrigin.horizontal)}${F(n.overlap)}`],n.color!=="default"&&t[`color${F(n.color)}`],n.invisible&&t.invisible]}})(({theme:e})=>{var t;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:tn*2,lineHeight:1,padding:"0 6px",height:tn*2,borderRadius:tn,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.keys(((t=e.vars)!=null?t:e).palette).filter(n=>{var s,o;return((s=e.vars)!=null?s:e).palette[n].main&&((o=e.vars)!=null?o:e).palette[n].contrastText}).map(n=>({props:{color:n},style:{backgroundColor:(e.vars||e).palette[n].main,color:(e.vars||e).palette[n].contrastText}})),{props:{variant:"dot"},style:{borderRadius:nn,height:nn*2,minWidth:nn*2,padding:0}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${Q.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${Q.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${Q.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${Q.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${Q.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${Q.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${Q.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${Q.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]}}),Zn=_.forwardRef(function(t,n){var s,o,c,i,r,d;const h=ti({props:t,name:"MuiBadge"}),{anchorOrigin:b={vertical:"top",horizontal:"right"},className:C,component:k,components:m={},componentsProps:y={},children:v,overlap:D="rectangular",color:P="default",invisible:L=!1,max:H=99,badgeContent:U,slots:A,slotProps:V,showZero:q=!1,variant:M="standard"}=h,T=ni(h,ml),{badgeContent:ne,invisible:Hi,max:Ki,displayValue:Ni}=pl({max:H,invisible:L,badgeContent:U,showZero:q}),Gi=Xs({anchorOrigin:b,color:P,overlap:D,variant:M,badgeContent:U}),An=Hi||ne==null&&M!=="dot",{color:Ui=P,overlap:Ji=D,anchorOrigin:Zi=b,variant:Fn=M}=An?Gi:h,Wn=Fn!=="dot"?Ni:void 0,Xt=Y({},h,{badgeContent:ne,invisible:An,max:Ki,displayValue:Wn,showZero:q,anchorOrigin:Zi,color:Ui,overlap:Ji,variant:Fn}),jn=fl(Xt),Ln=(s=(o=A==null?void 0:A.root)!=null?o:m.Root)!=null?s:$l,Hn=(c=(i=A==null?void 0:A.badge)!=null?i:m.Badge)!=null?c:yl,Yt=(r=V==null?void 0:V.root)!=null?r:y.root,en=(d=V==null?void 0:V.badge)!=null?d:y.badge,Qi=Kn({elementType:Ln,externalSlotProps:Yt,externalForwardedProps:T,additionalProps:{ref:n,as:k},ownerState:Xt,className:xt(Yt==null?void 0:Yt.className,jn.root,C)}),Xi=Kn({elementType:Hn,externalSlotProps:en,ownerState:Xt,className:xt(jn.badge,en==null?void 0:en.className)});return ae.jsxs(Ln,Y({},Qi,{children:[v,ae.jsx(Hn,Y({},Xi,{children:Wn}))]}))});function bl(e){return ei("MuiFormControlLabel",e)}const tt=Ys("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),xl=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],_l=e=>{const{classes:t,disabled:n,labelPlacement:s,error:o,required:c}=e,i={root:["root",n&&"disabled",`labelPlacement${F(s)}`,o&&"error",c&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",o&&"error"]};return ai(i,bl,t)},wl=St("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${tt.label}`]:t.label},t.root,t[`labelPlacement${F(n.labelPlacement)}`]]}})(({theme:e,ownerState:t})=>Y({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${tt.disabled}`]:{cursor:"default"}},t.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},t.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},t.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${tt.label}`]:{[`&.${tt.disabled}`]:{color:(e.vars||e).palette.text.disabled}}})),vl=St("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})(({theme:e})=>({[`&.${tt.error}`]:{color:(e.vars||e).palette.error.main}})),kl=_.forwardRef(function(t,n){var s,o;const c=ti({props:t,name:"MuiFormControlLabel"}),{className:i,componentsProps:r={},control:d,disabled:h,disableTypography:b,label:C,labelPlacement:k="end",required:m,slotProps:y={}}=c,v=ni(c,xl),D=Yi(),P=(s=h??d.props.disabled)!=null?s:D==null?void 0:D.disabled,L=m??d.props.required,H={disabled:P,required:L};["checked","name","onChange","value","inputRef"].forEach(T=>{typeof d.props[T]>"u"&&typeof c[T]<"u"&&(H[T]=c[T])});const U=ec({props:c,muiFormControl:D,states:["error"]}),A=Y({},c,{disabled:P,labelPlacement:k,required:L,error:U.error}),V=_l(A),q=(o=y.typography)!=null?o:r.typography;let M=C;return M!=null&&M.type!==I&&!b&&(M=ae.jsx(I,Y({component:"span"},q,{className:xt(V.label,q==null?void 0:q.className),children:M}))),ae.jsxs(wl,Y({className:xt(V.root,i),ownerState:A,ref:n},v,{children:[_.cloneElement(d,H),L?ae.jsxs(oi,{display:"block",children:[M,ae.jsxs(vl,{ownerState:A,"aria-hidden":!0,className:V.asterisk,children:["â€‰","*"]})]}):M]}))}),Dl={};class Ti{constructor(t,n){this.root=new Cl(t,n)}subset(t){const n=[];return this._subset(t,s=>n.push(...s[Nn].map(o=>o.value))),n}entries(t){const n=[];return this._subset(t,s=>n.push(...s[Nn])),n}_subset(t,n){const s=t.length;function o(c,i){c<s?i.subset(t[c]).forEach(r=>o(c+1,r)):n(i.leaf)}o(0,this.root)}}let Cl=class Ii{constructor(t,n){if(this.children=[],t>0)for(const[s,o]of Object.entries(n)){const c=new Map;for(const[i,r]of Object.entries(o))c.set(+i,new Ii(t-1,r));this.children.push({mask:+s,map:c})}else this.leaf=n}subset(t){return this.children.map(({mask:n,map:s})=>s.get(t&n)).filter(n=>!!n)}};class Qn{constructor(t){this.root=new Rn(void 0),this.keys=t}at(t){const n=this.keys.get(t),s=n.reduce((o,c)=>o.child(c),this.root);return s.leaf||(s.leaf=new zn(t,n,this.keys,s)),s.leaf}}class Rn{constructor(t){this.children=new Map,this.parent=t}child(t){let n=this.children.get(t);return n||(n=new Rn(this),this.children.set(t,n),n)}}class zn{constructor(t,n,s,o){this.tag=Object.fromEntries(Object.entries(t).filter(([c,i])=>i!=null)),this.id=n,this.keys=s,this.internal=o}with(t){const{keys:n}=this,{id:s,firstReplacedByte:o}=n.combine(this.id,t);let c=this.internal;for(let i=o;i<n.tagLen;i++)c=c.parent;for(let i=o;i<n.tagLen;i++)c=c.child(s[i]);return c.leaf||(c.leaf=new zn({...this.tag,...t},s,n,c)),c.leaf}}class Sl{constructor(t,n){this.keys=new si(t),this.values=new Ti(t.tagLen,n)}subset(t){return this.values.subset(this.keys.get(t))}}const at={sum:e=>e.reduce((t,n)=>t+n,0),prod:e=>e.reduce((t,n)=>t*n,1),min:e=>Math.min(...e),max:e=>Math.max(...e),sumfrac:([e,t])=>e/(e+t),unique:([e])=>e},Ri={match:([e,t])=>e===t?0:1,thres:([e,t])=>e>=t?0:1,lookup:([e],t)=>t[e]??0},ft=e=>ac(e,"val");let zi=class{constructor(t,...n){const s=new si(t);this.nodes=new Ti(s.tagLen,tc(n)),this.cache=new Qn(s).at({}),this.calc=new Qn(s).at({}),this.calc.val=this}withTag(t){const n=this.calc.with(t);return n.val??(n.val=Object.assign(new this.constructor(this.cache.keys),this,{cache:this.cache.with(t),calc:n}))}gather(t){return this._gather(this.cache.with(t)).pre}compute(t){return this._compute(t,this.cache)}_gather(t){if(t.val)return t.val;const n=this.nodes.entries(t.id).flatMap(({tag:s,value:o})=>o.op==="reread"?this._gather(t.with(o.tag)).pre:[this.markGathered(t.tag,s,o,this._compute(o,t))]);return t.val={pre:n}}_compute(t,n){const s=(c,i,r,d)=>Object.freeze({val:c,meta:this.computeMeta(t,c,i,r,d)}),{op:o}=t;switch(o){case"const":return s(t.ex,[],[]);case"sum":case"prod":case"min":case"max":case"sumfrac":{const c=t.x.map(i=>this._compute(i,n));return s(at[o](ft(c)),c,[])}case"thres":case"match":case"lookup":{const c=t.br.map(h=>this._compute(h,n)),i=Ri[o](ft(c),t.ex),r=[...Array(t.x.length)],d=r[i]=this._compute(t.x[i],n);return s(d.val,r,c)}case"subscript":{const c=this._compute(t.br[0],n);return s(t.ex[c.val],[],[c])}case"vtag":return s(n.tag[t.ex]??"",[],[]);case"tag":{const c=n.with(t.tag),i=this._compute(t.x[0],c);return s(i.val,[i],[],c.tag)}case"dtag":{const c=t.br.map(d=>this._compute(d,n)),i=n.with(Object.fromEntries(c.map((d,h)=>[t.ex[h],d.val]))),r=this._compute(t.x[0],i);return s(r.val,[r],c,i.tag)}case"read":{const c=n.with(t.tag),i=this._gather(c),{pre:r}=i,d=t.ex??this.defaultAccu(c.tag)??"unique";if(d!==t.ex&&(t={...t,ex:d}),i[d])return i[d];if(oc()&&d==="unique"&&r.length!==1)throw new Error(`Ill-form read for ${ii(c.tag)}`);const h=at[d](ft(r));return i[d]=s(h,r,[],c.tag)}case"custom":{const c=t.x.map(i=>this._compute(i,n));return s(Dl[t.ex].calc(ft(c)),c,[])}default:nc(o)}}defaultAccu(t){}markGathered(t,n,s,o){return o}computeMeta(t,n,s,o,c){}toDebug(){throw new Error("not implemented")}};const Ml={arithmetic:at,branching:Ri};class Tl extends zi{constructor(t,n=ii,s=()=>!0){super(t.cache.keys),this.gathering=new Set,this.nodes=t.nodes,this.tagStr=n,this.filter=s,this.defaultAccu=o=>t.defaultAccu(o),this.cache=this.cache.with(t.cache.tag)}withTag(t){throw new Error("Unimplemented")}_gather(t){if(this.gathering.has(t))throw new Error(`Loop detected for ${this.tagStr(t.tag)}`);this.gathering.add(t);const n=this.__gather(t);return this.gathering.delete(t),n}__gather(t){if(t.val)return t.val;const n=this.nodes.entries(t.id).flatMap(({tag:s,value:o})=>o.op==="reread"?this._gather(t.with(o.tag)).pre.map(c=>{const i=`${this.tagStr(s)} <= ${this.tagStr(o.tag)} : ${c.meta.readSeq}`;return Object.freeze({...c,meta:{...c.meta,readSeq:i}})}):[this.markGathered(t.tag,s,o,this._compute(o,t))]);return t.val={pre:n}}_compute(t,n){try{return super._compute(t,n)}catch(s){return Object.freeze({val:NaN,meta:{formula:`${s}`,deps:[],omitted:[],val:NaN,x:[],br:[],comp:"ERR",pivot:!0,toJSON:Yn}})}}markGathered(t,n,s,o){const c=`${this.tagStr(n)} <- ${this.tagStr(t)}`;return{...o,meta:{...o.meta,readSeq:c,pivot:!0}}}computeMeta(t,n,s,o,c){let i,r;const d=s.filter(m=>m).map(m=>m.meta),h=o.map(m=>m.meta),b=[],C=t.op==="read"?t.ex:t.op,k=[];if(C in at){const m=at[C]([]);for(const y of[...h,...d])y.val!==m||this.filter(y)?b.push(y):k.push(y)}else b.push(...h,...d);switch(t.op){case"const":i=Xn(t.ex);break;case"read":r=`gather ${d.length} node(s)`,r+=` matching ${this.tagStr(c,t.ex)}`,r+=` (for ${this.tagStr(t.tag)})`,k.length&&(r+=` <${k.length} omitted>`),i=`${this.tagStr(t.tag)}`;break;default:{const m=[];t.ex&&t.op!=="subscript"&&m.push(JSON.stringify(t.ex)),t.tag&&m.push(this.tagStr(t.tag)),m.push(...b.map(y=>y.comp)),k.length&&m.push(`<${k.length} omitted>`),i=`${t.op}(`+m.join(", ")+")"}}return k.push(...b.flatMap(m=>m.pivot?[]:m.omitted)),Object.freeze({formula:`[${Xn(n)}] ${r??i}`,deps:[...new Set(b.flatMap(m=>m.pivot?[m]:m.deps))],omitted:[...new Set(k)],val:n,x:d,br:h,comp:i,pivot:t.op==="read",toJSON:Yn})}}const Xn=e=>typeof e=="string"?`"${e}"`:e.toString();function Yn(){const{formula:e,readSeq:t,deps:n}=this,s={readSeq:t,formula:e,deps:n};return s.readSeq||delete s.readSeq,s.deps.length||delete s.deps,Object.keys(s).length===1?s.formula:s}function It(e){const{database:t}=G();return vn(t.chars,e)}function Il(e){const{database:t}=G();return vn(t.charOpts,e)}function Rl(e){const{database:t}=G();return vn(t.discs,e??"")}const{arithmetic:zl}=Ml;let Bl=class extends zi{computeMeta({op:t,ex:n,tag:s},o,c,i,r){let d=c.filter(m=>!!m);const h=El(d,i);function b(m){return Object.freeze(r&&!m.tag?{tag:r,...m}:m)}function C(m,y){return b({op:m,ops:y,...h})}function k(m,y){let{meta:v}=m;return y!=null&&y.some(D=>!v.usedCats.has(D))&&(v={...v,usedCats:new Set([...v.usedCats,...y])}),b(v.conds===h.conds?v:{...v,...h})}if(t==="read"&&(r==null?void 0:r.qt)==="cond"){const{src:m,dst:y,sheet:v,q:D}=r;m&&v&&D&&(h.conds=Dt(h.conds,{[y??"All"]:{[m]:{[v]:{[D]:o}}}}))}switch(t==="read"&&n!=="unique"&&([t,n]=[n,void 0]),t){case"sum":case"prod":case"min":case"max":case"sumfrac":if(d.length>1){const m=zl[t]([]);d=d.filter(y=>y.val!==m)}return d.length===1?k(d[0]):C(d.length?t:"const",d);case"const":case"subscript":return C("const",[]);case"vtag":return h.usedCats=new Set([n]),C("const",[]);case"match":case"thres":case"lookup":case"read":return k(d[0]);case"tag":return k(d[0],Object.keys(s));case"dtag":return k(d[0],n);case"custom":return C(n,d);default:sc(t)}}markGathered(t,n,s,o){const{val:c}=o,i={...o.meta};let r=!1;const d=new Set([...i.usedCats,...Object.keys(n)]);return i.usedCats.size!==d.size&&(i.usedCats=d,r=!0),r?{val:c,meta:Object.freeze(i)}:o}listFormulas(t){return this.gather(t.tag).filter(n=>n.val).map(({val:n,meta:s})=>ic.withTag(s.tag)[n])}listCondFormulas(t){return this.listFormulas(t).map(n=>this.compute(n).meta.conds).reduce(Dt,{})}};function El(e,t){var i;const n=[...e.map(r=>r.meta),...t.map(r=>r.meta)];let s={},o=new Set;for(const r of n)s=Dt(s,r.conds),r.usedCats.forEach(d=>o.add(d));const c=o.size;return o=((i=n.find(r=>r.usedCats.size===c))==null?void 0:i.usedCats)??o,{usedCats:o,conds:s}}function Dt(e,t){if(e===t)return e;if(typeof e!="object")throw new Error(`cannot merge ${e} and ${t}`);if(Object.keys(t).length>Object.keys(e).length&&([e,t]=[t,e]),!Object.keys(t).length)return e;let n=!1;const s={...e};for(const[o,c]of Object.entries(t)){const i=s[o],r=o in s?Dt(i,c):c;i!==r&&(s[o]=r,n=!0)}return Object.freeze(n?s:e)}function Pl(e){const t=new Set(e);return n=>!Vl(n,t)}function Vl(e,t){const n=e.formula.match(/(\S+) (\S+) common.count/);if(!n)return!1;const[,s,o]=n;return o==="own"&&t.has(s)}class Ol extends Bl{toDebug(){return new Tl(this,cc,Pl([...li,...ri]))}defaultAccu(t){var o,c,i,r;const{qt:n,q:s}=t;if(!(!n||!s))switch(t.et){case"own":case"target":return(c=(o=ci[n])==null?void 0:o[s])==null?void 0:c.accu;case"enemy":return(r=(i=lc[n])==null?void 0:i[s])==null?void 0:r.accu;case"team":if(n==="common"&&s==="count")return"sum";throw new Error("non-explicit team value accumulator")}}listFormulas(t){return super.listFormulas(t).filter(n=>rc)}}function bt(e,...t){return t.map(({tag:n,value:s})=>({tag:{...n,preset:e},value:s}))}function Bi(e,...t){return t.map(({tag:n,value:s})=>({tag:{...n,src:e},value:s}))}function Ei(e){const{lvl:t,promotion:n,basic:s,dodge:o,special:c,chain:i,assist:r,core:d,mindscape:h}=O.char,{char:b,iso:C,[e.key]:k}=E.withAll("sheet",[]);return[b.reread(k),C.reread(k),t.add(e.level),s.add(e.basic),o.add(e.dodge),c.add(e.special),i.add(e.chain),r.add(e.assist),d.add(e.core),n.add(e.promotion),h.add(e.mindscape),_t.base.crit_.add(.05),_t.base.crit_dmg_.add(.5)]}function ql(e){return[E.sheet("agg").reread(E.sheet("wengine")),...e?[O.common.count.sheet(e.key).add(1),O.wengine.lvl.add(e.level),O.wengine.modification.add(e.modification),O.wengine.phase.add(e.phase)]:[]]}function Pi(e,t){const{common:{count:n},initial:s}=gc(ci,{sheet:"disc",et:"own"});return[E.sheet("agg").reread(E.sheet("disc")),E.withTag({sheet:"disc",qt:"initial"}).reread(E.sheet("dyn")),...Object.entries(e).map(([o,c])=>mc(s,o).sheet("dyn").add(c)),...Object.entries(t).map(([o,c])=>n.sheet(o).add(c))]}function Al(e){const t={},n={};return e.forEach(({setKey:s,mainStatKey:o,substats:c,level:i,rarity:r})=>{t[s]=(t[s]??0)+1,n[o]=(n[o]??0)+hc(r,o,i),c.forEach(({key:d,upgrades:h})=>{!d||!h||(n[d]=(n[d]??0)+pc(d,r)*h)})}),Pi(n,t)}function Vi(e){const t=E.with("et","team"),{own:n,enemy:s,teamBuff:o,notOwnBuff:c}=E.sheet("agg").withAll("et",[]);return[e.map(i=>E.withTag({et:"target",dst:i}).reread(E.withTag({et:"own",dst:null,src:i}))),e.flatMap(i=>{const r=n.with("src",i);return e.map(d=>r.reread(o.withTag({dst:i,src:d,name:null})))}),e.flatMap(i=>{const r=n.with("src",i);return e.filter(d=>d!==i).map(d=>r.reread(c.withTag({dst:i,src:d,name:null})))}),e.map(i=>s.reread(E.withTag({et:"enemyDeBuff",dst:null,src:i,name:null}))),e.flatMap((i,r)=>{const{stackIn:d,stackTmp:h}=E.withAll("qt",[]),b=E.withTag({src:i,et:"own"});return[b.with("qt","stackTmp").add(dc(d,0,r+1)),b.with("qt","stackOut").add(uc(h.max.with("et","team"),r+1,d))]}),e.map(i=>t.add(E.withTag({src:i,et:"own"})))].flat()}function Oi(e){const t=di(wt,e);return new Ol(wt,fc,t)}function Fl(e){return new Sl(wt,di(wt,e))}function Wl({characterKey:e}){return a(xn,{ns:"charNames_gen",key18:e})}function jl({attribute:e}){return oe[e]}function Ll({characterKey:e,onClick:t,charCardConfig:n}){const{level:s=0,promotion:o=0}=It(e)??{},c=J(e),i=n||{cardWidth:"100%",charImgWidth:"100%",iconsSize:1.7,isEditing:!1,charNameWidth:"191px",charNameVariant:"h6",scrollingBgSize:"200px"},r=_.useCallback(()=>e&&(t==null?void 0:t(e)),[e,t]),d=_.useCallback(h=>a(kn,{onClick:r,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:h}),[r]);return a(ot,{children:a($c,{condition:!!t,wrapper:d,children:x(K,{sx:{display:"flex",flexDirection:"column",width:i.cardWidth},children:[a(Hl,{characterKey:e,characterStat:c,charCardConfig:i}),a(Kl,{characterKey:e,characterStat:c,promotion:o,level:s,charCardConfig:i})]})})})}function Hl({characterKey:e,characterStat:t,charCardConfig:n}){const{attribute:s,id:o}=t;return x(K,{sx:i=>({width:"100%",height:"100%",position:"relative",display:"flex",background:`${i.palette[s].main}`,zIndex:1,overflow:"hidden"}),children:[x(K,{sx:{position:"absolute",left:"0",right:"0",display:"flex",transform:"rotate(5deg) translateX(-50%)",zIndex:2},children:[a(ea,{characterKey:e,charCardConfig:n}),a(ea,{characterKey:e,charCardConfig:n})]}),a(K,{src:`https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_vertical_painting/role_vertical_painting_${o}.png`,component:vt?vt:"img",width:n.charImgWidth,height:"auto",position:"relative",zIndex:"2"})]})}function Kl({characterKey:e,characterStat:t,promotion:n,level:s,charCardConfig:o}){const{t:c}=j("page_characters"),{attribute:i,rarity:r,specialty:d}=t,h=It(e);return a(K,{sx:{width:"100%",height:"100%",padding:"8px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:x(K,{sx:{display:"flex",flexDirection:"column"},children:[x(K,{gap:1,sx:{display:"flex",alignItems:"center"},children:[a(X,{size:o.iconsSize,src:ui(r)}),a(I,{variant:o.charNameVariant,sx:{fontWeight:"900",maxWidth:o.charNameWidth,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:a(Wl,{characterKey:e})}),a(yc,{ele:i,iconProps:{sx:{fontSize:`${o.iconsSize}em`}}}),a(X,{size:o.iconsSize,src:hi(d)}),o.isEditing?"":a(I,{variant:"h5",color:"primary",sx:{fontWeight:"900"},children:c("mindscape",{level:h?h.mindscape:0})})]}),o.isEditing?"":x(K,{sx:{mt:"12px",display:"flex",gap:"14px",flexWrap:"wrap"},children:[x(K,{sx:b=>({border:`2px solid ${b.palette.contentZzz.main}`,borderRadius:"20px",display:"flex"}),children:[a(I,{sx:{fontWeight:"900",paddingLeft:"12px",fontSize:"16px"},children:c("charLevel",{level:s})}),x(I,{color:"primary",sx:{fontWeight:"900",paddingLeft:"4px",pr:"10px"},children:["/ ",pi[n]]})]}),x(K,{gap:1.5,sx:{display:"flex",alignItems:"center"},children:[gi.map((b,C)=>a(Zn,{anchorOrigin:{vertical:"bottom",horizontal:"left"},badgeContent:`${h?h[b]:0}`,color:"primary",children:a(X,{size:1.9,src:kt(b)})},C)),a(Zn,{anchorOrigin:{vertical:"bottom",horizontal:"left"},badgeContent:`${h?h.core:0}`,color:"primary",children:a(X,{size:1.9,src:kt("core")})},6)]})]})]})})}function ea({characterKey:e,charCardConfig:t}){const{t:n}=j("charNames_gen"),s={animation:"scroll 16s infinite linear","@keyframes scroll":{"0%":{transform:"translateX(-100%)"},"100%":{transform:"translateX(0)"}}};return a(K,{component:"span",sx:{color:"#000",marginTop:"20px",fontStyle:"italic",fontSize:t.scrollingBgSize,lineHeight:"150px",whiteSpace:"nowrap",textTransform:"uppercase",display:"flex",justifyContent:"center",fontFamily:"Impact",opacity:.1,...s},children:n(`${e}`)})}function Nl({mindscape:e,setMindscape:t}){const{t:n}=j("page_characters");return a(S,{sx:{display:"flex",flexWrap:"wrap",gap:2,mt:"12px"},children:Dn(1,6).map(s=>a(S,{children:a(ot,{sx:{position:"relative",borderRadius:"40px"},children:a(kl,{control:a(bc,{checked:e>=s,onChange:()=>t(s===e?s-1:s)}),label:x(S,{sx:{position:"absolute",top:9,left:e>=s?75:16,transition:"left 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",textAlign:"center"},children:[a(I,{variant:"subtitle1",sx:o=>({fontWeight:900,color:e>=s?o.palette.mindscapeActive.main:o.palette.mindscapeInactive.main}),children:n("mindscape",{level:s})}),a(I,{variant:"subtitle2",sx:o=>({lineHeight:.2,fontWeight:900,color:e>=s?o.palette.mindscapeActive.main:o.palette.mindscapeInactive.main}),children:n("mindscapeTitle")})]}),sx:{margin:0}})})},s))})}function Gl(e){return{new:t=>e.chars.get(t)?0:1,name:t=>mi.t(t).toString(),level:t=>{const n=e.chars.get(t);return n?n.level*(n.promotion+1):0},rarity:t=>J(t).rarity??0}}function Ul(e){return{attribute:(t,n)=>n.includes(J(t).attribute),specialtyType:(t,n)=>n.includes(J(t).specialty),rarity:(t,n)=>n.includes(J(t).rarity),name:(t,n)=>n===void 0||mi.t(t).toLowerCase().includes(n.toLowerCase()),new:(t,n)=>n===void 0||n===(e.chars.get(t)?"no":"yes")}}const qi={name:["name"],level:["level","rarity","name"],rarity:["rarity","level","name"]};function Fm({show:e,onHide:t,onSelect:n,newFirst:s=!1}){const{database:o}=G(),c=Mi(o.displayCharacter),[i,r]=_.useState(""),d=_.useDeferredValue(i),h=_.useDeferredValue(c),b=_.useMemo(()=>{const{attribute:m,specialtyType:y,sortType:v,ascending:D}=h,P=[...s?["new"]:[],...qi[v]??[]];return xc.filter(fi({attribute:m,specialtyType:y,name:d},Ul(o))).sort(_c(P,D,Gl(o),["new"]))},[h,s,d,o]);return a(Zl,{show:e,charactersToShow:b,filterSearchSortProps:{searchTerm:i,onChangeSpecialtyFilter:m=>{o.displayCharacter.set({specialtyType:m})},onChangeAttributeFilter:m=>{o.displayCharacter.set({attribute:m})},onChangeSearch:m=>{r(m.target.value)},onChangeSort:m=>{o.displayCharacter.set({sortType:m})},onChangeAsc:m=>{o.displayCharacter.set({ascending:m})}},onClose:()=>{r(""),t()},children:a(Z,{sx:{flex:"1",overflow:"auto"},children:a(_.Suspense,{fallback:a(ee,{variant:"rectangular",width:"100%",height:1e3}),children:a(W,{container:!0,spacing:.5,columns:{xs:2,sm:3,md:4,lg:5},children:b.map(m=>a(W,{item:!0,xs:1,children:a(se,{bgt:"light",sx:y=>({position:"relative",flexGrow:1,display:"flex",flexDirection:"column",borderRadius:"40px 16px 16px 40px",border:`3px solid ${y.palette.contentZzz.main}`}),children:a(Ql,{characterKey:m,onClick:()=>{t(),n(m)}})})},m))})})})})}const Jl=Object.keys(qi);function Zl({show:e,charactersToShow:t,filterSearchSortProps:n,onClose:s,children:o}){const{t:c}=j("page_characters"),{database:i}=G(),r=Mi(i.displayCharacter),d=_.useMemo(()=>Gn($i,y=>i.chars.entries.forEach(([v,D])=>{const P=J(D.key).specialty;y[P].total++,t.includes(v)&&y[P].current++})),[t,i.chars.entries]),h=_.useMemo(()=>Gn(Ye,y=>Object.entries(i.chars.data).forEach(([v])=>{const D=J(v).attribute;y[D].total++,t.includes(v)&&y[D].current++})),[t,i.chars.data]),{specialtyType:b,attribute:C,sortType:k,ascending:m}=r;return a(Mn,{open:e,onClose:s,containerProps:{sx:{height:"100vh",p:{xs:1}}},children:x(se,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[x(Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[x(S,{sx:{display:"flex",justifyContent:"space-between"},children:[x(S,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[a(kc,{onChange:y=>i.displayCharacter.set({specialtyType:y}),value:b,totals:d,size:"small"}),a(Dc,{onChange:y=>i.displayCharacter.set({attribute:y}),value:C,totals:h,size:"small"})]}),a(Cn,{sx:{ml:"auto"},onClick:()=>s(),children:a(Sn,{})})]}),x(S,{display:"flex",gap:1,children:[a(Cc,{autoFocus:!0,value:n.searchTerm,onChange:y=>n.onChangeSearch(y),label:c("characterName"),size:"small",sx:{height:"100%",mr:"auto"},InputProps:{sx:{height:"100%"}}}),a(Sc,{sortKeys:Jl,value:k,onChange:y=>n.onChangeSort(y),ascending:m,onChangeAsc:y=>n.onChangeAsc(y)})]})]}),a(nt,{}),o]})})}function Ql({characterKey:e,onClick:t}){const{t:n}=j(["page_characters","charNames_gen"]),s=wc(),o=It(e),{rarity:c,attribute:i}=J(e),{level:r=1,promotion:d=0,mindscape:h=0}=o??{},b=i==="electric"?s.palette[i].light:s.palette[i].main;return a(kn,{onClick:t,children:x(S,{sx:{position:"relative",width:"100%",display:"flex",padding:"3px",gap:.5,"&::before":{content:'""',display:"block",position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:.7,background:b}},children:[a(S,{sx:{maxWidth:{xs:"33%",lg:"30%"},alignSelf:"flex-end",display:"flex",flexDirection:"column",zIndex:1,flexShrink:1},children:a(S,{component:vt?vt:"img",src:vc(e,"interknot")})}),x(S,{sx:{display:"flex",flexDirection:"column",zIndex:1,justifyContent:"space-evenly"},children:[x(S,{sx:{display:"flex",alignItems:"center",gap:.5},children:[a(X,{size:1.5,src:ui(c)}),a(I,{variant:"subtitle2",sx:C=>({flexGrow:1,color:C.palette.contentNormal.main,fontWeight:"900"}),children:n(`charNames_gen:${e}`)})]}),o?x(S,{sx:C=>({display:"flex",gap:1,alignItems:"center",background:C.palette.contentNormal.main,padding:"4px 12px",borderRadius:"20px"}),children:[x(S,{sx:{textShadow:"0 0 5px gray"},children:[a(I,{variant:"body2",component:"span",whiteSpace:"nowrap",children:n("charLevel",{level:r})}),x(I,{variant:"body2",component:"span",color:"text.secondary",children:["/",pi[d]]})]}),x(I,{variant:"body2",children:["M",h]})]}):a(I,{component:"span",variant:"body2",children:a(_n,{color:"electric",children:n("characterEditor.new")})})]})]})})}function Xl(){const{t:e}=j("page_characters"),{database:t}=G(),n=Mt(),{core:s=0,promotion:o=0,key:c}=n??{},i=_.useCallback(r=>c&&t.chars.set(c,{core:r}),[t,c]);return a(bi,{fullWidth:!0,title:e("core",{level:s}),color:"primary",startIcon:a(X,{src:kt("core"),size:1.75,sideMargin:!0}),children:Dn(0,Mc[o]).map(r=>a(yi,{selected:s===r,disabled:s===r,onClick:()=>i(r),children:e("core",{level:r})},r))})}const Yl={xs:2*3,sm:2*3,md:3*3,lg:4*3,xl:4*3};function Ai({disc:e,onChangeId:t,slotKey:n,show:s,onClose:o}){const{t:c}=j(["page_characters","disc"]),{database:i}=G(),r=e==null?void 0:e.id,d=_.useCallback((M,T)=>({...M,...T,slotKeys:[n]}),[n]),[h,b]=_.useReducer(d,{...ul(),slotKeys:[n]}),[C,k]=Tc();_.useEffect(()=>i.discs.followAny(k),[i,k]);const m=Ic(),y=_.useMemo(()=>hl(),[]),v=i.discs.values.filter(M=>M.slotKey===h.slotKeys[0]).length,D=_.useMemo(()=>{const M=fi(h,y);let T=i.discs.values.filter(M).map(ne=>ne.id);return r&&i.discs.get(r)&&(T=T.filter(ne=>ne!==r),T.unshift(r)),C&&T},[h,y,i.discs,r,C]),{numShow:P,setTriggerElement:L}=Rc(Yl[m],D.length),H=_.useMemo(()=>D.slice(0,P),[D,P]),U=D.length!==v?`${D.length}/${v}`:`${v}`,A={numShowing:H.length,total:U,t:c,namespace:"disc"},[V,q]=_.useState("");return _.useEffect(()=>{zc.includes(V)?(t(null),q(""),o()):V&&(t(V),q(""),o())},[t,o,V]),a(Mn,{open:s,onClose:o,containerProps:{maxWidth:"xl"},children:x(se,{children:[x(Z,{sx:{py:1,display:"flex",alignItems:"center"},children:[a(I,{variant:"h6",children:c("tabEquip.swapDisc")}),a(Cn,{onClick:o,sx:{ml:"auto"},children:a(Sn,{})})]}),a(nt,{}),a(Z,{children:a(_.Suspense,{fallback:a(ee,{variant:"rectangular",width:"100%",height:200}),children:a(Bc,{filterOption:h,filterOptionDispatch:b,filteredIds:D,disableSlotFilter:!0})})}),a(nt,{}),x(Z,{children:[a(S,{pb:1,display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:a(Ec,{showingTextProps:A})}),a(S,{mt:1,children:a(_.Suspense,{fallback:a(ee,{variant:"rectangular",width:"100%",height:1e3}),children:x(W,{container:!0,spacing:1,columns:{xs:2,md:3,lg:4},children:[r&&a(W,{item:!0,xs:1,children:a(se,{bgt:"light",sx:{width:"100%",height:"100%"},children:a(kn,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>q(n),children:x(S,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[a(Pc,{sx:{fontSize:"10em"}}),a(I,{children:c("disc:button.unequipDisc")})]})})})}),H.map(M=>a(W,{item:!0,xs:1,sx:T=>({...r===M&&{"> .MuiCard-root":{outline:`${T.spacing(.5)} solid ${T.palette.warning.main}`}}}),children:a(xi,{disc:i.discs.get(M),onClick:r===M?void 0:()=>q(M)})},M))]})})}),D.length!==H.length&&a(ee,{ref:M=>{M&&L(M)},sx:{borderRadius:1,mt:1},variant:"rectangular",width:"100%",height:100})]})]})})}var Xe={},ta;function er(){if(ta)return Xe;ta=1;var e=Vc();Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.default=void 0;var t=e(Oc()),n=qc(),s=(0,t.default)((0,n.jsx)("path",{d:"M6.99 11 3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"}),"SwapHoriz");return Xe.default=s,Xe}var tr=er();const it=Ac(tr),nr={xs:1,sm:2,md:3,lg:3,xl:3};function ar({setWengine:e,setDisc:t}){const{database:n}=G(),s=_.useContext(_i),[o,c]=_.useState(),[i,r]=_.useState(""),d=_.useCallback(y=>{r(y)},[]),h=_.useCallback(y=>{c(y)},[]),b=wi(s==null?void 0:s.equippedWengine),C=s?J(s.key).specialty:$i[0],k=vi(s==null?void 0:s.equippedDiscs),m=Rl(o);return a(S,{children:x(oi,{spacing:2,children:[a(_.Suspense,{fallback:!1,children:i&&a(Fc,{wengineId:i,footer:!0,onClose:()=>r(""),extraButtons:a(lr,{wengineId:(b==null?void 0:b.id)||"",wengineTypeKey:C,onChangeId:e})})}),a(_.Suspense,{fallback:!1,children:m&&a(Wc,{disc:m,show:!!o,onShow:()=>c(o),onClose:()=>c(void 0),cancelEdit:()=>c(void 0)})}),a(S,{children:b&&b.id&&n.wengines.keys.includes(b.id)?a(jc,{wengineId:b.id,onEdit:()=>d(b.id),extraButtons:a(cr,{wengineId:b.id,wengineTypeKey:C,onChangeId:e})}):a(or,{wengineId:"",wengineTypeKey:C,onChangeId:e})}),a(S,{children:a(W,{item:!0,columns:nr,container:!0,spacing:1,children:!!k&&Object.entries(k).map(([y,v])=>a(W,{item:!0,xs:1,children:v!=null&&v.id&&n.discs.keys.includes(v.id)?a(xi,{disc:v,extraButtons:a(ir,{disc:v,slotKey:y,onChangeId:D=>t(y,D)}),onEdit:()=>h(v.id),onLockToggle:()=>n.discs.set(v.id,({lock:D})=>({lock:!D}))}):a(sr,{slotKey:y,onChangeId:D=>t(y,D)})},(v==null?void 0:v.id)||y))})})]})})}function or({wengineId:e,wengineTypeKey:t,onChangeId:n}){const[s,o,c]=st();return x(ot,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[a(Z,{children:x(I,{children:[a(X,{src:hi(t)})," "]})}),a(nt,{}),x(S,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[a(Tn,{wengineId:e,wengineTypeKey:t,show:s,onClose:c,onChangeId:n}),a(ie,{onClick:o,color:"info",sx:{borderRadius:"1em"},children:a(it,{sx:{height:100,width:100}})})]})]})}function sr({slotKey:e,onChangeId:t}){const[n,s,o]=st(),{t:c}=j("disc");return x(ot,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[a(Z,{children:a(I,{children:c("slotName",{slotKey:e})})}),a(nt,{}),x(S,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[a(Ai,{disc:void 0,slotKey:e,show:n,onClose:o,onChangeId:t}),a(ie,{onClick:s,color:"info",sx:{borderRadius:"1em"},children:a(it,{sx:{height:100,width:100}})})]})]})}function ir({disc:e,slotKey:t,onChangeId:n}){const{t:s}=j("page_characters"),[o,c,i]=st();return x(Tt,{children:[a(ki,{title:a(I,{children:s("tabEquip.swapDisc")}),placement:"top",arrow:!0,children:a(ie,{color:"info",size:"small",onClick:c,"aria-label":s("tabEquip.swapDisc"),children:a(it,{})})}),a(Ai,{disc:e,slotKey:t,show:o,onClose:i,onChangeId:n})]})}function cr({wengineId:e,wengineTypeKey:t,onChangeId:n}){const{t:s}=j("page_characters"),[o,c,i]=st();return x(Tt,{children:[a(ki,{title:a(I,{children:s("tabEquip.swapWengine")}),placement:"top",arrow:!0,children:a(ie,{color:"info",size:"small",onClick:c,children:a(it,{})})}),a(Tn,{wengineId:e,wengineTypeKey:t,onChangeId:n,show:o,onClose:i})]})}function lr({wengineId:e,wengineTypeKey:t,onChangeId:n}){const{t:s}=j("page_characters"),[o,c,i]=st();return x(Tt,{children:[a(ie,{color:"info",onClick:c,startIcon:a(it,{}),children:s("tabEquip.swapWengine")}),a(Tn,{wengineId:e,wengineTypeKey:t,onChangeId:n,show:o,onClose:i})]})}function rr({skillKey:e}){const{database:t}=G(),{t:n}=j("page_characters"),s=Mt(),{[e]:o=0,promotion:c=0,key:i}=s??{},r=_.useCallback(d=>i&&t.chars.set(i,{[e]:d}),[t,i,e]);return a(bi,{fullWidth:!0,title:n(e,{level:o}),color:"primary",startIcon:a(X,{src:kt(e),size:1.75,sideMargin:!0}),children:Dn(1,Lc[c]).map(d=>a(yi,{selected:o===d,disabled:o===d,onClick:()=>r(d),children:n(e,{level:d})},d))})}function Rt(){const e=_.useContext(In),t=_.useContext(Hc);return _.useMemo(()=>e==null?void 0:e.withTag(t),[e,t])}function u(e,t){return[(n,s)=>a(xn,{ns:`${e}_${t}_gen`,key18:n,values:s}),(n,s)=>a(xn,{ns:`${e}_${t}`,key18:n,values:s})]}function l(e){return{title:a(Bn,{tag:e}),fieldRef:e}}function dr(e){if(!e)return"";const{et:t,q:n,qt:s,name:o}=e;return t==="own"&&s==="formula"&&n!=="base"?o??n??"":n??""}const ur={initial:"Initial",combat:"Combat",final:"Final",base:"Base"};function Bn({tag:e,showPercent:t}){return a(et,{color:Rm(e),children:a(gr,{tag:e,showPercent:t})})}function Wm({tag:e,showPercent:t}){return x(Tt,{children:[a(Bn,{tag:e,showPercent:t}),Bm(e).map(n=>a(_n,{children:Ct[n]},n)),e.attribute&&a(_n,{color:e.attribute,children:a(jl,{attribute:e.attribute})})]})}const hr=["hp","hp_","atk","atk_","def","def_"],pr=e=>hr.includes(e),na={dmg_:"DMG",common_dmg_:"DMG",defIgn_:"DEF Ignore",resIgn_:"Res Ignore"};function gr({tag:e,showPercent:t}){var c;const n=Rt(),s=(c=Em.subset(e)[0])==null?void 0:c.title;if(s)return s;if(e.qt==="cond"&&e.q&&e.sheet&&n){const i=wn.get(`${e.sheet}:${e.q}`);if(i)return Kc(i.label,n,n==null?void 0:n.compute(new Nc(e,"max")).val)}const o=dr(e);if(pr(o))return x("span",{children:[a(Uc,{statKey:o,iconProps:Gc})," ",x("span",{children:[(e.qt&&ur[e.qt])??e.qt," ",Jc[o],t&&Di(o)]})]});if(na[o]){const i=[...e.attribute?[oe[e.attribute]]:[],...e.damageType1?[Ct[e.damageType1]]:[],...e.damageType2?[Ct[e.damageType2]]:[],na[o]];return a("span",{children:i.join(" ")})}return a(yt,{statKey:o,showPercent:t})}function mr(){const e=Rt();return a(ot,{children:a(Z,{children:e==null?void 0:e.listFormulas(O.listing.formulas).map((t,n)=>a(fr,{read:t},n))})})}function fr({read:e}){var v,D,P,L,H,U,A;const t=Rt(),{setRead:n}=_.useContext(Zc),s=Mt(),o=Il(s==null?void 0:s.key),c=e.tag.sheet===((v=o==null?void 0:o.target)==null?void 0:v.sheet)&&e.tag.name===((D=o==null?void 0:o.target)==null?void 0:D.name)||((P=o==null?void 0:o.target)==null?void 0:P.q)===e.tag.q,i=_.useMemo(()=>{var V,q,M,T;return e.tag.sheet===((V=o==null?void 0:o.target)==null?void 0:V.sheet)&&e.tag.name===((q=o==null?void 0:o.target)==null?void 0:q.name)?Qc(e.tag,(M=o==null?void 0:o.target)==null?void 0:M.damageType1,(T=o==null?void 0:o.target)==null?void 0:T.damageType2):e.tag},[e.tag,(L=o==null?void 0:o.target)==null?void 0:L.sheet,(H=o==null?void 0:o.target)==null?void 0:H.name,(U=o==null?void 0:o.target)==null?void 0:U.damageType1,(A=o==null?void 0:o.target)==null?void 0:A.damageType2]),r=_.useMemo(()=>({...e,tag:i}),[i,e]),d=t==null?void 0:t.compute(r),h=i.name||i.q,{statHighlight:b,setStatHighlight:C}=_.useContext(Xc),k=i.name?"":i.attribute?`${i.attribute}_${i.q}`:i.q==="cappedCrit_"?"crit_":i.q,m=k?Yc(b,k):!1;if(!d)return null;const y=el(d.val,Di(h??""));return x(S,{onMouseEnter:()=>k&&C(k),onMouseLeave:()=>C(""),sx:{display:"flex",gap:1,alignItems:"center",p:.5,borderRadius:.5,backgroundColor:c?"rgba(0,200,0,0.2)":void 0,position:"relative","::after":{content:'""',position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:.5,backgroundColor:tl(m),transition:"background-color 0.3s ease-in-out",pointerEvents:"none"}},children:[a(S,{sx:{flexGrow:1},children:a(Bn,{tag:i})}),y,a(nl,{tag:i,onClick:()=>{n(r)}})]})}function jm({characterKey:e,onClose:t}){return a(Mn,{open:!!e,onClose:t,children:a(_.Suspense,{fallback:a(ee,{variant:"rectangular",width:"100%",height:1e3}),children:e&&a($r,{characterKey:e,onClose:t},e)})})}function $r({characterKey:e,onClose:t}){const n=It(e);return a(se,{children:a(Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:a(_.Suspense,{fallback:a(ee,{variant:"rectangular",width:"100%",height:1e3}),children:n?a(_i.Provider,{value:n,children:a(br,{onClose:t})}):a(ee,{variant:"rectangular",width:"100%",height:1e3})})})})}const yr={cardWidth:"500px",charImgWidth:"75%",iconsSize:1.5,isEditing:!0,charNameWidth:"166px",charNameVariant:"h6",scrollingBgSize:"220px"};function br({onClose:e}){const{t}=j(["page_characters"]),n=al(),{database:s}=G(),o=Mt(),{key:c,equippedDiscs:i,equippedWengine:r}=o,d=_.useCallback(async()=>{const h=t(`${c}`);window.confirm(t("removeCharacter",{value:h}))&&(s.chars.remove(c),n("/characters"))},[s,n,c,t]);return x(S,{display:"flex",flexDirection:"column",gap:1,children:[x(S,{display:"flex",gap:1,children:[a(ie,{color:"error",onClick:()=>d(),startIcon:a(ol,{}),sx:{marginLeft:"auto"},children:t("characterEditor.delete")}),!!e&&a(Cn,{onClick:e,children:a(Sn,{})})]}),a(S,{children:x(W,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[a(W,{item:!0,xs:6,sm:4,md:4,lg:4,xl:4,children:x(se,{sx:{height:"100%",display:"flex",flexDirection:"column",gap:1},children:[a(Ll,{characterKey:c,charCardConfig:yr}),a(S,{sx:{px:1},children:a(sl,{level:o.level,milestone:o.promotion,setBoth:({level:h,milestone:b})=>s.chars.set(c,{level:h,promotion:b})})}),a(mr,{}),a(Nl,{mindscape:o.mindscape,setMindscape:h=>s.chars.set(c,{mindscape:h})})]})}),x(W,{item:!0,xs:6,sm:8,md:8,lg:8,xl:8,sx:{display:"flex",flexDirection:"column",gap:1},children:[a(S,{children:x(W,{container:!0,columns:3,spacing:1,children:[gi.map(h=>a(W,{item:!0,xs:1,children:a(rr,{skillKey:h},h)},h)),a(W,{item:!0,xs:1,children:a(Xl,{})},"core")]})}),a(S,{children:a(ar,{setWengine:h=>{h?s.wengines.set(h,{location:c}):r&&s.wengines.set(r,{location:""})},setDisc:(h,b)=>{b?s.discs.set(b,{location:c}):i[h]&&s.discs.set(i[h],{location:""})}})})]})]})})]})}function Lm({character:e,charOpt:t,wengineId:n,discIds:s,children:o}){const c=xr(e,n,s),i=_.useMemo(()=>Oi([...Vi([e.key]),...c,_t.common.critMode.add(t.critMode),N.common.lvl.add(t.enemyLvl),N.common.def.add(t.enemyDef),N.common.isStunned.add(t.enemyisStunned?1:0),N.common.stun_.add(t.enemyStunMultiplier/100),N.common.unstun_.add(1),...t.conditionals.flatMap(({sheet:d,src:h,dst:b,condKey:C,condValue:k})=>bt("preset0",Ci(d,h,b)(C,k))),...t.bonusStats.filter(({disabled:d})=>!d).flatMap(({tag:d,value:h})=>bt("preset0",{tag:{...d,src:e.key,sheet:"agg",et:"own"},value:Un(Jn(h,d.q??""))})),...t.enemyStats.flatMap(({tag:d,value:h})=>bt("preset0",{tag:{...d,qt:"common",et:"enemy",sheet:"agg"},value:Un(Jn(h,d.q??""))}))]),[c,t,e.key]),r=_.useMemo(()=>i&&new Map,[i]);return a(il.Provider,{value:r,children:a(In.Provider,{value:i,children:o})})}function xr(e,t,n){const s=wi(t),o=vi(n),c=_.useMemo(()=>ql(s),[s]),i=_.useMemo(()=>Al(Object.values(o).filter(cl)),[o]);return _.useMemo(()=>Bi(e.key,...Ei(e),...c,...i),[e,c,i])}function Hm({character:e,conditionals:t,children:n}){const s=_.useMemo(()=>Oi([...Vi([e.key]),...Bi(e.key,...Ei(e),...Pi({},ll(ri,()=>4)),E.sheet("agg").reread(E.sheet("wengine")),O.wengine.lvl.add(60),O.wengine.modification.add(5),O.wengine.phase.add(1),...li.map(o=>O.common.count.sheet(o).add(1))),_t.common.critMode.add("avg"),N.common.lvl.add(100),N.common.def.add(900),N.common.isStunned.add(0),N.common.stun_.add(1.5),N.common.unstun_.add(1),...t.flatMap(({sheet:o,src:c,dst:i,condKey:r,condValue:d})=>bt("preset0",Ci(o,c,i)(r,d)))]),[e,t]);return a(In.Provider,{value:s,children:n})}const zt="AstralVoice",[aa,_r]=u("disc",zt),oa=R(zt),wr=g[zt],vr=p[zt],kr={2:{title:a(z,{}),img:oa,documents:[{type:"text",text:aa("desc2")}]},4:{title:a(B,{}),img:oa,documents:[{type:"text",text:aa("desc4")},{type:"conditional",conditional:{label:_r("set4_cond"),metadata:wr.astral,fields:[l(vr.set4_team_dmg_.tag)]}}]}},Bt="BranchBladeSong",[sa,Dr]=u("disc",Bt),ia=R(Bt),Cr=g[Bt],ca=p[Bt],Sr={2:{title:a(z,{}),img:ia,documents:[{type:"text",text:sa("desc2")}]},4:{title:a(B,{}),img:ia,documents:[{type:"text",text:sa("desc4")},{type:"fields",fields:[l(ca.set4_passive.tag)]},{type:"conditional",conditional:{label:Dr("set4_cond"),metadata:Cr.apply_or_trigger,fields:[l(ca.set4_cond.tag)]}}]}},Et="ChaosJazz",[la,Mr]=u("disc",Et),ra=R(Et),Tr=g[Et],$t=p[Et],Ir={2:{title:a(z,{}),img:ra,documents:[{type:"text",text:la("desc2")}]},4:{title:a(B,{}),img:ra,documents:[{type:"text",text:la("desc4")},{type:"fields",fields:[l($t.set4_passive_fire_dmg_.tag),l($t.set4_passive_electric_dmg_.tag)]},{type:"conditional",conditional:{label:Mr("set4_cond"),metadata:Tr.while_off_field,fields:[{title:"EX Special Attack DMG",fieldRef:$t.set4_off_field_special_dmg_.tag},{title:"Assist Attack Attack DMG",fieldRef:$t.set4_off_field_assist_dmg_.tag}]}}]}},Pt="ChaoticMetal",[da,Rr]=u("disc",Pt),ua=R(Pt),zr=g[Pt],ha=p[Pt],Br={2:{title:a(z,{}),img:ua,documents:[{type:"text",text:da("desc2")}]},4:{title:a(B,{}),img:ua,documents:[{type:"text",text:da("desc4")},{type:"fields",fields:[l(ha.set4_passive.tag)]},{type:"conditional",conditional:{label:Rr("set4_cond"),metadata:zr.trigger_corruption,fields:[l(ha.set4_cond_trigger_corruption.tag)]}}]}},Vt="FangedMetal",[pa,Er]=u("disc",Vt),ga=R(Vt),Pr=g[Vt],Vr=p[Vt],Or={2:{title:a(z,{}),img:ga,documents:[{type:"text",text:pa("desc2")}]},4:{title:a(B,{}),img:ga,documents:[{type:"text",text:pa("desc4")},{type:"conditional",conditional:{label:Er("set4_cond"),metadata:Pr.inflict_assault,fields:[l(Vr.set4_cond_inflict_assault.tag)]}}]}},Ot="FreedomBlues",[ma,qr]=u("disc",Ot),fa=R(Ot),Ar=g[Ot],Fr=p[Ot],Wr={2:{title:a(z,{}),img:fa,documents:[{type:"text",text:ma("desc2")}]},4:{title:a(B,{}),img:fa,documents:[{type:"text",text:ma("desc4")},{type:"conditional",conditional:{label:qr("set4_cond"),metadata:Ar.exSpecialHit,fields:[l(Fr.anomBuildupRes_.tag)]}}]}},qt="HormonePunk",[$a,jr]=u("disc",qt),ya=R(qt),Lr=g[qt],Hr=p[qt],Kr={2:{title:a(z,{}),img:ya,documents:[{type:"text",text:$a("desc2")}]},4:{title:a(B,{}),img:ya,documents:[{type:"text",text:$a("desc4")},{type:"conditional",conditional:{label:jr("set4_cond"),metadata:Lr.entering_combat,fields:[l(Hr.set4_cond_entering_combat.tag)]}}]}},At="InfernoMetal",[ba,Nr]=u("disc",At),xa=R(At),Gr=g[At],Ur=p[At],Jr={2:{title:a(z,{}),img:xa,documents:[{type:"text",text:ba("desc2")}]},4:{title:a(B,{}),img:xa,documents:[{type:"text",text:ba("desc4")},{type:"conditional",conditional:{label:Nr("set4_cond"),metadata:Gr.hitting_burning_enemy,fields:[l(Ur.set4_cond_hitting_burning_enemy.tag)]}}]}},Ft="PhaethonsMelody",[_a,wa]=u("disc",Ft),va=R(Ft),ka=g[Ft],Da=p[Ft],Zr={2:{title:a(z,{}),img:va,documents:[{type:"text",text:_a("desc2")}]},4:{title:a(B,{}),img:va,documents:[{type:"text",text:_a("desc4")},{type:"conditional",conditional:{label:wa("set4_cond_squad_use_ex"),metadata:ka.squad_use_ex,fields:[l(Da.set4_squad_anomProf.tag)]}},{type:"conditional",conditional:{label:wa("set4_cond_not_char_use_ex"),metadata:ka.not_char_use_ex,fields:[l(Da.set4_not_self_ether_.tag)]}}]}},Wt="PolarMetal",[Ca,Qr]=u("disc",Wt),Sa=R(Wt),Xr=g[Wt],Ma=p[Wt],Yr={2:{title:a(z,{}),img:Sa,documents:[{type:"text",text:Ca("desc2")}]},4:{title:a(B,{}),img:Sa,documents:[{type:"text",text:Ca("desc4")},{type:"conditional",conditional:{label:Qr("set4_cond"),metadata:Xr.freeze_shatter}},{type:"fields",fields:[{title:"Basic Attack DMG",fieldRef:Ma.set4_basic_dmg_.tag},{title:"Dash Attack DMG",fieldRef:Ma.set4_dash_dmg_.tag}]}]}},jt="ProtoPunk",[Ta,ed]=u("disc",jt),Ia=R(jt),td=g[jt],nd=p[jt],ad={2:{title:a(z,{}),img:Ia,documents:[{type:"text",text:Ta("desc2")}]},4:{title:a(B,{}),img:Ia,documents:[{type:"text",text:Ta("desc4")},{type:"conditional",conditional:{label:ed("set4_cond"),metadata:td.def_assist_or_evasive_assist,fields:[l(nd.set4_cond_def_assist_or_evasive_assist_dmg_.tag)]}}]}},Lt="PufferElectro",[Ra,od]=u("disc",Lt),za=R(Lt),sd=g[Lt],Ba=p[Lt],id={2:{title:a(z,{}),img:za,documents:[{type:"text",text:Ra("desc2")}]},4:{title:a(B,{}),img:za,documents:[{type:"text",text:Ra("desc4")},{type:"fields",fields:[{title:"Ultimate DMG",fieldRef:Ba.set4_dmg_.tag}]},{type:"conditional",conditional:{label:od("set4_cond"),metadata:sd.launching_ult,fields:[l(Ba.set4_cond_launching_ult_atk_.tag)]}}]}},Ht="ShadowHarmony",[Ea,cd]=u("disc",Ht),Pa=R(Ht),ld=g[Ht],Va=p[Ht],rd={2:{title:a(z,{}),img:Pa,documents:[{type:"text",text:Ea("desc2")}]},4:{title:a(B,{}),img:Pa,documents:[{type:"text",text:Ea("desc4")},{type:"conditional",conditional:{label:cd("set4_cond_stacks"),metadata:ld.stacks,fields:[l(Va.set4_stack_atk_.tag),l(Va.set4_stack_crit_.tag)]}}]}},En="ShockstarDisco",[Oa,Km]=u("disc",En),qa=R(En),an=p[En],dd={2:{title:a(z,{}),img:qa,documents:[{type:"text",text:Oa("desc2")}]},4:{title:a(B,{}),img:qa,documents:[{type:"text",text:Oa("desc4")},{type:"fields",fields:[{title:"Basic Attack Daze",fieldRef:an.set4_basic_daze_.tag},{title:"Dash Attack Daze",fieldRef:an.set4_dash_daze_.tag},{title:"Dodge Counter Daze",fieldRef:an.set4_dodgeCounter_daze_.tag}]}]}},Fi="SoulRock",[Aa,Nm]=u("disc",Fi),Fa=R(Fi),ud={2:{title:a(z,{}),img:Fa,documents:[{type:"text",text:Aa("desc2")}]},4:{title:a(B,{}),img:Fa,documents:[{type:"text",text:Aa("desc4")}]}},Kt="SwingJazz",[Wa,hd]=u("disc",Kt),ja=R(Kt),pd=g[Kt],gd=p[Kt],md={2:{title:a(z,{}),img:ja,documents:[{type:"text",text:Wa("desc2")}]},4:{title:a(B,{}),img:ja,documents:[{type:"text",text:Wa("desc4")},{type:"conditional",conditional:{label:hd("set4_cond"),metadata:pd.chain_or_ult,fields:[l(gd.set4_cond_chain_or_ult.tag)]}}]}},Nt="ThunderMetal",[La,fd]=u("disc",Nt),Ha=R(Nt),$d=g[Nt],yd=p[Nt],bd={2:{title:a(z,{}),img:Ha,documents:[{type:"text",text:La("desc2")}]},4:{title:a(B,{}),img:Ha,documents:[{type:"text",text:La("desc4")},{type:"conditional",conditional:{label:fd("set4_cond"),metadata:$d.enemy_shocked,fields:[l(yd.set4_cond_enemy_shocked_atk_.tag)]}}]}},Gt="WoodpeckerElectro",[Ka,xd]=u("disc",Gt),Na=R(Gt),_d=g[Gt],wd=p[Gt],vd={2:{title:a(z,{}),img:Na,documents:[{type:"text",text:Ka("desc2")}]},4:{title:a(B,{}),img:Na,documents:[{type:"text",text:Ka("desc4")},{type:"conditional",conditional:{label:xd("set4_cond"),metadata:_d.crit_basic_dodge_ex,fields:[l(wd.set4_cond_crit_basic_dodge_ex_atk_.tag)]}}]}},kd={AstralVoice:kr,BranchBladeSong:Sr,ChaosJazz:Ir,ChaoticMetal:Br,FangedMetal:Or,FreedomBlues:Wr,HormonePunk:Kr,InfernoMetal:Jr,PhaethonsMelody:Zr,PolarMetal:Yr,ProtoPunk:ad,PufferElectro:id,ShadowHarmony:rd,ShockstarDisco:dd,SoulRock:ud,SwingJazz:md,ThunderMetal:bd,WoodpeckerElectro:vd};function z(){return"2-Set"}function B(){return"4-Set"}function f({wKey:e,children:t}){const n=Rt();let s=1;return n&&n.compute(O.common.count.sheet(e)).val&&(s=n.compute(O.wengine.phase).val??1),t(s)}const ce="BashfulDemon",[Ga,Dd]=u("wengine",ce),Cd=w.wengine[ce],Sd=$(ce,"icon"),Md=g[ce],Ua=p[ce],Td={title:Ga("phase"),img:Sd,documents:[{type:"text",text:a(f,{wKey:ce,children:e=>Ga(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(Ua.passive_ice_dmg_.tag)]},{type:"conditional",conditional:{label:Dd("cond"),metadata:Md.launch_ex_attack,fields:[l(Ua.team_atk_.tag),{title:"Duration",fieldValue:Cd.duration}]}}]},le="BigCylinder",[Ja,Gm]=u("wengine",le),Id=w.wengine[le],Rd=$(le,"icon"),zd=p[le],Bd=Si[le],Ed={title:Ja("phase"),img:Rd,documents:[{type:"text",text:a(f,{wKey:le,children:e=>Ja(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(zd.passive_dmg_red_.tag)]},{type:"fields",fields:[{title:"Additional DMG",fieldRef:Bd.damage.tag},{title:"Cooldown",fieldValue:Id.cooldown}]}]},re="BlazingLaurel",[Za,Qa]=u("wengine",re),Xa=w.wengine[re],Pd=$(re,"icon"),Ya=g[re],on=p[re],Vd={title:Za("phase"),img:Pd,documents:[{type:"text",text:a(f,{wKey:re,children:e=>Za(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Qa("cond1"),metadata:Ya.quickOrPerfectAssistUsed,fields:[l(on.impact_.tag),{title:"Duration",fieldValue:Xa.duration}]}},{type:"conditional",conditional:{label:Qa("cond2"),metadata:Ya.wilt,fields:[l(on.crit_dmg_ice_.tag),l(on.crit_dmg_fire_.tag),{title:"Duration",fieldValue:Xa.wilt_duration}]}}]},de="BoxCutter",[eo,Od]=u("wengine",de),qd=w.wengine[de],Ad=$(de,"icon"),Fd=g[de],to=p[de],Wd={title:eo("phase"),img:Ad,documents:[{type:"text",text:a(f,{wKey:de,children:e=>eo(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Od("cond"),metadata:Fd.launchedAftershock,fields:[l(to.physical_dmg_.tag),l(to.daze_.tag),{title:"Duration",fieldValue:qd.duration}]}}]},ct="BunnyBand",[no,jd]=u("wengine",ct),Ld=$(ct,"icon"),Hd=g[ct],ao=p[ct],Kd={title:no("phase"),img:Ld,documents:[{type:"text",text:a(f,{wKey:ct,children:e=>no(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(ao.passive_hp_.tag)]},{type:"conditional",conditional:{label:jd("cond"),metadata:Hd.wearerShielded,fields:[l(ao.atk_.tag)]}}]},te="CannonRotor",[oo,Um]=u("wengine",te),Nd=w.wengine[te],Gd=$(te,"icon"),Ud=Si[te],Jd=p[te],Zd={title:oo("phase"),img:Gd,documents:[{type:"text",text:a(f,{wKey:te,children:e=>oo(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(Jd.passive_atk_.tag)]},{type:"fields",fields:[{title:"Additional DMG",fieldRef:Ud.damage.tag},{title:"Cooldown",fieldValue:a(f,{wKey:te,children:e=>Nd.cooldown[e]})}]}]},ue="DeepSeaVisitor",[so,io]=u("wengine",ue),co=w.wengine[ue],Qd=$(ue,"icon"),lo=g[ue],sn=p[ue],Xd={title:so("phase"),img:Qd,documents:[{type:"text",text:a(f,{wKey:ue,children:e=>so(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(sn.passive_ice_dmg_.tag)]},{type:"conditional",conditional:{label:io("cond1"),metadata:lo.basicHit,fields:[l(sn.crit_.tag),{title:"Duration",fieldValue:co.duration}]}},{type:"conditional",conditional:{label:io("cond2"),metadata:lo.iceDashAtkHit,fields:[l(sn.extra_crit_.tag),{title:"Duration",fieldValue:co.extra_duration}]}}]},he="DemaraBatteryMarkII",[ro,Yd]=u("wengine",he),eu=w.wengine[he],tu=$(he,"icon"),nu=g[he],uo=p[he],au={title:ro("phase"),img:tu,documents:[{type:"text",text:a(f,{wKey:he,children:e=>ro(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(uo.passive_electric_dmg_.tag)]},{type:"conditional",conditional:{label:Yd("cond"),metadata:nu.dodgeCounterOrAssistHit,fields:[l(uo.enerRegen_.tag),{title:"Duration",fieldValue:eu.duration}]}}]},pe="DrillRigRedAxis",[ho,ou]=u("wengine",pe),po=w.wengine[pe],su=$(pe,"icon"),iu=g[pe],go=p[pe],cu={title:ho("phase"),img:su,documents:[{type:"text",text:a(f,{wKey:pe,children:e=>ho(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ou("cond"),metadata:iu.exSpecialOrChainUsed,fields:[l(go.basic_eletric_dmg_.tag),l(go.dash_eletric_dmg_.tag),{title:"Duration",fieldValue:po.duration},{title:"Cooldown",fieldValue:po.cooldown}]}}]},lt="ElectroLipGloss",[mo,lu]=u("wengine",lt),ru=$(lt,"icon"),du=g[lt],fo=p[lt],uu={title:mo("phase"),img:ru,documents:[{type:"text",text:a(f,{wKey:lt,children:e=>mo(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:lu("cond"),metadata:du.anomalyOnEnemy,fields:[l(fo.atk_.tag),l(fo.common_dmg_.tag)]}}]},ge="ElegantVanity",[$o,hu]=u("wengine",ge),pu=w.wengine[ge],gu=$(ge,"icon"),mu=g[ge],fu=p[ge],$u={title:$o("phase"),img:gu,documents:[{type:"text",text:a(f,{wKey:ge,children:e=>$o(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:hu("cond"),metadata:mu.consumed25Energy,fields:[l(fu.common_dmg_.tag),{title:"Duration",fieldValue:pu.buffDuration}]}}]},me="FlamemakerShaker",[yo,bo]=u("wengine",me),cn=w.wengine[me],yu=$(me,"icon"),xo=g[me],ln=p[me],bu={title:yo("phase"),img:yu,documents:[{type:"text",text:a(f,{wKey:me,children:e=>yo(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:bo("cond1"),metadata:xo.offField,fields:[l(ln.enerRegen.tag)]}},{type:"conditional",conditional:{label:bo("cond2"),metadata:xo.exSpecialAssistHits,fields:[l(ln.common_dmg_.tag),{title:"Duration",fieldValue:cn.duration},{title:"Cooldown",fieldValue:cn.cooldown},l(ln.anomProf.tag),{title:"Duration",fieldValue:cn.anomProfDuration}]}}]},fe="FlightOfFancy",[_o,xu]=u("wengine",fe),wo=w.wengine[fe],_u=$(fe,"icon"),wu=g[fe],vo=p[fe],vu={title:_o("phase"),img:_u,documents:[{type:"text",text:a(f,{wKey:fe,children:e=>_o(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(vo.anomBuildup_.tag)]},{type:"conditional",conditional:{label:xu("cond"),metadata:wu.etherDmg,fields:[l(vo.etherDmg_anomProf.tag),{title:"Duration",fieldValue:wo.duration},{title:"Cooldown",fieldValue:wo.cd}]}}]},$e="FusionCompiler",[ko,ku]=u("wengine",$e),Du=w.wengine[$e],Cu=$($e,"icon"),Su=g[$e],Do=p[$e],Mu={title:ko("phase"),img:Cu,documents:[{type:"text",text:a(f,{wKey:$e,children:e=>ko(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(Do.passive_atk_.tag)]},{type:"conditional",conditional:{label:ku("cond"),metadata:Su.specialUsed,fields:[l(Do.anomProf.tag),{title:"Duration",fieldValue:Du.duration}]}}]},Ut="GildedBlossom",[Co,Jm]=u("wengine",Ut),Tu=$(Ut,"icon"),So=p[Ut],Iu={title:Co("phase"),img:Tu,documents:[{type:"text",text:a(f,{wKey:Ut,children:e=>Co(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(So.passive_atk_.tag),l(So.passive_exSpecial_dmg_.tag)]}]},ye="HailstormShrine",[Mo,Ru]=u("wengine",ye),zu=w.wengine[ye],Bu=$(ye,"icon"),Eu=g[ye],To=p[ye],Pu={title:Mo("phase"),img:Bu,documents:[{type:"text",text:a(f,{wKey:ye,children:e=>Mo(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(To.passive_crit_dmg_.tag)]},{type:"conditional",conditional:{label:Ru("cond"),metadata:Eu.exSpecialOrAnomaly,fields:[l(To.ice_dmg_.tag),{title:"Duration",fieldValue:zu.duration}]}}]},be="HeartstringNocturne",[Io,Vu]=u("wengine",be),Ou=w.wengine[be],qu=$(be,"icon"),Au=g[be],rn=p[be],Fu={title:Io("phase"),img:qu,documents:[{type:"text",text:a(f,{wKey:be,children:e=>Io(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(rn.passive_crit_dmg_.tag)]},{type:"conditional",conditional:{label:Vu("cond"),metadata:Au.heartstring,fields:[l(rn.chain_resIgn_fire_.tag),l(rn.ult_resIgn_fire_.tag),{title:"Duration",fieldValue:Ou.duration}]}}]},xe="HellfireGears",[Ro,zo]=u("wengine",xe),Wu=w.wengine[xe],ju=$(xe,"icon"),Bo=g[xe],Eo=p[xe],Lu={title:Ro("phase"),img:ju,documents:[{type:"text",text:a(f,{wKey:xe,children:e=>Ro(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:zo("cond1"),metadata:Bo.offField,fields:[l(Eo.enerRegen.tag)]}},{type:"conditional",conditional:{label:zo("cond1"),metadata:Bo.exSpecialUsed,fields:[l(Eo.impact_.tag),{title:"Duration",fieldValue:Wu.duration}]}}]},_e="Housekeeper",[Po,Vo]=u("wengine",_e),Hu=w.wengine[_e],Ku=$(_e,"icon"),Oo=g[_e],qo=p[_e],Nu={title:Po("phase"),img:Ku,documents:[{type:"text",text:a(f,{wKey:_e,children:e=>Po(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Vo("cond1"),metadata:Oo.offField,fields:[l(qo.enerRegen.tag)]}},{type:"conditional",conditional:{label:Vo("cond2"),metadata:Oo.exSpecialHits,fields:[l(qo.physical_dmg_.tag),{title:"Duration",fieldValue:Hu.duration}]}}]},we="IceJadeTeapot",[Ao,Gu]=u("wengine",we),Fo=w.wengine[we],Uu=$(we,"icon"),Ju=g[we],Wo=p[we],Zu={title:Ao("phase"),img:Uu,documents:[{type:"text",text:a(f,{wKey:we,children:e=>Ao(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Gu("cond"),metadata:Ju.teariffic,fields:[l(Wo.impact_.tag),{title:"Duration",fieldValue:Fo.duration},l(Wo.common_dmg_.tag),{title:"Duration",fieldValue:Fo.teamBuffDuration}]}}]},ve="IdentityBase",[jo,Qu]=u("wengine",ve),Xu=w.wengine[ve],Yu=$(ve,"icon"),eh=g[ve],th=p[ve],nh={title:jo("phase"),img:Yu,documents:[{type:"text",text:a(f,{wKey:ve,children:e=>jo(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Qu("cond"),metadata:eh.equipperAttacked,fields:[l(th.def_.tag),{title:"Duration",fieldValue:Xu.duration}]}}]},Pn="IdentityInflection",[Lo,Zm]=u("wengine",Pn),ah=$(Pn,"icon"),oh={title:Lo("phase"),img:ah,documents:[{type:"text",text:a(f,{wKey:Pn,children:e=>Lo(`phaseDescs.${e-1}`)})}]},ke="KaboomTheCannon",[Ho,sh]=u("wengine",ke),ih=w.wengine[ke],ch=$(ke,"icon"),lh=g[ke],rh=p[ke],dh={title:Ho("phase"),img:ch,documents:[{type:"text",text:a(f,{wKey:ke,children:e=>Ho(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:sh("cond"),metadata:lh.allyHitsEnemy,fields:[l(rh.atk_.tag),{title:"Duration",fieldValue:ih.duration}]}}]},De="LunarDecrescent",[Ko,uh]=u("wengine",De),hh=w.wengine[De],ph=$(De,"icon"),gh=g[De],mh=p[De],fh={title:Ko("phase"),img:ph,documents:[{type:"text",text:a(f,{wKey:De,children:e=>Ko(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:uh("cond"),metadata:gh.chainOrUltUsed,fields:[l(mh.common_dmg_.tag),{title:"Duration",fieldValue:hh.duration}]}}]},Vn="LunarNoviluna",[No,Qm]=u("wengine",Vn),$h=$(Vn,"icon"),yh={title:No("phase"),img:$h,documents:[{type:"text",text:a(f,{wKey:Vn,children:e=>No(`phaseDescs.${e-1}`)})}]},Jt="LunarPleniluna",[Go,Xm]=u("wengine",Jt),bh=$(Jt,"icon"),dn=p[Jt],xh={title:Go("phase"),img:bh,documents:[{type:"text",text:a(f,{wKey:Jt,children:e=>Go(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(dn.basic_dmg_.tag),l(dn.dash_dmg_.tag),l(dn.dodgeCounter_dmg_.tag)]}]},Ce="MagneticStormAlpha",[Uo,_h]=u("wengine",Ce),Jo=w.wengine[Ce],wh=$(Ce,"icon"),vh=g[Ce],kh=p[Ce],Dh={title:Uo("phase"),img:wh,documents:[{type:"text",text:a(f,{wKey:Ce,children:e=>Uo(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:_h("cond"),metadata:vh.anomalyBuildupIncreased,fields:[l(kh.anomMas.tag),{title:"Duration",fieldValue:Jo.duration},{title:"Cooldown",fieldValue:Jo.cooldown}]}}]},Se="MagneticStormBravo",[Zo,Ch]=u("wengine",Se),Qo=w.wengine[Se],Sh=$(Se,"icon"),Mh=g[Se],Th=p[Se],Ih={title:Zo("phase"),img:Sh,documents:[{type:"text",text:a(f,{wKey:Se,children:e=>Zo(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Ch("cond"),metadata:Mh.anomalyBuildupIncreased,fields:[l(Th.anomProf.tag),{title:"Duration",fieldValue:Qo.duration},{title:"Cooldown",fieldValue:Qo.cooldown}]}}]},On="MagneticStormCharlie",[Xo,Ym]=u("wengine",On),Rh=$(On,"icon"),zh={title:Xo("phase"),img:Rh,documents:[{type:"text",text:a(f,{wKey:On,children:e=>Xo(`phaseDescs.${e-1}`)})}]},Me="MarcatoDesire",[Yo,es]=u("wengine",Me),Bh=w.wengine[Me],Eh=$(Me,"icon"),ts=g[Me],Ph=p[Me],Vh={title:Yo("phase"),img:Eh,documents:[{type:"text",text:a(f,{wKey:Me,children:e=>Yo(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:es("cond1"),metadata:ts.exSpecialOrChainHitsEnemy,fields:[l(Ph.atk_.tag),{title:"Duration",fieldValue:Bh.duration}]}},{type:"conditional",conditional:{label:es("cond2"),metadata:ts.attributeAnomalyInflicted}}]},Te="MyriadEclipse",[ns,Oh]=u("wengine",Te),qh=w.wengine[Te],Ah=$(Te,"icon"),Fh=g[Te],as=p[Te],Wh={title:ns("phase"),img:Ah,documents:[{type:"text",text:a(f,{wKey:Te,children:e=>ns(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(as.crit_dmg_.tag)]},{type:"conditional",conditional:{label:Oh("cond"),metadata:Fh.deathSentence,fields:[l(as.deathSentence_defIgn_.tag),{title:"Duration",fieldValue:qh.duration}]}}]},Ie="OriginalTransmorpher",[os,jh]=u("wengine",Ie),Lh=w.wengine[Ie],Hh=$(Ie,"icon"),Kh=g[Ie],ss=p[Ie],Nh={title:os("phase"),img:Hh,documents:[{type:"text",text:a(f,{wKey:Ie,children:e=>os(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(ss.passive_hp_.tag)]},{type:"conditional",conditional:{label:jh("cond"),metadata:Kh.equipperHit,fields:[l(ss.impact_.tag),{title:"Duration",fieldValue:Lh.duration}]}}]},rt="PeacekeeperSpecialized",[is,Gh]=u("wengine",rt),Uh=$(rt,"icon"),Jh=g[rt],un=p[rt],Zh={title:is("phase"),img:Uh,documents:[{type:"text",text:a(f,{wKey:rt,children:e=>is(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Gh("cond"),metadata:Jh.shielded,fields:[l(un.enerRegen.tag)]}},{type:"fields",fields:[l(un.passive_exSpecial_anomBuildup_.tag),l(un.passive_assist_anomBuildup_.tag)]}]},dt="PreciousFossilizedCore",[cs,ls]=u("wengine",dt),Qh=$(dt,"icon"),rs=g[dt],Xh=p[dt],Yh={title:cs("phase"),img:Qh,documents:[{type:"text",text:a(f,{wKey:dt,children:e=>cs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ls("cond1"),metadata:rs.enemyHpGE50,fields:[l(Xh.daze_.tag)]}},{type:"conditional",conditional:{label:ls("cond2"),metadata:rs.enemyHpGE75}}]},Re="RainforestGourmet",[ds,ep]=u("wengine",Re),tp=w.wengine[Re],np=$(Re,"icon"),ap=g[Re],op=p[Re],sp={title:ds("phase"),img:np,documents:[{type:"text",text:a(f,{wKey:Re,children:e=>ds(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ep("cond"),metadata:ap.energyConsumed,fields:[l(op.atk_.tag),{title:"Duration",fieldValue:tp.duration}]}}]},ze="ReverbMarkI",[us,ip]=u("wengine",ze),cp=w.wengine[ze],lp=$(ze,"icon"),rp=g[ze],dp=p[ze],up={title:us("phase"),img:lp,documents:[{type:"text",text:a(f,{wKey:ze,children:e=>us(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ip("cond"),metadata:rp.exSpecialUsed,fields:[l(dp.impact_.tag),{title:"Duration",fieldValue:cp.duration}]}}]},Be="ReverbMarkII",[hs,hp]=u("wengine",Be),pp=w.wengine[Be],gp=$(Be,"icon"),mp=g[Be],ps=p[Be],fp={title:hs("phase"),img:gp,documents:[{type:"text",text:a(f,{wKey:Be,children:e=>hs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:hp("cond"),metadata:mp.exSpecialOrChainUsed,fields:[l(ps.anomMas.tag),l(ps.anomProf.tag),{title:"Duration",fieldValue:pp.duration}]}}]},Ee="ReverbMarkIII",[gs,$p]=u("wengine",Ee),yp=w.wengine[Ee],bp=$(Ee,"icon"),xp=g[Ee],_p=p[Ee],wp={title:gs("phase"),img:bp,documents:[{type:"text",text:a(f,{wKey:Ee,children:e=>gs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:$p("cond"),metadata:xp.chainOrUltUsed,fields:[l(_p.atk_.tag),{title:"Duration",fieldValue:yp.duration}]}}]},ut="RiotSuppressorMarkVI",[ms,vp]=u("wengine",ut),kp=$(ut,"icon"),Dp=g[ut],fs=p[ut],Cp={title:ms("phase"),img:kp,documents:[{type:"text",text:a(f,{wKey:ut,children:e=>ms(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(fs.passive_crit_.tag)]},{type:"conditional",conditional:{label:vp("cond"),metadata:Dp.charge,fields:[l(fs.basic_ether_dmg_.tag)]}}]},Pe="RoaringRide",[$s,hn]=u("wengine",Pe),pn=w.wengine[Pe],Sp=$(Pe,"icon"),gn=g[Pe],mn=p[Pe],Mp={title:$s("phase"),img:Sp,documents:[{type:"text",text:a(f,{wKey:Pe,children:e=>$s(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:hn("cond_atk_"),metadata:gn.atk_,fields:[l(mn.atk_.tag),{title:"Duration",fieldValue:pn.duration}]}},{type:"conditional",conditional:{label:hn("cond_anomProf"),metadata:gn.anomProf,fields:[l(mn.anomProf.tag),{title:"Duration",fieldValue:pn.duration}]}},{type:"conditional",conditional:{label:hn("cond_anomBuildup_"),metadata:gn.anomBuildup_,fields:[l(mn.anomBuildup_.tag),{title:"Duration",fieldValue:pn.duration}]}}]},Ve="SeveredInnocence",[ys,Tp]=u("wengine",Ve),Ip=w.wengine[Ve],Rp=$(Ve,"icon"),zp=g[Ve],fn=p[Ve],Bp={title:ys("phase"),img:Rp,documents:[{type:"text",text:a(f,{wKey:Ve,children:e=>ys(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(fn.passive_crit_dmg_.tag)]},{type:"conditional",conditional:{label:Tp("cond"),metadata:zp.basicSpecialAftershockHit,fields:[l(fn.crit_dmg_.tag),l(fn.electric_dmg_.tag),{title:"Duration",fieldValue:Ip.duration}]}}]},Oe="SharpenedStinger",[bs,Ep]=u("wengine",Oe),Pp=w.wengine[Oe],Vp=$(Oe,"icon"),Op=g[Oe],xs=p[Oe],qp={title:bs("phase"),img:Vp,documents:[{type:"text",text:a(f,{wKey:Oe,children:e=>bs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Ep("cond"),metadata:Op.predatoryInstinct,fields:[l(xs.physical_dmg_.tag),{title:"Duration",fieldValue:Pp.duration}]}},{type:"fields",fields:[l(xs.anomBuildup_.tag)]}]},ht="SixShooter",[_s,Ap]=u("wengine",ht),Fp=$(ht,"icon"),Wp=g[ht],jp=p[ht],Lp={title:_s("phase"),img:Fp,documents:[{type:"text",text:a(f,{wKey:ht,children:e=>_s(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Ap("cond"),metadata:Wp.charge,fields:[l(jp.exSpecial_daze_.tag)]}}]},qn="SliceOfTime",[ws,ef]=u("wengine",qn),Hp=$(qn,"icon"),Kp={title:ws("phase"),img:Hp,documents:[{type:"text",text:a(f,{wKey:qn,children:e=>ws(`phaseDescs.${e-1}`)})}]},qe="SpectralGaze",[vs,ks]=u("wengine",qe),Ds=w.wengine[qe],Np=$(qe,"icon"),Cs=g[qe],Ss=p[qe],Gp={title:vs("phase"),img:Np,documents:[{type:"text",text:a(f,{wKey:qe,children:e=>vs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ks("cond1"),metadata:Cs.hit_aftershock_electric,fields:[l(Ss.cond_defRed_.tag),{title:"Duration",fieldValue:Ds.duration1}]}},{type:"conditional",conditional:{label:ks("cond2"),metadata:Cs.spiritLock,fields:[l(Ss.cond_impact_.tag),{title:"Duration",fieldValue:Ds.duration2}]}}]},Ae="SpringEmbrace",[Ms,Up]=u("wengine",Ae),Jp=w.wengine[Ae],Zp=$(Ae,"icon"),Qp=g[Ae],Ts=p[Ae],Xp={title:Ms("phase"),img:Zp,documents:[{type:"text",text:a(f,{wKey:Ae,children:e=>Ms(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(Ts.passive_dmg_red_.tag)]},{type:"conditional",conditional:{label:Up("cond"),metadata:Qp.when_attacked,fields:[l(Ts.cond_enerRegen_.tag),{title:"Duration",fieldValue:Jp.duration}]}}]},Fe="StarlightEngine",[Is,Yp]=u("wengine",Fe),eg=w.wengine[Fe],tg=$(Fe,"icon"),ng=g[Fe],ag=p[Fe],og={title:Is("phase"),img:tg,documents:[{type:"text",text:a(f,{wKey:Fe,children:e=>Is(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Yp("cond"),metadata:ng.dodgecounter_quickassist,fields:[l(ag.cond_dmg_.tag),{title:"Duration",fieldValue:eg.duration}]}}]},We="StarlightEngineReplica",[Rs,sg]=u("wengine",We),ig=w.wengine[We],cg=$(We,"icon"),lg=g[We],rg=p[We],dg={title:Rs("phase"),img:cg,documents:[{type:"text",text:a(f,{wKey:We,children:e=>Rs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:sg("cond"),metadata:lg.hit_away,fields:[l(rg.cond_dmg_.tag),{title:"Duration",fieldValue:ig.duration}]}}]},je="SteamOven",[zs,ug]=u("wengine",je),hg=w.wengine[je],pg=$(je,"icon"),gg=g[je],mg=p[je],fg={title:zs("phase"),img:pg,documents:[{type:"text",text:a(f,{wKey:je,children:e=>zs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ug("cond"),metadata:gg.stacks,fields:[l(mg.cond_impact_.tag),{title:"Duration",fieldValue:hg.duration}]}}]},pt="SteelCushion",[Bs,$g]=u("wengine",pt),yg=$(pt,"icon"),bg=g[pt],Es=p[pt],xg={title:Bs("phase"),img:yg,documents:[{type:"text",text:a(f,{wKey:pt,children:e=>Bs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(Es.passive_physical_dmg_.tag)]},{type:"conditional",conditional:{label:$g("cond"),metadata:bg.hit_behind,fields:[l(Es.cond_dmg_.tag)]}}]},gt="StreetSuperstar",[Ps,_g]=u("wengine",gt),wg=$(gt,"icon"),vg=g[gt],kg=p[gt],Dg={title:Ps("phase"),img:wg,documents:[{type:"text",text:a(f,{wKey:gt,children:e=>Ps(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:_g("cond"),metadata:vg.charge,fields:[l(kg.cond_ult_dmg_.tag)]}}]},Le="TheBrimstone",[Vs,Cg]=u("wengine",Le),Sg=w.wengine[Le],Mg=$(Le,"icon"),Tg=g[Le],Ig=p[Le],Rg={title:Vs("phase"),img:Mg,documents:[{type:"text",text:a(f,{wKey:Le,children:e=>Vs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Cg("cond"),metadata:Tg.hit_basic_dash_dodge,fields:[l(Ig.cond_atk_.tag),{title:"Duration",fieldValue:Sg.duration}]}}]},He="TheRestrained",[Os,zg]=u("wengine",He),Bg=w.wengine[He],Eg=$(He,"icon"),Pg=g[He],qs=p[He],Vg={title:Os("phase"),img:Eg,documents:[{type:"text",text:a(f,{wKey:He,children:e=>Os(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:zg("cond"),metadata:Pg.dmg_daze_,fields:[l(qs.basic_dmg_.tag),l(qs.basic_daze_.tag),{title:"Duration",fieldValue:Bg.duration}]}}]},Ke="TheVault",[As,Og]=u("wengine",Ke),qg=w.wengine[Ke],Ag=$(Ke,"icon"),Fg=g[Ke],Wg=p[Ke],jg={title:As("phase"),img:Ag,documents:[{type:"text",text:a(f,{wKey:Ke,children:e=>As(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Og("cond"),metadata:Fg.ether_hit,fields:[l(Wg.cond_dmg_.tag),{title:"Duration",fieldValue:qg.duration}]}}]},Ne="Timeweaver",[Fs,Lg]=u("wengine",Ne),Hg=w.wengine[Ne],Kg=$(Ne,"icon"),Ng=g[Ne],$n=p[Ne],Gg={title:Fs("phase"),img:Kg,documents:[{type:"text",text:a(f,{wKey:Ne,children:e=>Fs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l($n.passive_electric_anomBuildup_.tag),l($n.passive_disorder_dmg_.tag)]},{type:"conditional",conditional:{label:Lg("cond"),metadata:Ng.hit_anomaly,fields:[l($n.cond_anomProf.tag),{title:"Duration",fieldValue:Hg.duration}]}}]},Ge="TusksOfFury",[Ws,Ug]=u("wengine",Ge),Jg=w.wengine[Ge],Zg=$(Ge,"icon"),Qg=g[Ge],yn=p[Ge],Xg={title:Ws("phase"),img:Zg,documents:[{type:"text",text:a(f,{wKey:Ge,children:e=>Ws(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(yn.passive_shield_.tag)]},{type:"conditional",conditional:{label:Ug("cond"),metadata:Qg.interrupt_perfdodge,fields:[l(yn.cond_dmg_.tag),l(yn.daze_.tag),{title:"Duration",fieldValue:Jg.duration}]}}]},Ue="UnfetteredGameBall",[js,Yg]=u("wengine",Ue),em=w.wengine[Ue],tm=$(Ue,"icon"),nm=g[Ue],am=p[Ue],om={title:js("phase"),img:tm,documents:[{type:"text",text:a(f,{wKey:Ue,children:e=>js(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Yg("cond"),metadata:nm.anomaly_counter,fields:[l(am.cond_crit_.tag),{title:"Duration",fieldValue:em.duration}]}}]},Zt="VortexArrow",[Ls,tf]=u("wengine",Zt),sm=$(Zt,"icon"),im=p[Zt],cm={title:Ls("phase"),img:sm,documents:[{type:"text",text:a(f,{wKey:Zt,children:e=>Ls(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(im.passive_daze_.tag)]}]},Je="VortexHatchet",[Hs,lm]=u("wengine",Je),Ks=w.wengine[Je],rm=$(Je,"icon"),dm=g[Je],um=p[Je],hm={title:Hs("phase"),img:rm,documents:[{type:"text",text:a(f,{wKey:Je,children:e=>Hs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:lm("cond"),metadata:dm.entering,fields:[l(um.cond_impact_.tag),{title:"Duration",fieldValue:Ks.duration},{title:"Cooldown",fieldValue:Ks.cooldown}]}}]},Qt="VortexRevolver",[Ns,nf]=u("wengine",Qt),pm=$(Qt,"icon"),gm=p[Qt],mm={title:Ns("phase"),img:pm,documents:[{type:"text",text:a(f,{wKey:Qt,children:e=>Ns(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(gm.passive_exSpecial_daze_.tag)]}]},Ze="WeepingCradle",[Gs,Us]=u("wengine",Ze),fm=w.wengine[Ze],$m=$(Ze,"icon"),Js=g[Ze],ym=p[Ze],bm={title:Gs("phase"),img:$m,documents:[{type:"text",text:a(f,{wKey:Ze,children:e=>Gs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Us("cond_atk"),metadata:Js.attack}},{type:"conditional",conditional:{label:Us("cond_stacks"),metadata:Js.stacks,fields:[l(ym.cond_dmg_.tag),{title:"Duration",fieldValue:fm.duration}]}}]},mt="WeepingGemini",[Zs,xm]=u("wengine",mt),_m=$(mt,"icon"),wm=g[mt],vm=p[mt],km={title:Zs("phase"),img:_m,documents:[{type:"text",text:a(f,{wKey:mt,children:e=>Zs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:xm("cond"),metadata:wm.anomaly_stack,fields:[l(vm.anomProf.tag)]}}]},Qe="ZanshinHerbCase",[Qs,Dm]=u("wengine",Qe),Cm=w.wengine[Qe],Sm=$(Qe,"icon"),Mm=g[Qe],bn=p[Qe],Tm={title:Qs("phase"),img:Sm,documents:[{type:"text",text:a(f,{wKey:Qe,children:e=>Qs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[l(bn.passive_crit_.tag),l(bn.passive_electric_dmg_.tag)]},{type:"conditional",conditional:{label:Dm("cond"),metadata:Mm.apply_anom_stun,fields:[l(bn.cond_crit_.tag),{title:"Duration",fieldValue:Cm.duration}]}}]},Im={BashfulDemon:Td,BigCylinder:Ed,BlazingLaurel:Vd,BoxCutter:Wd,BunnyBand:Kd,CannonRotor:Zd,DeepSeaVisitor:Xd,DemaraBatteryMarkII:au,DrillRigRedAxis:cu,ElectroLipGloss:uu,ElegantVanity:$u,FlamemakerShaker:bu,FlightOfFancy:vu,FusionCompiler:Mu,GildedBlossom:Iu,HailstormShrine:Pu,HeartstringNocturne:Fu,HellfireGears:Lu,Housekeeper:Nu,IceJadeTeapot:Zu,IdentityBase:nh,IdentityInflection:oh,KaboomTheCannon:dh,LunarDecrescent:fh,LunarNoviluna:yh,LunarPleniluna:xh,MagneticStormAlpha:Dh,MagneticStormBravo:Ih,MagneticStormCharlie:zh,MarcatoDesire:Vh,MyriadEclipse:Wh,OriginalTransmorpher:Nh,PeacekeeperSpecialized:Zh,PreciousFossilizedCore:Yh,RainforestGourmet:sp,ReverbMarkI:up,ReverbMarkII:fp,ReverbMarkIII:wp,RiotSuppressorMarkVI:Cp,RoaringRide:Mp,SeveredInnocence:Bp,SharpenedStinger:qp,SixShooter:Lp,SliceOfTime:Kp,SpectralGaze:Gp,SpringEmbrace:Xp,StarlightEngine:og,StarlightEngineReplica:dg,SteamOven:fg,SteelCushion:xg,StreetSuperstar:Dg,TheBrimstone:Rg,TheRestrained:Vg,TheVault:jg,Timeweaver:Gg,TusksOfFury:Xg,UnfetteredGameBall:om,VortexArrow:cm,VortexHatchet:hm,VortexRevolver:mm,WeepingCradle:bm,WeepingGemini:km,ZanshinHerbCase:Tm};function Rm(e){const{attribute:t}=e;if(t)return t}function zm(e){const{q:t}=e;return["standardDmg","anomalyDmg"].includes(t)}function Bm(e){const{damageType1:t,damageType2:n}=e,s=[];return zm(e)?(t&&s.push(t),n&&s.push(n),s):[]}const Ct={basic:"Basic",dash:"Dash",dodgeCounter:"Dodge Counter",special:"Special",exSpecial:"EX Special",chain:"Chain",ult:"Ultimate",quickAssist:"Quick Assist",defensiveAssist:"Defensive Assist",evasiveAssist:"Evasive Assist",assistFollowUp:"Assist Follow Up",anomaly:"Anomaly",disorder:"Disorder",aftershock:"Aftershock",elemental:"Elemental"},Wi=["crit_","crit_dmg_","impact","pen","pen_","enerRegen","anomProf","anomMas"].map(e=>{if(rl.includes(e)){const t={...O.final.dmg_.tag,attribute:e.slice(0,-5)};return{title:a(yt,{statKey:e}),fieldRef:t}}return e==="crit_"?{fieldRef:O.common.cappedCrit_.tag,title:a(yt,{statKey:e})}:{fieldRef:O.final[e].tag,title:a(yt,{statKey:e})}});Wi.push(...Ye.map(e=>({fieldRef:{et:"own",qt:"formula",q:"standardDmg",attribute:e,name:"standardDmgInst"},title:x(et,{color:e,children:[oe[e]," Damage"]})})),...Ye.flatMap(e=>dl.map(t=>({fieldRef:{et:"own",qt:"formula",q:"standardDmg",attribute:e,damageType1:t,name:"standardDmgInst"},title:x(et,{color:e,children:[oe[e]," ",Ct[t]," Damage"]})}))),...Ye.map(e=>({fieldRef:{et:"own",qt:"formula",q:"anomalyDmg",attribute:e,damageType1:"anomaly",name:"anomalyDmgInst"},title:x(et,{color:e,children:[oe[e]," Anomaly Damage"]})})),...Ye.map(e=>({fieldRef:{et:"own",qt:"formula",q:"anomBuildup",attribute:e,name:"anomalyBuildupInst"},title:x(et,{color:e,children:[oe[e]," Anomaly Buildup"]})})),{fieldRef:{et:"own",qt:"formula",q:"dazeBuildup",name:"dazeInst"},title:"Daze Buildup"});const ji=[];Wi.forEach(e=>{ji.push({tag:e.fieldRef,value:e})});const Em=Fl(ji),wn=new Map;function Li(e,t){if(wn.get(e))throw new Error(`Duplicate conditional ${e}`);wn.set(e,t)}Object.values(Im).forEach(({documents:e})=>{e.forEach(t=>{t.type==="conditional"&&Li(`${t.conditional.metadata.sheet}:${t.conditional.metadata.name}`,t.conditional)})});Object.values(kd).forEach(e=>Object.values(e).forEach(({documents:t})=>{t.forEach(n=>{n.type==="conditional"&&Li(`${n.conditional.metadata.sheet}:${n.conditional.metadata.name}`,n.conditional)})}));export{jl as A,Hm as C,Qn as D,Wm as F,Bn as T,at as a,Ri as b,Ml as c,Dl as d,kd as e,Ct as f,dr as g,Rt as h,mr as i,Lm as j,jm as k,Ll as l,It as m,Wl as n,Fm as o,Ul as p,ur as q,Gl as r,qi as s,Il as u,Im as w};
