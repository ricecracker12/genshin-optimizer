import{a as Ze,g as et,r as d,_ as tt,ag as Pt,ah as wt,b as H,j as K,s as Se,d as nt,e as ne,f as st,ai as zt,aj as at,c as ke,u as Dt,h as _t,W as S,ak as ue,i as Me,k as Te,l as Re,m as Be,a7 as Lt,al as Ot,am as ce,an as jt,ao as Oe,ap as qt,p as e,aq as At,a8 as Nt,ar as ot,as as Ft,at as $t,au as Ht,q as h,B as m,av as Kt,w as ye,T as k,aw as rt,z as M,n as V,af as it,a0 as ct,a1 as lt,ax as Wt,ae as Gt,ay as Vt,a5 as he,x as Ut,a2 as U,I as G,R as dt,az as Jt,y as O,aA as Xt,aB as Ie,aC as Qt,aD as Yt,J as Zt,aE as en,aF as tn,aG as ut,aH as nn,aI as ht,a3 as sn,aJ as an,aa as Q,N as je,aK as pt,aL as on,aM as rn,aN as cn,aO as ln,A as mt,aP as dn,aQ as un,aR as hn,aS as qe,aT as pn,aU as mn,aV as Ae,aW as fn}from"./index-B96Pam3P.js";import{r as Cn,a as gn,O as ft,T as bn,C as xn,N as pe,I as Ee,t as vn,L as yn,b as Sn,R as kn,c as Mn,d as be,E as me,e as Tn,f as Rn,g as Bn,o as In,W as En,h as Pn,S as wn,i as zn,j as Dn,u as _n,k as Ln,l as On,m as Ne,n as Fe,p as $e,q as He,s as jn,v as qn,w as An,x as Nn,y as Fn,D as $n,z as Hn,A as Kn,B as Wn,F as Gn,G as Vn,H as Un,J as Jn,K as Xn,M as Qn}from"./Checkroom-CIasqe_e.js";import{C as Yn,D as Ct,b as R,a as Zn,c as es}from"./UploadCard-BN7pdWT0.js";import{c as ts,d as gt,M as se,D as fe,u as Ke,b as ns,C as ss}from"./StatDisplay-D4Fkmsla.js";import{u as bt,b as ae,S as N,g as as,a as os,C as rs}from"./CharacterEditor-Ex_I5oqJ.js";import{C as E,G as I}from"./ReadOnlyTextArea-BRJYD4lk.js";import{u as is,a as cs,g as ls}from"./LightConeTrans-aF6iANxJ.js";import{C as oe}from"./CardActionArea-qP5YW6C4.js";import{T as We,D as ds}from"./Delete-DnciewJJ.js";import{b as J,D as us}from"./BusinessCenter-ByEzr0fF.js";import{C as q}from"./CardHeader-CYrdXbmQ.js";import{u as X}from"./useBoolState-CKFdG-1F.js";import{R as hs,b as xt,S as ps}from"./RelicSetAutocomplete-38ct5z9v.js";import{L as ms}from"./LightConeEditorCard-BcyCV5JK.js";import{D as fs,R as Cs,a as gs}from"./RelicRarityDropdown-Ce-fQUvG.js";import"./InfoTooltip-BZaHxicE.js";import"./LocationAutocomplete-DrY93xr1.js";function bs(n){return Ze("PrivateSwitchBase",n)}et("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const xs=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],vs=n=>{const{classes:t,checked:s,disabled:a,edge:o}=n,r={root:["root",s&&"checked",a&&"disabled",o&&`edge${ne(o)}`],input:["input"]};return st(r,bs,t)},ys=Se(zt)(({ownerState:n})=>H({padding:9,borderRadius:"50%"},n.edge==="start"&&{marginLeft:n.size==="small"?-3:-12},n.edge==="end"&&{marginRight:n.size==="small"?-3:-12})),Ss=Se("input",{shouldForwardProp:at})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),ks=d.forwardRef(function(t,s){const{autoFocus:a,checked:o,checkedIcon:r,className:i,defaultChecked:u,disabled:l,disableFocusRipple:c=!1,edge:p=!1,icon:C,id:v,inputProps:g,inputRef:b,name:P,onBlur:T,onChange:j,onFocus:w,readOnly:z,required:D=!1,tabIndex:A,type:_,value:f}=t,x=tt(t,xs),[y,F]=Pt({controlled:o,default:!!u,name:"SwitchBase",state:"checked"}),L=wt(),De=$=>{w&&w($),L&&L.onFocus&&L.onFocus($)},Bt=$=>{T&&T($),L&&L.onBlur&&L.onBlur($)},It=$=>{if($.nativeEvent.defaultPrevented)return;const Le=$.target.checked;F(Le),j&&j($,Le)};let Y=l;L&&typeof Y>"u"&&(Y=L.disabled);const Et=_==="checkbox"||_==="radio",ge=H({},t,{checked:y,disabled:Y,disableFocusRipple:c,edge:p}),_e=vs(ge);return K.jsxs(ys,H({component:"span",className:nt(_e.root,i),centerRipple:!0,focusRipple:!c,disabled:Y,tabIndex:null,role:void 0,onFocus:De,onBlur:Bt,ownerState:ge,ref:s},x,{children:[K.jsx(Ss,H({autoFocus:a,checked:o,defaultChecked:u,className:_e.input,disabled:Y,id:Et?v:void 0,name:P,onChange:It,readOnly:z,ref:b,required:D,ownerState:ge,tabIndex:A,type:_},_==="checkbox"&&f===void 0?{}:{value:f},g)),y?r:C]}))}),Ms=ke(K.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Ts=ke(K.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Rs=ke(K.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function Bs(n){return Ze("MuiCheckbox",n)}const xe=et("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Is=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],Es=n=>{const{classes:t,indeterminate:s,color:a,size:o}=n,r={root:["root",s&&"indeterminate",`color${ne(a)}`,`size${ne(o)}`]},i=st(r,Bs,t);return H({},t,i)},Ps=Se(ks,{shouldForwardProp:n=>at(n)||n==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(n,t)=>{const{ownerState:s}=n;return[t.root,s.indeterminate&&t.indeterminate,t[`size${ne(s.size)}`],s.color!=="default"&&t[`color${ne(s.color)}`]]}})(({theme:n,ownerState:t})=>H({color:(n.vars||n).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:n.vars?`rgba(${t.color==="default"?n.vars.palette.action.activeChannel:n.vars.palette[t.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:_t.alpha(t.color==="default"?n.palette.action.active:n.palette[t.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${xe.checked}, &.${xe.indeterminate}`]:{color:(n.vars||n).palette[t.color].main},[`&.${xe.disabled}`]:{color:(n.vars||n).palette.action.disabled}})),ws=K.jsx(Ts,{}),zs=K.jsx(Ms,{}),Ds=K.jsx(Rs,{}),_s=d.forwardRef(function(t,s){var a,o;const r=Dt({props:t,name:"MuiCheckbox"}),{checkedIcon:i=ws,color:u="primary",icon:l=zs,indeterminate:c=!1,indeterminateIcon:p=Ds,inputProps:C,size:v="medium",className:g}=r,b=tt(r,Is),P=c?p:l,T=c?p:i,j=H({},r,{color:u,indeterminate:c,size:v}),w=Es(j);return K.jsx(Ps,H({type:"checkbox",inputProps:H({"data-indeterminate":c},C),icon:d.cloneElement(P,{fontSize:(a=P.props.fontSize)!=null?a:v}),checkedIcon:d.cloneElement(T,{fontSize:(o=T.props.fontSize)!=null?o:v}),ownerState:j,ref:s,className:nt(w.root,g)},b,{classes:w}))});function vt(n){const{database:t}=S();return ue(t.builds,n??"")}function Pe(n){const{database:t}=S();return ue(t.buildTcs,n??"")}function re(n){const{database:t}=S();return ue(t.teams,n)}var Z={},Ge;function Ls(){if(Ge)return Z;Ge=1;var n=Me();Object.defineProperty(Z,"__esModule",{value:!0}),Z.default=void 0;var t=n(Te()),s=Re(),a=(0,t.default)((0,s.jsx)("path",{d:"M12 12.75c1.63 0 3.07.39 4.24.9 1.08.48 1.76 1.56 1.76 2.73V18H6v-1.61c0-1.18.68-2.26 1.76-2.73 1.17-.52 2.61-.91 4.24-.91zM4 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm1.13 1.1c-.37-.06-.74-.1-1.13-.1-.99 0-1.93.21-2.78.58C.48 14.9 0 15.62 0 16.43V18h4.5v-1.61c0-.83.23-1.61.63-2.29zM20 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm4 3.43c0-.81-.48-1.53-1.22-1.85-.85-.37-1.79-.58-2.78-.58-.39 0-.76.04-1.13.1.4.68.63 1.46.63 2.29V18H24v-1.57zM12 6c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}),"Groups");return Z.default=a,Z}var Os=Ls();const Ve=Be(Os);function js({teamId:n,children:t}){const s=re(n),a=le(s.teamMetadata,0),o=le(s.teamMetadata,1),r=le(s.teamMetadata,2),i=le(s.teamMetadata,3),u=d.useMemo(()=>Lt([...Ot(s.teamMetadata.map(l=>l==null?void 0:l.characterKey).filter(l=>!!l)),...a,...o,...r,...i,ce.common.lvl.add(80),ce.common.res.add(.1),ce.common.isBroken.add(0),ce.common.maxToughness.add(100),jt.common.critMode.add("avg"),...s.conditionals.flatMap(({sheet:l,src:c,dst:p,condKey:C,condValues:v})=>v.flatMap((g,b)=>g?Oe(`preset${b}`,qt(l,c,p)(C,g)):[])),...s.bonusStats.flatMap(({tag:l,values:c})=>c.flatMap((p,C)=>Oe(`preset${C}`,{tag:{...l},value:Ht(p)})))]),[s,a,o,r,i]);return e(Yn.Provider,{value:u,children:t})}function le(n,t){const s=n[t],a=bt(s==null?void 0:s.characterKey),o=Pe(s==null?void 0:s.buildTcId),r=vt(s==null?void 0:s.buildId),i=is((s==null?void 0:s.buildType)==="equipped"?a==null?void 0:a.equippedLightCone:(s==null?void 0:s.buildType)==="real"?r==null?void 0:r.lightConeId:void 0),u=At((s==null?void 0:s.buildType)==="equipped"?a==null?void 0:a.equippedRelics:(s==null?void 0:s.buildType)==="real"?r==null?void 0:r.relicIds:void 0),l=d.useMemo(()=>{const p=(s==null?void 0:s.buildType)==="tc"?o==null?void 0:o.lightCone:i;return p?Nt(p.key,p.level,p.ascension,p.superimpose):[]},[s==null?void 0:s.buildType,o==null?void 0:o.lightCone,i]),c=d.useMemo(()=>{const p=o==null?void 0:o.relic;return(s==null?void 0:s.buildType)==="tc"&&p?Cn(p):u?gn(Object.values(u).filter(ot)):[]},[o==null?void 0:o.relic,s==null?void 0:s.buildType,u]);return d.useMemo(()=>a?Ft(a.key,...$t(a,t+1),...l,...c):[],[a,t,l,c])}const ie=d.createContext({presetIndex:0,setPresetIndex:()=>{}}),Ce=d.createContext({teamId:"",team:{}});function W(){return d.useContext(Ce)}const yt=d.createContext({buildType:"equipped",buildId:""});function B(){return d.useContext(yt)}function qs(){const{database:n}=S(),{team:t,teamId:s}=W();return h(m,{sx:{display:"flex",gap:1,overflowX:"auto",overflowY:"visible",p:1},children:[t.frames.map((a,o)=>e(As,{frame:a,index:o},o)),e(m,{sx:{flexShrink:0},children:e(ft,{setOptTarget:a=>n.teams.set(s,o=>{o.frames=[...o.frames,{multiplier:1,tag:{...a,preset:`preset${o.frames.length}`}}]})})})]})}function As({frame:n,index:t}){const{presetIndex:s,setPresetIndex:a}=d.useContext(ie),o=ae(),{setRead:r}=d.useContext(Ct),i=d.useMemo(()=>new Kt(n.tag,"sum"),[n.tag]),u=d.useMemo(()=>{try{return(o==null?void 0:o.compute(i).val)??0}catch(p){return console.error("Error computing value:",p),0}},[o,i]),l=ye(n.tag.q??""),c=d.useCallback(p=>{p.altKey?r(i):a(t)},[t,i,a,r]);return e(M,{bgt:"light",sx:p=>({flexShrink:0,outline:s===t?`solid ${p.palette.success.main}`:void 0}),children:h(oe,{onClick:c,children:[h(m,{sx:{display:"flex",gap:1,alignItems:"stretch",p:1},children:[e(k,{children:t+1}),e(R,{orientation:"vertical"}),e(m,{sx:{display:"flex",alignItems:"center"},children:e(bn,{tag:n.tag})})]}),e(R,{}),e(m,{sx:{p:1,display:"flex",alignItems:"center",gap:1},children:h(k,{children:[n.multiplier," x ",rt(u,l)]})})]})})}var ee={},Ue;function Ns(){if(Ue)return ee;Ue=1;var n=Me();Object.defineProperty(ee,"__esModule",{value:!0}),ee.default=void 0;var t=n(Te()),s=Re(),a=(0,t.default)((0,s.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");return ee.default=a,ee}var Fs=Ns();const $s=Be(Fs);function Hs({teamId:n,charKey:t}){const{t:s}=V("page_team"),a=it(),o=ct(),r=lt(o.breakpoints.down("md")),i=re(n);return i?e(Vt,{variant:"fullWidth",value:t??0,orientation:r?"vertical":"horizontal",sx:()=>({borderBottom:"1px rgb(200,200,200,0.3) solid","& .MuiTab-root:hover":{transition:"background-color 0.25s ease",backgroundColor:"rgba(255,255,255,0.1)"},"& .Mui-selected":{color:"white !important"},"& .MuiTabs-indicator":{height:"4px",backgroundColor:"rgb(200,200,200,0.5)"},minHeight:"1em"}),children:i.teamMetadata.map((u,l)=>{const c=u==null?void 0:u.characterKey;return e(Wt,{icon:c?e(Gt,{size:1.5,src:ts(gt(c),"icon")}):e($s,{}),iconPosition:"start",value:c??l,disabled:!u,label:c?e(k,{children:s(`charNames_gen:${c}`)}):`Character ${l+1}`,onClick:()=>c&&a(`/teams/${n}/${c}`),sx:{p:1,minHeight:"1em"}},l)})}):null}var te={},Je;function Ks(){if(Je)return te;Je=1;var n=Me();Object.defineProperty(te,"__esModule",{value:!0}),te.default=void 0;var t=n(Te()),s=Re(),a=(0,t.default)((0,s.jsx)("path",{d:"M22 24H2v-4h20v4zM13.06 5.19l3.75 3.75L7.75 18H4v-3.75l9.06-9.06zm4.82 2.68-3.75-3.75 1.83-1.83c.39-.39 1.02-.39 1.41 0l2.34 2.34c.39.39.39 1.02 0 1.41l-1.83 1.83z"}),"BorderColor");return te.default=a,te}var Ws=Ks();const Gs=Be(Ws);function Vs({teamId:n}){const t=re(n);return e(m,{display:"flex",flexDirection:"column",gap:1,children:t.teamMetadata.map((s,a)=>e(Us,{teamMetadataIndex:a,teamId:n},`${a}_${s==null?void 0:s.characterKey}`))})}const Us=d.memo(function({teamMetadataIndex:t,teamId:s}){var i;const{database:a}=S(),o=re(s);function r(u){if(u===""){a.teams.set(s,c=>c.teamMetadata[t]=void 0);return}a.chars.getOrCreate(u);const l=o.teamMetadata.findIndex(c=>(c==null?void 0:c.characterKey)===u);if(l===-1)a.teams.set(s,c=>{c.teamMetadata[t]={characterKey:u}});else{if(l===t)return;const c=o.teamMetadata[l],p=o.teamMetadata[t];a.teams.set(s,C=>{C.teamMetadata[t]=c,C.teamMetadata[l]=p})}}return e(xn,{charKey:((i=o.teamMetadata[t])==null?void 0:i.characterKey)??"",setCharKey:r})});function Js(){const{t:n}=V("page_team"),{teamId:t,team:s}=W(),{database:a}=S(),[o,r]=d.useState(!1),i=l=>{a.teams.set(t,{name:l})},u=l=>{a.teams.set(t,{description:l})};return h(he,{children:[e(oe,{onClick:()=>r(!0),children:e(Ut,{placement:"top",title:h(m,{children:[h(m,{sx:{display:"flex",color:"info.light",gap:1},children:[e(Gs,{}),e(k,{children:e("strong",{children:n("team.editNameDesc")})})]}),!!s.description&&e(k,{children:s.description})]}),children:e(E,{sx:{display:"flex",justifyContent:"center","&:hover":{color:"info.light"},py:1},children:h(k,{variant:"h5",sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"center",textShadow:"#000 0 0 10px !important"},children:[e(Ve,{}),s.name]})})})}),e(U,{open:o,onClose:()=>r(!1),children:h(M,{children:[e(q,{title:n("team.editNameDesc"),avatar:e(Ve,{}),titleTypographyProps:{variant:"h6"},action:e(G,{onClick:()=>r(!1),children:e(J,{})})}),e(R,{}),e(E,{children:h(m,{display:"flex",flexDirection:"column",gap:2,sx:{mt:2},children:[e(We,{label:n("team.name"),value:s.name,onChange:l=>i(l),autoFocus:!0}),e(We,{label:n("team.desc"),value:s.description,onChange:l=>u(l),multiline:!0,minRows:4}),e(Vs,{teamId:t})]})})]})})]})}const St=210,kt=2,Mt=d.createContext(St);function Xs({teamId:n,characterKey:t,headerRef:s}){return e(m,{ref:s,sx:{overflow:"visible",top:kt,position:"sticky",zIndex:101},children:h(M,{sx:a=>({outline:`solid ${a.palette.secondary.main}`}),children:[e(Js,{}),e(R,{}),e(qs,{}),e(R,{}),e(Hs,{teamId:n,charKey:t})]})})}function Qs(){const{database:n}=S(),{presetIndex:t}=d.useContext(ie),{teamId:s,team:{bonusStats:a}}=W(),{characterKey:o}=B(),r=i=>{const u=Ys(i,o);n.teams.setBonusStat(s,u,0,t)};return t?h(M,{children:[e(q,{title:"Bonus Stats"}),e(R,{}),e(E,{children:h(N,{spacing:1,children:[a.map(({tag:i,values:u},l)=>e(ta,{tag:i,value:u[t],setValue:c=>n.teams.setBonusStat(s,i,c,t),onDelete:()=>n.teams.setBonusStat(s,i,0,t),setTag:c=>n.teams.setBonusStat(s,c,0,t)},JSON.stringify(i)+l)),e(ea,{onSelect:r})]})})]}):null}function Ys(n,t){return{src:t,dst:t,et:"own",q:n,qt:"premod",sheet:"agg"}}const Zs=["hp","hp_","def","def_","atk","atk_","spd","spd_","dmg_","enerRegen_","brEffect_","crit_","crit_dmg_","eff_","eff_res_","heal_"];function ea({tag:n={},onSelect:t}){var s;return e(fe,{title:(n&&((s=vn.subset(n)[0])==null?void 0:s.title))??"Add Bonus Stat",children:Zs.map(a=>e(se,{onClick:()=>t(a),children:a},a))})}function ta({tag:n,setTag:t,value:s,setValue:a,onDelete:o}){var i;const r=(i=n.name||n.q)==null?void 0:i.endsWith("_");return e(M,{bgt:"light",children:h(E,{sx:{display:"flex",gap:1,justifyContent:"space-around"},children:[e(dt,{sx:{m:"auto"},children:n.q}),n.q==="dmg_"&&e(na,{tag:n,setElementalType:u=>{const{elementalType:l,...c}=n;t(u?{...c,elementalType:u}:c)}}),e(pe,{float:!0,value:s,sx:{flexBasis:150,flexGrow:1,height:"100%"},onChange:a,placeholder:"Stat Value",size:"small",inputProps:{sx:{textAlign:"right"}},InputProps:{endAdornment:h(Ee,{position:"end",sx:{ml:0},children:[r?"%":void 0," ",e(G,{"aria-label":"Delete Bonus Stat",onClick:o,edge:"end",children:e(us,{fontSize:"small"})})]})}})]})})}function na({tag:n,setElementalType:t}){return h(fe,{title:n.elementalType??"No Element",children:[e(se,{onClick:()=>t(null),children:"No Element"}),Jt.map(s=>e(se,{onClick:()=>t(s),children:s},s))]})}function sa({onClose:n}){const{database:t}=S(),{characterKey:s}=B(),a=Ke(t.builds),o=d.useMemo(()=>a&&t.builds.getBuildIds(s),[a,t,s]),r=Ke(t.buildTcs),i=d.useMemo(()=>r&&t.buildTcs.getBuildTcIds(s),[r,t,s]);return h(M,{bgt:"dark",children:[e(q,{title:"Builds",action:n?e(G,{onClick:n,children:e(J,{})}):null}),e(R,{}),e(E,{children:h(N,{spacing:1,children:[e(k,{variant:"h6",children:"Equipped build"}),e(aa,{}),e(k,{variant:"h6",children:"Other builds"}),o.map(u=>e(oa,{buildId:u},u)),e(k,{variant:"h6",children:"TC builds"}),e(O,{fullWidth:!0,onClick:()=>t.buildTcs.new(Xt(s)),children:"New TC Build"}),i.map(u=>e(ra,{buildTcId:u},u))]})})]})}function we(n,t=""){const{database:s}=S(),{characterKey:a,buildType:o,buildId:r,buildTcId:i}=B(),{teamId:u}=W();return d.useMemo(()=>({active:o==="equipped"?o===n:o==="real"?r===t:o==="tc"&&i===t,onActive:()=>{s.teams.set(u,l=>{const c=l.teamMetadata.find(p=>(p==null?void 0:p.characterKey)===a);if(!c){console.error(`Teammate data not found for character ${a}`);return}c.buildType=n,n==="real"&&t?c.buildId=t:n==="tc"&&t&&(c.buildTcId=t)})}}),[r,i,o,a,s.teams,t,n,u])}function aa(){const n=Ie(),{equippedRelics:t,equippedLightCone:s}=n,{active:a,onActive:o}=we("equipped");return e(ze,{name:"Equipped",onActive:o,active:a,buildGrid:e(me,{relicIds:t,lightConeId:s})})}function oa({buildId:n}){const t=vt(n),{relicIds:s,lightConeId:a,name:o,description:r}=t,{active:i,onActive:u}=we("real",n);return e(ze,{name:o,description:r,onActive:u,active:i,buildGrid:e(me,{relicIds:s,lightConeId:a})})}function ze({name:n,description:t,buildGrid:s,active:a,onActive:o}){const r=d.useCallback(()=>{},[]);return h(M,{sx:i=>({outline:a?`solid ${i.palette.success.main}`:void 0}),children:[h(m,{display:"flex",children:[e(oe,{onClick:r,children:e(q,{title:n,subheader:t})}),e(m,{display:"flex",alignContent:"center",sx:{padding:1},children:e(O,{size:"small",color:"success",onClick:o,disabled:a,children:"Set Active"})})]}),e(R,{}),e(E,{children:s})]})}function ra({buildTcId:n}){const t=Pe(n),{name:s="ERROR",description:a="ERROR"}=t??{},{active:o,onActive:r}=we("tc",n);return e(ze,{name:s,description:a,onActive:r,active:o,buildGrid:e(Tt,{buildTcId:n})})}function Tt({buildTcId:n}){const{database:t}=S(),s=Pe(n),{lightCone:a,relic:o}=s,[r,i,u]=X(),[l,c,p]=X(),[C,v,g]=X(),[b,P,T]=X(),j=d.useCallback(f=>{t.buildTcs.set(n,x=>({lightCone:{...x.lightCone,...f}}))},[n,t.buildTcs]),w=d.useCallback((f,x)=>{t.buildTcs.set(n,y=>({relic:{...y.relic,slots:{...y.relic.slots,[f]:{...y.relic.slots[f],...x}}}}))},[n,t.buildTcs]),z=d.useCallback((f,x)=>{t.buildTcs.set(n,y=>({relic:{...y.relic,substats:{...y.relic.substats,stats:{...y.relic.substats.stats,[f]:x}}}}))},[n,t.buildTcs]),D=d.useCallback(f=>{t.buildTcs.set(n,x=>({relic:{...x.relic,substats:{...x.relic.substats,type:f}}}))},[n,t.buildTcs]),A=d.useCallback((f,x)=>{t.buildTcs.set(n,y=>({relic:{...y.relic,sets:{...y.relic.sets,[f]:x}}}))},[n,t.buildTcs]),_=d.useCallback(f=>{t.buildTcs.set(n,x=>{const y={...x.relic.sets};return delete y[f],{relic:{...x.relic,sets:y}}})},[n,t.buildTcs]);return h(m,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e(ia,{show:r,onClose:u,lightCone:a,onUpdate:j}),a?e(yn,{bgt:"light",lightCone:a,onClick:i}):e(Sn,{bgt:"light",onClick:i}),e(ha,{show:b,onClose:T,sets:o.sets,setSets:A,removeSet:_}),e(kn,{bgt:"light",sets:o.sets,onClick:P}),e(ca,{show:l,onClose:p,slots:o.slots,setSlot:w}),e(Mn,{bgt:"light",slots:o.slots,onClick:c}),e(da,{stats:o.substats.stats,show:C,onClose:g,type:o.substats.type,setType:D,setStat:z}),e(be,{onClick:v,relic:o,keys:["hp","hp_","def","def_"],bgt:"light"}),e(be,{onClick:v,relic:o,keys:["atk","atk_","crit_","crit_dmg_"],bgt:"light"}),e(be,{onClick:v,relic:o,keys:["spd","eff_","eff_res_","brEffect_"],bgt:"light"})]})}function ia({lightCone:n={},onUpdate:t,show:s,onClose:a}){return e(U,{open:s,onClose:a,children:e(ms,{onClose:a,lightCone:n,setLightCone:t,hideLocation:!0})})}function ca({slots:n,show:t,onClose:s,setSlot:a}){return e(U,{open:t,onClose:s,containerProps:{maxWidth:"sm"},children:h(M,{children:[e(q,{title:"TC Build Relic Slots Editor",action:e(G,{onClick:s,children:e(J,{})})}),e(R,{}),e(E,{children:e(N,{spacing:1,children:Object.entries(n).map(([o,{level:r,statKey:i,rarity:u}])=>e(la,{slotKey:o,level:r,statKey:i,rarity:u,setStatKey:l=>a(o,{statKey:l}),setRarity:l=>a(o,{rarity:l}),setLevel:l=>a(o,{level:l})},o))})})]})})}function la({slotKey:n,level:t,rarity:s,statKey:a,setStatKey:o,setRarity:r,setLevel:i}){return h(m,{sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"space-between"},children:[e(ps,{slotKey:n}),e(Cs,{rarity:s,onRarityChange:r,showNumber:!0}),e(m,{sx:{flexGrow:1},children:e(gs,{dropdownButtonProps:{fullWidth:!0},slotKey:n,statKey:a,setStatKey:o})}),e(pe,{value:t,inputProps:{sx:{width:"2ch"},max:en[s],min:0},InputProps:{startAdornment:e(Ee,{position:"start",children:"Level"})},size:"small",onChange:i})]})}function da({show:n,onClose:t,stats:s,setStat:a}){return e(U,{open:n,onClose:t,containerProps:{maxWidth:"sm"},children:h(M,{children:[e(q,{title:"TC Build Substats Editor",action:e(G,{onClick:t,children:e(J,{})})}),e(R,{}),e(E,{children:e(N,{spacing:1,children:e(m,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",rowGap:1,columnGap:2},children:Object.entries(s).map(([o,r])=>e(ua,{statKey:o,value:r,setValue:i=>a(o,i)},o))})})})]})})}function ua({statKey:n,value:t,setValue:s}){return h(m,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[e(ns,{statKey:n}),e(pe,{value:t,onChange:s,float:ye(n)==="%",size:"small",inputProps:{sx:{width:"4em",textAlign:"right"},min:0,max:9999},InputProps:{endAdornment:ye(n)||e(m,{width:"0.8em",component:"span"})}})]})}function ha({show:n,onClose:t,sets:s,setSets:a,removeSet:o}){const[r,i]=d.useState(null),u=d.useCallback(c=>{c&&(Qt(c)?a(c,2):Yt(c)&&i(c))},[a]),l=d.useCallback(c=>{r&&(a(r,c),i(null))},[r,a]);return e(U,{open:n,onClose:t,containerProps:{maxWidth:"sm"},children:h(M,{children:[e(q,{title:"TC Build Relic Sets Editor",action:e(G,{onClick:t,children:e(J,{})})}),e(R,{}),e(E,{children:h(N,{spacing:1,children:[Object.entries(s).map(([c,p])=>h(m,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(hs,{setKey:c}),e(dt,{children:p}),e(G,{size:"small",onClick:()=>o(c),children:e(fs,{})})]},c)),h(m,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(xt,{size:"small",relicSetKey:r??"",setRelicSetKey:u,sx:{flexGrow:1},label:r??""}),h(Zt,{children:[e(O,{disabled:!r,onClick:()=>l(2),children:"2"}),e(O,{disabled:!r,onClick:()=>l(4),children:"4"})]})]})]})})]})})}function pa(){const{team:n}=W(),t=n.conditionals,[s,a]=d.useState(""),o=d.useMemo(()=>{const r=t.map(i=>i.sheet).filter(tn);return s&&r.push(s),[...new Set(r)].sort(i=>i===s?-1:1)},[t,s]);return h(N,{spacing:1,sx:{pt:1},children:[e(cs,{lcKey:s,setLCKey:a,label:"Search Light Cone"}),e(m,{children:e(I,{container:!0,columns:3,spacing:1,children:o.map(r=>e(I,{item:!0,xs:1,children:e(Tn,{lcKey:r})},r))})})]})}function ma(n){const{database:t}=S();return ue(t.generatedBuildList,n)}const fa=d.memo(function(){const{optConfig:t}=d.useContext(ut),s=ma(t.generatedBuildListId??"");return e(N,{spacing:1,children:s==null?void 0:s.builds.map((a,o)=>e(M,{children:h(E,{children:[h(m,{sx:{display:"flex",justifyContent:"space-between",gap:1},children:[h(k,{children:["Build ",o+1,": ",rt(a.value)]}),e(Ca,{build:a})]}),e(me,{relicIds:a.relicIds,lightConeId:a.lightConeId})]})},`${o}-${a.lightConeId}-${Object.values(a.relicIds).join("-")}`))})});function Ca({build:{relicIds:n,lightConeId:t}}){const{t:s}=V("build"),[a,o]=d.useState(""),[r,i,u]=X(),[l,c]=d.useState(!1),{database:p}=S(),{teamId:C}=W(),{characterKey:v}=B(),g=b=>{b.preventDefault(),l||p.builds.new({characterKey:v,name:a,teamId:C,relicIds:n,lightConeId:t}),o(""),u()};return h(he,{children:[e(O,{color:"info",size:"small",startIcon:e(Rn,{}),onClick:i,children:s("createBuildReal.button")}),e(U,{open:r,onClose:u,disableRestoreFocus:!0,children:h(M,{children:[e(q,{title:s("createBuildReal.title"),action:e(G,{onClick:u,children:e(J,{})})}),e(R,{}),h(E,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e(k,{children:s("createBuildReal.desc")}),h(m,{display:"flex",alignItems:"center",sx:{ml:-1},children:[e(_s,{size:"small",checked:l,onChange:()=>c(!l)}),e(k,{children:"Create a new TC Build"})]}),h("form",{onSubmit:g,children:[e(Zn,{value:a,onChange:b=>o(b.target.value),autoFocus:!0,margin:"dense",label:s("createBuildReal.label"),fullWidth:!0}),h(m,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e(O,{onClick:u,children:s("createBuildReal.cancel")}),e(O,{type:"submit",color:"success",disabled:!a,children:s("createBuildReal.create")})]})]})]})]})})]})}function ga(){const{database:n}=S(),{teamId:t}=d.useContext(Ce),s=B(),a=s.optConfigId,o=d.useCallback(()=>{a||n.teams.set(t,r=>{const i=r.teamMetadata.find(u=>(u==null?void 0:u.characterKey)===s.characterKey);if(i){const u=n.optConfigs.new();i.optConfigId=u}})},[t,s.characterKey,n,a]);return a?h(nn,{optConfigId:a,children:[e(ba,{}),e(fa,{})]}):e(M,{children:e(q,{title:h("span",{children:["Optimize this team for ",s.characterKey]}),action:e(O,{onClick:o,children:"Optimize"})})})}function ba(){const{t:n}=V("optimize"),{database:t}=S(),s=ae(),{team:a}=d.useContext(Ce),{characterKey:o}=B(),[r,i]=d.useState(8),[u,l]=d.useState(void 0),{optConfig:c,optConfigId:p}=d.useContext(ut),C=d.useMemo(()=>t.relics.values.reduce((z,D)=>(z[D.slotKey].push(D),z),{head:[],hands:[],feet:[],body:[],sphere:[],rope:[]}),[t.relics.values]),v=d.useMemo(()=>{const{path:z}=as(o);return t.lightCones.values.filter(({key:D})=>{const{path:A}=ls(D);return z===A})},[o,t.lightCones.values]),g=d.useMemo(()=>Bn(Object.values(C))*v.length,[v.length,C]),[b,P]=d.useState(!1),T=d.useRef(()=>{});d.useEffect(()=>()=>T.current(),[]);const j=d.useCallback(async()=>{if(!s)return;const z=new Promise(f=>T.current=f);l(void 0),P(!0);const D=(c.statFilters??[]).filter(f=>!f.disabled),A=In(o,s,a.frames,10,D,[],[],[],v,C,r,l);z.then(()=>A.terminate("user cancelled"));let _;try{_=await A.results}catch{return}finally{T.current=()=>{},P(!1)}_.length&&t.optConfigs.newOrSetGeneratedBuildList(p,{builds:_.slice(0,5).map(({ids:f,value:x})=>({lightConeId:f[0],relicIds:ht(sn,(y,F)=>f[F+1]),value:x})),buildDate:Date.now()})},[s,c.statFilters,o,a.frames,v,C,r,t.optConfigs,p]),w=d.useCallback(()=>{T.current(),P(!1)},[T]);return h(M,{children:[e(q,{title:n("optimize"),action:h(m,{children:[e(En,{numWorkers:r,setNumWorkers:i}),e(O,{onClick:b?w:j,color:b?"error":"primary",startIcon:b?e(J,{}):e(Pn,{}),children:n(b?"cancel":"optimize")})]})}),e(R,{}),h(E,{children:[e(wn,{}),u&&e(xa,{progress:u,total:g})]})]})}function de({value:n}){const t=n.toLocaleString();return e(m,{sx:{fontFamily:"Monospace",display:"inline"},children:t})}function xa(n){const{t}=V("optimize"),{computed:s,remaining:a,skipped:o}=n.progress,r=s+a,i=Math.log1p(r)/Math.log1p(n.total),u=a/r*i;return h(m,{children:[h(k,{children:[t("computed"),": ",e(de,{value:s})," /"," ",e(de,{value:r})," "]}),h(k,{children:[t("computed + skipped"),": ",e(de,{value:s+o})," /"," ",e(de,{value:n.total})]}),e(zn,{variant:"determinate",value:(1-u)*100,sx:{height:10,borderRadius:5}})]})}function va(){const{team:n}=W(),t=n.conditionals,[s,a]=d.useState(""),o=d.useMemo(()=>{const r=t.map(i=>i.sheet).filter(an);return s&&r.push(s),[...new Set(r)].sort(i=>i===s?-1:1)},[t,s]);return h(N,{spacing:1,sx:{pt:1},children:[e(xt,{relicSetKey:s,setRelicSetKey:a,label:"Search Relic Set"}),e(m,{children:e(I,{container:!0,columns:3,spacing:1,children:o.map(r=>e(I,{item:!0,xs:1,children:e(Dn,{setKey:r})},r))})})]})}const ya={xs:12,sm:6,md:4};function Sa(){const{characterKey:n}=B(),t=ae(),s=["basic","skill","ult","talent","technique","overworld","bonusAbility1","bonusAbility2","bonusAbility3",...On],a=ct(),o=lt(a.breakpoints.up("lg")),r=_n[n],i=(t==null?void 0:t.compute(Q.char.eidolon).val)??0,u=d.useMemo(()=>r&&Ln.map(l=>{const c=r[l];return c?e(Xe,{talentKey:l,sheetElement:c},l):null}),[r]);if(!(!r||!t))return e(he,{children:h(I,{container:!0,spacing:1,children:[o&&h(I,{item:!0,xs:12,md:12,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[e(Qe,{eidolon:i}),u&&u.map((l,c)=>e(m,{sx:{opacity:i>=c+1?1:.5},children:l},c))]}),e(I,{item:!0,xs:12,md:12,lg:9,container:!0,spacing:1,children:s.map(l=>{const c=r[l];return c?e(I,{item:!0,...ya,children:e(Xe,{talentKey:l,sheetElement:c})},l):null})}),!o&&e(I,{item:!0,xs:12,md:12,lg:3,container:!0,spacing:1,children:e(I,{item:!0,xs:12,children:e(Qe,{eidolon:i})})})]})})}function Xe({sheetElement:n,talentKey:t}){const s=ae(),{characterKey:a}=B(),{database:o}=S(),{img:r,title:i,subtitle:u,documents:l}=n,c=d.useMemo(()=>s?Ne(t)?Fe[t].disabled(s):$e(t)?He[t].disabled(s):!1:!1,[s,t]),p=d.useMemo(()=>{if(s){if(Ne(t)&&Fe[t].onClickable(s))return()=>o.chars.set(a,g=>{const b=jn(t);g.statBoosts={...g.statBoosts,[b]:!g.statBoosts[b]}});if($e(t)&&He[t].onClickable(s))return()=>o.chars.set(a,g=>{const b=qn(t);g.bonusAbilities={...g.bonusAbilities,[b]:!g.bonusAbilities[b]}});if(An(t)){const g=Nn(t),b=(s==null?void 0:s.compute(Q.char.eidolon).val)??0;return()=>o.chars.set(a,{eidolon:g===b?g-1:g})}}},[t,s,o.chars,a]),C=d.useCallback(g=>e(oe,{onClick:p,children:g}),[p]);let v=null;return v=null,Hn(t)&&(v=e(ka,{talentKey:t,dropDownButtonProps:{sx:{borderRadius:0}},setTalent:g=>o.chars.set(a,b=>{b[t]=g})})),h(M,{bgt:"light",sx:{height:"100%",opacity:c?.5:1},children:[v,h(m,{sx:{p:1},children:[e(Fn,{condition:!!p,wrapper:C,children:h(I,{container:!0,sx:{flexWrap:"nowrap"},children:[r&&e(I,{item:!0,children:e(m,{component:je?je:"img",src:r,sx:{width:60,height:"auto"}})}),h(I,{item:!0,flexGrow:1,sx:{pl:1},children:[e(k,{variant:"subtitle1",children:i}),u&&e(k,{variant:"subtitle2",children:u})]})]})}),l.map((g,b)=>e($n,{document:g,collapse:!0},b))]})]})}function Qe({eidolon:n}){const{t}=V("characters_gen"),{characterKey:s}=B(),{database:a}=S();return e(fe,{fullWidth:!0,title:h("span",{children:[t("eidolonLvl")," ",n]}),color:"primary",children:pt(0,on).map(o=>e(se,{selected:n===o,disabled:n===o,onClick:()=>a.chars.set(s,{eidolon:o}),children:h("span",{children:[t("eidolonLvl")," ",o]})},o))})}function ka({talentKey:n,setTalent:t,dropDownButtonProps:s}){const{t:a}=V("common_gen"),o=Ie(),r=ae();if(!r||!o)return null;const i=0,u=r.compute(Q.char[n]).val,l=r.compute(Q.char.ascension).val;return e(fe,{fullWidth:!0,title:h("span",{children:[a("lv")," ",u]}),color:"primary",...s,children:pt(1,rn[l]).map(c=>e(se,{selected:o[n]===c,disabled:o[n]===c,onClick:()=>t(c),children:h("span",{children:[a("lv")," ",c+i]})},c))})}const Ma=0,ve=33,Rt=d.createContext(0);function Ta(){const{presetIndex:n}=d.useContext(ie),{team:t}=W(),s=d.useMemo(()=>t.frames[n]?[["combo",`Edit Combo ${n+1}`,e(Ba,{},"combo")],["char","Character",e(Ye,{},"char")],["talent","Talent",e(Sa,{},"talent")],["relicCond","Relic Conditionals",e(va,{},"relicCond")],["lightConeCond","Light Cone Conditionals",e(pa,{},"lightConeCond")],["opt","Optimize",e(Ia,{},"opt")]]:[["char","Character",e(Ye,{})]],[t,n]);return e(Rt.Provider,{value:s.length,children:e(N,{gap:1,children:s.map(([a,o,r],i)=>e(Ra,{title:o,index:i,children:r},a))})})}function Ra({index:n,title:t,children:s}){const[a,o]=Wn(),r=d.useContext(Rt),i=d.useContext(Mt);return h(he,{children:[e(M,{sx:u=>({outline:`solid ${u.palette.secondary.main}`,position:"sticky",top:i+n*ve,bottom:Ma+(r-1-n)*ve,zIndex:100}),children:e(oe,{onClick:o,sx:{px:1},children:e(k,{variant:"h6",children:t})})}),e(m,{ref:a,sx:{scrollMarginTop:i+(n+1)*ve},children:s})]})}function Ba(){const{database:n}=S(),{presetIndex:t,setPresetIndex:s}=d.useContext(ie),{team:a,teamId:o}=W(),r=d.useMemo(()=>a.frames[t],[a,t]),i=l=>{n.teams.set(o,c=>{c.frames=[...c.frames],c.frames[t]={...c.frames[t],...l},c.frames.length?c.frames.length<=t&&s(c.frames.length-1):s(0)})},u=()=>{n.teams.set(o,l=>{l.frames=l.frames.filter((c,p)=>p!==t)})};return r?h(m,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(pe,{value:r.multiplier,onChange:l=>i({multiplier:l}),size:"small",InputProps:{startAdornment:e(Ee,{position:"start",children:"Multi x "})}}),e(ft,{optTarget:r.tag,setOptTarget:l=>i({tag:l})}),e(O,{size:"small",color:"error",onClick:u,startIcon:e(ds,{}),children:"Remove"})]}):null}function Ye(){const n=Ie(),{key:t}=n,[s,a]=d.useState(void 0);return h(N,{spacing:1,children:[h(m,{sx:{display:"flex",gap:1},children:[h(m,{sx:{minWidth:"350px"},children:[e(os,{character:n}),e(rs,{characterKey:s,onClose:()=>a(void 0)}),e(O,{fullWidth:!0,disabled:!t,onClick:()=>t&&a(t),children:"Edit Character"})]}),e(Ea,{})]}),e(Qs,{}),e(Kn,{formulasRead:Q.listing.formulas,buffsRead:Q.listing.buffs})]})}function Ia(){const{buildType:n}=B();return n==="tc"?null:e(ga,{})}function Ea(){const n=B(),{database:t}=S(),{buildType:s,buildId:a,buildTcId:o}=n,r=d.useSyncExternalStore(d.useCallback(c=>{let p=()=>{};return s==="real"&&(p=t.builds.follow(a,c)),s==="tc"&&(p=t.buildTcs.follow(o,c)),()=>p()},[a,o,s,t]),()=>t.teams.getActiveBuildName(n)),[i,u,l]=X();return h(M,{sx:{width:"100%"},children:[e(za,{show:i,onClose:l}),e(q,{title:r,action:e(O,{onClick:u,size:"small",children:"Change Build"})}),e(R,{}),e(E,{children:s==="tc"?e(wa,{}):e(Pa,{})})]})}function Pa(){const n=B(),{database:t}=S(),{relicIds:s,lightConeId:a}=d.useMemo(()=>t.teams.getTeamActiveBuild(n),[t.teams,n]);return e(me,{relicIds:s,lightConeId:a})}function wa(){const n=B();return n.buildType!=="tc"?null:e(Tt,{buildTcId:n.buildTcId})}function za({show:n,onClose:t}){return e(U,{open:n,onClose:t,containerProps:{maxWidth:"xl"},children:e(sa,{onClose:t})})}const Da=e(mt,{variant:"rectangular",width:"100%",height:1e3});function Za(){const{database:n}=S(),{teamId:t}=cn(),s=!t||!n.teams.keys.includes(t);return d.useEffect(()=>{s||n.teams.set(t,{lastEdit:Date.now()})},[t,n.teams,s]),s?e(ln,{to:"/teams"}):e(m,{display:"flex",flexDirection:"column",gap:1,children:e(d.Suspense,{fallback:Da,children:t&&e(_a,{teamId:t})})})}function _a({teamId:n}){const t=it(),{database:s}=S(),[a,o]=d.useState(0),r=d.useMemo(()=>({presetIndex:a,setPresetIndex:o}),[a,o]),i=re(n),{teamMetadata:u}=i,{params:{characterKey:l}}=dn({path:"/teams/:teamId/:characterKey",end:!1})??{params:{}},c=d.useMemo(()=>{const f=u.findIndex(x=>x&&x.characterKey===l);return f===-1?0:f},[u,l]),p=d.useMemo(()=>u[c],[u,c]),C=p==null?void 0:p.characterKey;C&&C!==l&&t(`${C}`,{replace:!0});const{t:v}=V(["charNames_gen","page_character"]);Gn(d.useMemo(()=>{const f=v(C?"charNames_gen:Character":"Team Settings");return`${i.name} - ${f}`},[C,v,i.name]));const g=d.useMemo(()=>({teamId:n,team:i}),[i,n]),b=d.useMemo(()=>{const f=i.teamMetadata.filter(ot).map(({characterKey:y})=>y);C&&un(f,C);const x=ht(f,y=>e(ss,{genderedKey:gt(y)}));return{srcDisplay:x,dstDisplay:x}},[i.teamMetadata,C]),P=d.useMemo(()=>i.conditionals.map(({sheet:f,src:x,dst:y,condKey:F,condValues:L})=>({sheet:f,src:x,dst:y,condKey:F,condValue:L[a]})),[a,i.conditionals]),T=d.useCallback((f,x,y,F,L)=>{!hn(f)||!qe(y)||!(F===null||qe(F))||!pn(f,x)||s.teams.setConditional(n,f,x,y,F,L,a)},[s.teams,a,n]),j=d.useMemo(()=>({src:C,dst:C,preset:`preset${a}`}),[C,a]),[w,z]=d.useState(),D=d.useMemo(()=>({read:w,setRead:z}),[w]),{height:A,ref:_}=Vn();return e(Ce.Provider,{value:g,children:e(es.Provider,{value:j,children:e(ie.Provider,{value:r,children:e(js,{teamId:n,children:e(Un.Provider,{value:b,children:e(Jn.Provider,{value:P,children:e(Xn.Provider,{value:T,children:h(Ct.Provider,{value:D,children:[e(Qn,{}),h(m,{sx:{display:"flex",gap:1,flexDirection:"column",mx:1,mt:2},children:[e(Xs,{headerRef:_,teamId:n,characterKey:C}),e(Mt.Provider,{value:(A||St)+kt,children:p&&e(yt.Provider,{value:p,children:e(La,{})})})]})]})})})})})})})})}function La(){const{characterKey:n}=B(),t=bt(n);return t?e(fn.Provider,{value:t,children:e(mn,{children:e(Ae,{path:":characterKey",children:e(Ae,{path:"*",index:!0,element:e(Ta,{})})})})}):e(mt,{variant:"rectangular",width:"100%",height:1e3})}export{Za as default};
