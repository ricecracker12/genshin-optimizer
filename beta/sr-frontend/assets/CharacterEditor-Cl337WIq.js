import{c8 as le,r as m,c9 as ce,ca as ue,j as de,cb as V,d as pe,cc as me,cd as I,ce as _,cf as fe,cg as he,ch as ge,ci as ve,b7 as Ce,cj as xe,ck as M,s as be,u as ke,V as D,aj as Be,a5 as b,p as s,aJ as ye,cl as je,q as c,a6 as Se,as as _e,z as $,B as k,T as p,cm as De,t as Ee,D as F,w as z,a9 as Pe,E as Ie,i as N,k as G,l as H,m as U,A as Me,a1 as Te,cn as Oe,ad as g,y as T}from"./index-CzaaALQO.js";import{M as W,D as J,c as h,C as Q,d as X,a as Ae,E as Re,b as we,S as Le}from"./StatDisplay-f8Qj48Jl.js";import{C as qe,c as Ve,b as B,P as $e,a as O}from"./UploadCard-CItar7zI.js";import{C as Fe}from"./CardActionArea-CpMAMzRa.js";import{C as Y,G as d}from"./ReadOnlyTextArea-BQTHz8Do.js";const ze=["component","direction","spacing","divider","children","className","useFlexGap"],Ne=xe(),Ge=le("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root});function He(t){return me({props:t,name:"MuiStack",defaultTheme:Ne})}function Ue(t,e){const o=m.Children.toArray(t).filter(Boolean);return o.reduce((n,r,a)=>(n.push(r),a<o.length-1&&n.push(m.cloneElement(e,{key:`separator-${a}`})),n),[])}const We=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],Je=({ownerState:t,theme:e})=>{let o=V({display:"flex",flexDirection:"column"},I({theme:e},_({values:t.direction,breakpoints:e.breakpoints.values}),n=>({flexDirection:n})));if(t.spacing){const n=fe(e),r=Object.keys(e.breakpoints.values).reduce((l,u)=>((typeof t.spacing=="object"&&t.spacing[u]!=null||typeof t.direction=="object"&&t.direction[u]!=null)&&(l[u]=!0),l),{}),a=_({values:t.direction,base:r}),i=_({values:t.spacing,base:r});typeof a=="object"&&Object.keys(a).forEach((l,u,y)=>{if(!a[l]){const S=u>0?a[y[u-1]]:"column";a[l]=S}}),o=he(o,I({theme:e},i,(l,u)=>t.useFlexGap?{gap:M(n,l)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${We(u?a[u]:t.direction)}`]:M(n,l)}}))}return o=ge(e.breakpoints,o),o};function Qe(t={}){const{createStyledComponent:e=Ge,useThemeProps:o=He,componentName:n="MuiStack"}=t,r=()=>ve({root:["root"]},l=>Ce(n,l),{}),a=e(Je);return m.forwardRef(function(l,u){const y=o(l),j=ce(y),{component:S="div",direction:te="column",spacing:se=0,divider:E,children:P,className:ne,useFlexGap:oe=!1}=j,re=ue(j,ze),ae={direction:te,spacing:se,useFlexGap:oe},ie=r();return de.jsx(a,V({as:S,ownerState:ae,ref:u,className:pe(ie.root,ne)},re,{children:E?Ue(P,E):P}))})}const Z=Qe({createStyledComponent:be("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root}),useThemeProps:t=>ke({props:t,name:"MuiStack"})});function K(t){const{database:e}=D();return Be(e.chars,t)}function ee(t){return b.char[t]}function dt(t,e,o,n=0){switch(e){case"eidolon":return Object.fromEntries(b.char[t].rankMap[o].params.map((r,a)=>[a+1,r]));case"basic":case"skill":case"ult":case"talent":case"technique":return Object.fromEntries(b.char[t].skillTree[e].skillParamList[n].map((r,a)=>[a+1,r[o]]));case"bonusAbility1":case"bonusAbility2":case"bonusAbility3":return Object.fromEntries(b.char[t].skillTree[e].skillParamList[n][o].map((r,a)=>[a+1,r]))}}function Xe(t,e){const n=Ye(t,e).levels;if(!(n!=null&&n.length))throw new Error(`No stat boost levels found for character ${t}`);const r=Object.entries(n[0].stats??{});if(!r.length)throw new Error(`No stats found in stat boost for character ${t}`);const[a,i]=r[0];return{statKey:a,value:i}}function Ye(t,e){const{skillTree:o}=ee(t);return o[`statBoost${e}`]}function x({characterKey:t,abilityKey:e,dropDownButtonProps:o={}}){const n=K(t),{database:r}=D(),a=e.charAt(0).toUpperCase()+e.slice(1);return s(J,{title:`${a} Lv. ${(n==null?void 0:n[e])??1}`,disabled:!n,...o,children:!!t&&ye(1,je[e][(n==null?void 0:n.ascension)??0]).map(i=>c(W,{selected:(n==null?void 0:n[e])===i,disabled:(n==null?void 0:n[e])===i,onClick:()=>r.chars.set(t,{[e]:i}),children:[a," Lv. ",i]},`${e}_${i}`))})}function Ze(){const t=m.useContext(qe),e=m.useContext(Ve);return m.useMemo(()=>t==null?void 0:t.withTag(e),[t,e])}const Ke=["hp","atk","def","spd","crit_","crit_dmg_","brEffect_","heal_","enerRegen_","eff_","eff_res_"];function pt({character:t,onClick:e,hideStats:o=!1}){const n=Ze()??Se(_e(t,1));return s(Z,{children:c($,{children:[e?s(Fe,{onClick:e,children:s(A,{character:t})}):s(A,{character:t}),s(B,{}),!o&&s(Y,{children:Ke.map(r=>s(et,{calc:n,statKey:r,characterKey:t.key},r))})]})})}function A({character:t}){const{key:e,eidolon:o,level:n,ascension:r}=t,a=X(e),{damageType:i,path:f,rarity:l}=ee(e);return c(k,{sx:{display:"flex"},children:[s(k,{component:"img",alt:"Character Icon",src:h(a,"icon"),sx:{maxHeight:"10em",width:"auto"}}),c(k,{sx:{px:2,pt:1},children:[s(p,{variant:"h5",children:s(Q,{genderedKey:a})}),s(p,{children:s(Ae,{stars:l,inline:!0})}),c(p,{children:["Lv.",De(n,r)," Eidolon: ",o]}),s($e,{pathKey:f}),s(Ee,{color:i,children:s(Re,{ele:i})})]})]})}function et({characterKey:t,calc:e,statKey:o}){return c(p,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[s(we,{statKey:o}),c("span",{children:[F(e.withTag({src:t,dst:t}).compute(Pe.final[o]).val,o).toFixed(Ie(o)),z(o)]})]})}var v={},R;function tt(){if(R)return v;R=1;var t=N();Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var e=t(G()),o=H(),n=(0,e.default)((0,o.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");return v.default=n,v}var st=tt();const w=U(st);var C={},L;function nt(){if(L)return C;L=1;var t=N();Object.defineProperty(C,"__esModule",{value:!0}),C.default=void 0;var e=t(G()),o=H(),n=(0,e.default)((0,o.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");return C.default=n,C}var ot=nt();const q=U(ot);function mt({characterKey:t,onClose:e}){return s(Te,{open:!!t,onClose:e,children:s(m.Suspense,{fallback:s(Me,{variant:"rectangular",width:"100%",height:1e3}),children:t&&s(rt,{characterKey:t})})})}function rt({characterKey:t}){const e=K(t),o=X(t),{database:n}=D();return s($,{children:c(Y,{sx:{display:"flex",flexDirection:"column",gap:1},children:[s(p,{variant:"h3",children:s(Q,{genderedKey:o})}),s(O,{type:"number",label:"Level",variant:"outlined",inputProps:{min:1,max:90},value:(e==null?void 0:e.level)||0,onChange:r=>n.chars.set(t,{level:parseInt(r.target.value)}),disabled:!e}),s(O,{type:"number",label:"Ascension",variant:"outlined",inputProps:{min:0,max:6},value:(e==null?void 0:e.ascension)||0,onChange:r=>n.chars.set(t,{ascension:parseInt(r.target.value)}),disabled:!e}),s(J,{title:`Eidolon Lv. ${(e==null?void 0:e.eidolon)??0}`,fullWidth:!1,disabled:!e,children:Oe.map(r=>c(W,{selected:(e==null?void 0:e.eidolon)===r,disabled:(e==null?void 0:e.eidolon)===r,onClick:()=>n.chars.set(t,{eidolon:r}),children:["Eidolon Lv. ",r]},r))}),c(Z,{spacing:1,children:[s(p,{variant:"h6",children:"Abilites"}),s(B,{}),c(d,{container:!0,gap:1,children:[s(d,{item:!0,children:s(x,{characterKey:t,abilityKey:"basic",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(o,"basic_0")})}})}),s(d,{item:!0,children:s(x,{characterKey:t,abilityKey:"skill",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(o,"skill_0")})}})}),s(d,{item:!0,children:s(x,{characterKey:t,abilityKey:"ult",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(o,"ult_0")})}})}),s(d,{item:!0,children:s(x,{characterKey:t,abilityKey:"talent",dropDownButtonProps:{startIcon:s(g,{size:1.5,sideMargin:!0,src:h(o,"talent_0")})}})})]}),s(p,{variant:"h6",children:"Bonus Abilities"}),s(B,{}),s(d,{container:!0,gap:1,children:Object.entries((e==null?void 0:e.bonusAbilities)??{}).map(([r,a])=>s(d,{item:!0,children:s(T,{color:a?"success":"primary",onClick:()=>{n.chars.set(t,{bonusAbilities:{...e==null?void 0:e.bonusAbilities,[r]:!a}})},startIcon:a?s(w,{}):s(q,{}),children:s(g,{size:2,src:h(o,`bonusAbility${r}`),sideMargin:!0})})},r))}),s(p,{variant:"h6",children:"Stat Boosts"}),s(B,{}),s(d,{container:!0,gap:1,children:Object.entries((e==null?void 0:e.statBoosts)??{}).map(([r,a])=>{const{statKey:i,value:f}=Xe(t,r);return s(d,{item:!0,children:c(T,{color:a?"success":"primary",onClick:()=>{n.chars.set(t,{statBoosts:{...e==null?void 0:e.statBoosts,[r]:!a}})},startIcon:a?s(w,{}):s(q,{}),children:[s(Le,{statKey:i,iconProps:{sx:{ml:-1,mr:.5}}}),c(k,{children:[F(f,i),z(i)]})]})},r)})})]})]})})}export{mt as C,Z as S,pt as a,Ze as b,w as c,q as d,Qe as e,dt as f,ee as g,K as u};
