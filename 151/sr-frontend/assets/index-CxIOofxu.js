import{g as Ne,a as Te,c as E,j as R,r as y,u as We,_ as Ue,b as $,I as de,s as ee,d as Ge,e as re,f as He,P as Fe,h as X,i as V,k as Q,l as Z,m as J,n as N,o as Ee,p as e,q as d,B as b,S as Ve,C as Qe,T as K,t as Ze,v as Le,w as F,x as me,y as A,z,A as Y,D as se,E as Je,F as Xe,G as Ye,H as et,J as Ae,K as tt,L as rt,M as st,N as ge,O as at,Q as ot,R as je,U as nt,V as _e,W as lt,X as it,Y as ct,Z as dt,$ as ut,a0 as pt,a1 as ht,a2 as ft,a3 as mt,a4 as gt}from"./index-D_KdNCma.js";import{T as vt,a as xt}from"./UploadCard-DrUgBsq7.js";import{C as ue,G as w,u as ve}from"./ReadOnlyTextArea-CiQGqQ-S.js";import{S as ae,a as yt,r as bt,b as oe,D as De,M as ne,u as St}from"./StatDisplay-DPerOdYy.js";import{u as xe,R as Ct,S as le,a as Rt,b as kt}from"./RelicSetAutocomplete-CrsIS3oU.js";import{L as It,a as Mt,b as wt,E as Kt,A as ie}from"./Add-CBs9zR05.js";import{C as Lt,D as At,L as ze,a as jt,b as _t}from"./BusinessCenter-CNj9GA9H.js";import{R as Dt,a as zt,D as Pt}from"./RelicRarityDropdown-BJh8Jzb6.js";import{L as Pe}from"./LocationAutocomplete-2Rx85AnS.js";import{C as $t}from"./CardHeader-Dy7dqQfR.js";import{u as Ot,a as Bt}from"./useMediaQueryUp-0UqUwccG.js";function qt(t){return Te("MuiAlert",t)}const ye=Ne("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),Nt=E(R.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),Tt=E(R.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),Wt=E(R.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),Ut=E(R.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),Gt=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],Ht=t=>{const{variant:a,color:l,severity:s,classes:p}=t,i={root:["root",`color${re(l||s)}`,`${a}${re(l||s)}`,`${a}`],icon:["icon"],message:["message"],action:["action"]};return He(i,qt,p)},Ft=ee(Fe,{name:"MuiAlert",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:l}=t;return[a.root,a[l.variant],a[`${l.variant}${re(l.color||l.severity)}`]]}})(({theme:t})=>{const a=t.palette.mode==="light"?X.darken:X.lighten,l=t.palette.mode==="light"?X.lighten:X.darken;return $({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(([,s])=>s.main&&s.light).map(([s])=>({props:{colorSeverity:s,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${s}Color`]:a(t.palette[s].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${s}StandardBg`]:l(t.palette[s].light,.9),[`& .${ye.icon}`]:t.vars?{color:t.vars.palette.Alert[`${s}IconColor`]}:{color:t.palette[s].main}}})),...Object.entries(t.palette).filter(([,s])=>s.main&&s.light).map(([s])=>({props:{colorSeverity:s,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${s}Color`]:a(t.palette[s].light,.6),border:`1px solid ${(t.vars||t).palette[s].light}`,[`& .${ye.icon}`]:t.vars?{color:t.vars.palette.Alert[`${s}IconColor`]}:{color:t.palette[s].main}}})),...Object.entries(t.palette).filter(([,s])=>s.main&&s.dark).map(([s])=>({props:{colorSeverity:s,variant:"filled"},style:$({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${s}FilledColor`],backgroundColor:t.vars.palette.Alert[`${s}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[s].dark:t.palette[s].main,color:t.palette.getContrastText(t.palette[s].main)})}))]})}),Et=ee("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,a)=>a.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),Vt=ee("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,a)=>a.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),be=ee("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,a)=>a.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),Se={success:R.jsx(Nt,{fontSize:"inherit"}),warning:R.jsx(Tt,{fontSize:"inherit"}),error:R.jsx(Wt,{fontSize:"inherit"}),info:R.jsx(Ut,{fontSize:"inherit"})},Qt=y.forwardRef(function(a,l){const s=We({props:a,name:"MuiAlert"}),{action:p,children:i,className:n,closeText:h="Close",color:x,components:f={},componentsProps:r={},icon:m,iconMapping:u=Se,onClose:g,role:j="alert",severity:k="success",slotProps:c={},slots:v={},variant:P="standard"}=s,_=Ue(s,Gt),S=$({},s,{color:x,severity:k,variant:P,colorSeverity:x||k}),C=Ht(S),I={slots:$({closeButton:f.CloseButton,closeIcon:f.CloseIcon},v),slotProps:$({},r,c)},[L,D]=xe("closeButton",{elementType:de,externalForwardedProps:I,ownerState:S}),[te,O]=xe("closeIcon",{elementType:Lt,externalForwardedProps:I,ownerState:S});return R.jsxs(Ft,$({role:j,elevation:0,ownerState:S,className:Ge(C.root,n),ref:l},_,{children:[m!==!1?R.jsx(Et,{ownerState:S,className:C.icon,children:m||u[k]||Se[k]}):null,R.jsx(Vt,{ownerState:S,className:C.message,children:i}),p!=null?R.jsx(be,{ownerState:S,className:C.action,children:p}):null,p==null&&g?R.jsx(be,{ownerState:S,className:C.action,children:R.jsx(L,$({size:"small","aria-label":h,title:h,color:"inherit",onClick:g},D,{children:R.jsx(te,$({fontSize:"small"},O))}))}):null]}))});var T={},Ce;function Zt(){if(Ce)return T;Ce=1;var t=V();Object.defineProperty(T,"__esModule",{value:!0}),T.default=void 0;var a=t(Q()),l=Z(),s=(0,a.default)((0,l.jsx)("path",{d:"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}),"Replay");return T.default=s,T}var Jt=Zt();const Xt=J(Jt),Yt=E(R.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8 0-1.85.63-3.55 1.69-4.9L16.9 18.31C15.55 19.37 13.85 20 12 20zm6.31-3.1L7.1 5.69C8.45 4.63 10.15 4 12 4c4.42 0 8 3.58 8 8 0 1.85-.63 3.55-1.69 4.9z"}),"DoNotDisturb"),er=t=>"roll"+(Math.floor(Math.max(t,0)/3)+1);function ce({relic:t,onClick:a,onEdit:l,onDelete:s,onLockToggle:p,setLocation:i,mainStatAssumptionLevel:n=0,extraButtons:h,excluded:x=!1}){const{t:f}=N("relic"),{t:r}=N(["relics_gen","statKey_gen"]),{lock:m,slotKey:u,setKey:g,rarity:j,level:k,mainStatKey:c,substats:v,location:P=""}=t,_=Math.max(Math.min(n,j*3),k),S=Ee.find(C=>c.startsWith(C));return e(y.Suspense,{fallback:e(Y,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:350}}),children:d(z,{bgt:"light",sx:{height:"100%",display:"flex",flexDirection:"column"},children:[d(b,{className:`grad-${j}star`,sx:{position:"relative",width:"100%"},children:[!a&&!!p&&e(de,{color:"primary",onClick:p,sx:{position:"absolute",right:0,bottom:0,zIndex:2},children:m?e(It,{}):e(Mt,{})}),x&&e(Ve,{color:"primary",fontSize:"large",sx:{position:"absolute",right:3,bottom:3,zIndex:2},children:e(Yt,{})}),d(b,{sx:{pt:2,px:2,position:"relative",zIndex:1},children:[d(b,{component:"div",sx:{display:"flex",alignItems:"center",gap:.4,mb:1},children:[e(Qe,{size:"small",label:e("strong",{children:`+${k}`}),color:er(k)}),e(K,{noWrap:!0,sx:{textAlign:"center",backgroundColor:"rgba(100,100,100,0.35)",borderRadius:"1em",px:1.5},children:e("strong",{children:g&&e(Ct,{setKey:g})||"Relic Set"})})]}),d(K,{color:"text.secondary",variant:"body2",sx:{display:"flex",gap:.5,alignItems:"center"},children:[e(le,{iconProps:{fontSize:"inherit"},slotKey:u}),r(`relics_gen:${u}`)]}),d(K,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:[e(ae,{statKey:c,iconProps:{sx:{color:`${S}.main`}}}),e("span",{children:r(`statKey_gen:${c}`)})]}),e(K,{variant:"h5",children:e("strong",{children:d(Ze,{color:_!==k?"warning":void 0,children:[Le(j,c,k),F(c)]})})}),e(yt,{stars:j,colored:!0})]}),e(b,{sx:{height:"100%",position:"absolute",right:0,top:0},children:e(b,{component:"img",alt:"Relic Piece Image",src:bt(g,u),sx:{width:"auto",height:"90%",float:"right",marginBottom:"5%",marginTop:"5%",marginRight:"10%"}})})]}),d(ue,{sx:{flexGrow:1,display:"flex",flexDirection:"column",pt:1,pb:"0!important",width:"100%"},children:[v.map(C=>C.key&&e(tr,{substat:C},C.key)),e(b,{flexGrow:1}),e(K,{color:"success.main"})]}),d(b,{sx:{p:1,display:"flex",gap:1,justifyContent:"space-between",alignItems:"center"},children:[e(b,{sx:{flexGrow:1},children:i?e(Pe,{locKey:P,setLocKey:i}):e(wt,{location:P})}),d(b,{display:"flex",gap:1,alignItems:"stretch",height:"100%",sx:{"& .MuiButton-root":{minWidth:0,height:"100%"}},children:[!!l&&e(me,{title:e(K,{children:f("edit")}),placement:"top",arrow:!0,children:e(A,{color:"info",size:"small",onClick:l,children:e(Kt,{})})}),!!s&&e(me,{title:m?f("cantDeleteLock"):"",placement:"top",children:e("span",{children:e(A,{color:"error",size:"small",onClick:s,disabled:m,sx:{top:"1px"},children:e(At,{})})})}),h]})]})]})})}function tr({substat:t}){const{key:a,value:l}=t;if(!l||!a)return null;const s=se(l,a).toFixed(Je(a));return d(K,{sx:{display:"flex",alignItems:"center"},children:[e(oe,{statKey:a}),d("span",{children:["+",s,F(a)]})]})}var W={},Re;function rr(){if(Re)return W;Re=1;var t=V();Object.defineProperty(W,"__esModule",{value:!0}),W.default=void 0;var a=t(Q()),l=Z(),s=(0,a.default)((0,l.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight");return W.default=s,W}var sr=rr();const ar=J(sr);var U={},ke;function or(){if(ke)return U;ke=1;var t=V();Object.defineProperty(U,"__esModule",{value:!0}),U.default=void 0;var a=t(Q()),l=Z(),s=(0,a.default)((0,l.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"}),"Lock");return U.default=s,U}var nr=or();const lr=J(nr);var G={},Ie;function ir(){if(Ie)return G;Ie=1;var t=V();Object.defineProperty(G,"__esModule",{value:!0}),G.default=void 0;var a=t(Q()),l=Z(),s=(0,a.default)((0,l.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z"}),"LockOpen");return G.default=s,G}var cr=ir();const dr=J(cr);var H={},Me;function ur(){if(Me)return H;Me=1;var t=V();Object.defineProperty(H,"__esModule",{value:!0}),H.default=void 0;var a=t(Q()),l=Z(),s=(0,a.default)((0,l.jsx)("path",{d:"M21 10.12h-6.78l2.74-2.82c-2.73-2.7-7.15-2.8-9.88-.1-2.73 2.71-2.73 7.08 0 9.79s7.15 2.71 9.88 0C18.32 15.65 19 14.08 19 12.1h2c0 1.98-.88 4.55-2.64 6.29-3.51 3.48-9.21 3.48-12.72 0-3.5-3.47-3.53-9.11-.02-12.58s9.14-3.47 12.65 0L21 3v7.12zM12.5 8v4.25l3.5 2.08-.72 1.21L11 13V8h1.5z"}),"Update");return H.default=s,H}var pr=ur();const hr=J(pr);function fr({index:t,relic:a,setSubstat:l}){const{t:s}=N("relic"),{mainStatKey:p="",rarity:i=5}=a??{},{key:n="",value:h=0,rolls:x=[],efficiency:f=0}=(a==null?void 0:a.substats[t])??{},r=x.length;let m="",u=[],g=0;if(a){const c=a.rarity,{numUpgrades:v,high:P}=Xe[c];g=v+P-3-r,u=n?Ye(n,c):[]}const j=7-u.length;g<0&&(m=m||s("editor.substat.error.noOverRoll",{value:g+r}));const k=y.useMemo(()=>n?[{value:0},...et(i,n).map(c=>({value:c}))]:[{value:0}],[n,i]);return d(z,{bgt:"light",children:[e(b,{sx:{display:"flex"},children:d(Ae,{size:"small",sx:{width:"100%",display:"flex"},children:[d(De,{startIcon:n?e(ae,{statKey:n}):void 0,title:n?e(oe,{statKey:n,showPercent:!0,disableIcon:!0}):s("editor.substat.substatFormat",{value:t+1}),disabled:!a,color:n?"success":"primary",sx:{whiteSpace:"nowrap"},children:[n&&e(ne,{onClick:()=>l(t,{key:"",value:0}),children:s("editor.substat.noSubstat")}),tt.filter(c=>p!==c).map(c=>d(ne,{selected:n===c,disabled:n===c,onClick:()=>l(t,{key:c,value:0}),children:[e(ze,{children:e(ae,{statKey:c})}),e(jt,{children:e(oe,{statKey:c,showPercent:!0,disableIcon:!0})})]},c))]}),e(rt,{sx:{flexBasis:30,flexGrow:1},children:e(st,{float:F(n)==="%",placeholder:s("editor.substat.selectSub"),value:n?ge(se(h,n),n):void 0,onChange:c=>{let v=c??0;F(n)==="%"&&(v=v/100),l(t,{key:n,value:v})},disabled:!n,error:!!m,sx:{px:1},inputProps:{sx:{textAlign:"right"}}})}),!!u.length&&e(at,{children:s("editor.substat.nextRolls")})]})}),e(b,{px:2,children:e(mr,{value:ge(se(h,n),n),marks:k,setValue:c=>{let v=c??0;F(n)==="%"&&(v=v/100),l(t,{key:n,value:v})},disabled:!n})}),e(b,{sx:{px:1,pb:1},children:m?e(ot,{color:"error",children:s("ui:error")}):d(w,{container:!0,children:[e(w,{item:!0,flexGrow:1,children:!!x.length&&[...x].sort().map((c,v)=>e(K,{component:"span",color:`roll${je(j+u.indexOf(c),1,6)}.main`,sx:{ml:1},children:c},`${v}.${c}`))}),e(w,{item:!0,xs:"auto",flexShrink:1,children:e(K,{children:d(vt,{t:s,i18nKey:"editor.substat.eff",color:"text.secondary",children:["Efficiency: ",f]})})})]})})]})}function mr({value:t,setValue:a,marks:l,disabled:s=!1}){var n,h;const[p,i]=y.useState(t);return y.useEffect(()=>i(t),[t]),e(Rt,{value:p,step:.1,disabled:s,min:((n=l[1])==null?void 0:n.value)??0,max:((h=l[l.length-1])==null?void 0:h.value)??0,onChange:(x,f)=>i(f),onChangeCommitted:(x,f)=>a(f),valueLabelDisplay:"auto"})}function gr(t,a){const s=(()=>{switch(a.type){case"reset":return;case"substat":{const{index:p,substat:i}=a,n=[...t.substats],h=i.key?n.findIndex(x=>x.key===i.key):-1;if(h===-1||h===p)n[p]={...i};else{const x=n[p];n[p]={...n[h]},n[h]={...x}}return{...t,substats:n}}case"overwrite":return a.relic;case"update":return{...t,...a.relic}}})();return s&&nt(s,!0,!1)}const we={rarity:[5,4,3,2],setEffects:{}};function vr({relicIdToEdit:t="new",cancelEdit:a,fixedSlotKey:l,allowEmpty:s=!1,disableSet:p=!1}){const{t:i}=N("relic"),{t:n}=N(["relics_gen","statKey_gen"]),{database:h}=_e(),[x,f]=y.useState(!1),[r,m]=y.useReducer(gr,void 0),u=lt(t==="new"?void 0:t);ve(t)!==t&&t==="new"&&(f(!0),m({type:"reset"})),ve(u)!==u&&u&&(f(!0),m({type:"overwrite",relic:it(u)}));const{relic:g,errors:j}=y.useMemo(()=>r?ct(r,t):{relic:void 0,errors:[]},[r,t]),k=St(h.relics),{prev:c,prevEditType:v}=y.useMemo(()=>{if(u)return{prev:u,prevEditType:"edit"};if(r===void 0)return{prev:void 0,prevEditType:""};const{duplicated:o,upgraded:M}=k&&h.relics.findDups(r);return{prev:o[0]??M[0],prevEditType:o.length!==0?"duplicate":"upgrade"}},[u,r,k,h.relics]),P=!["new",""].includes(t)&&!!(r!=null&&r.location)||!!l||!!t&&t!=="new",{rarity:_=5,level:S=0}=r??{},C=y.useMemo(()=>(r==null?void 0:r.slotKey)??l??"head",[l,r]),I=r?we:void 0,L=y.useCallback(o=>{const M=o.setKey?we:I;function B(q,fe,qe){return q&&fe.includes(q)?q:qe??fe[0]}o.setKey&&(o.rarity=B(r==null?void 0:r.rarity,M.rarity,Math.max(...M.rarity)),o.slotKey=B(r==null?void 0:r.slotKey,["head","hands"])),o.rarity&&(o.level=(r==null?void 0:r.level)??0),o.level&&(o.level=je(o.level,0,3*(o.rarity??r.rarity))),o.slotKey&&(o.mainStatKey=B(r==null?void 0:r.mainStatKey,dt[o.slotKey])),o.mainStatKey&&(o.substats=[0,1,2,3].map(q=>r&&r.substats[q].key!==o.mainStatKey?r.substats[q]:{key:"",value:0})),m({type:"update",relic:o})},[r,I,m]),D=y.useCallback(()=>{a==null||a(),m({type:"reset"})},[a,m]),te=y.useCallback((o,M)=>m({type:"substat",index:o,substat:M}),[]),O=!j.length,pe=y.useCallback(o=>{if(!t&&r&&!window.confirm(i("editor.clearPrompt"))){o==null||o.preventDefault();return}f(!1),D()},[i,t,r,f,D]),$e=ut(),Oe=pt($e.breakpoints.up("md")),he=t!=="new"&&t||(c==null?void 0:c.id),Be=()=>window.confirm(i("editor.clearPrompt"));return e(y.Suspense,{fallback:!1,children:e(ht,{open:x,onClose:pe,children:d(z,{bgt:"dark",children:[e($t,{title:"Relic Editor",action:e(de,{onClick:pe,children:e(_t,{})})}),d(ue,{sx:{display:"flex",flexDirection:"column",gap:1},children:[d(w,{container:!0,spacing:1,columns:{xs:1,md:2},children:[d(w,{item:!0,xs:1,display:"flex",flexDirection:"column",gap:1,children:[d(b,{sx:{display:"flex",gap:1},children:[e(kt,{disabled:p,size:"small",relicSetKey:(r==null?void 0:r.setKey)??"",setRelicSetKey:o=>L({setKey:o}),sx:{flexGrow:1},label:r!=null&&r.setKey?"":i("editor.unknownSetName")}),e(Dt,{rarity:r?_:void 0,onRarityChange:o=>L({rarity:o}),filter:o=>{var M,B;return!!((B=(M=I==null?void 0:I.rarity)==null?void 0:M.includes)!=null&&B.call(M,o))},disabled:!I})]}),d(b,{component:"div",display:"flex",children:[e(xt,{label:"Level",variant:"filled",sx:{flexShrink:1,flexGrow:1,mr:1,my:0},margin:"dense",size:"small",value:S,disabled:!I,onChange:o=>{const M=parseInt(o.target.value)||0;L({level:M})}}),d(Ae,{children:[e(A,{onClick:()=>L({level:S-1}),disabled:!I||S===0,children:"-"}),_?[...Array(_+1).keys()].map(o=>3*o).map(o=>e(A,{onClick:()=>L({level:o}),disabled:!I||S===o,children:o},o)):null,e(A,{onClick:()=>L({level:S+1}),disabled:!I||S===_*3,children:"+"})]})]}),d(b,{component:"div",display:"flex",children:[e(De,{startIcon:r!=null&&r.slotKey?e(le,{slotKey:r.slotKey}):void 0,title:r?n(r.slotKey):i("slot"),value:C,disabled:P||!I,color:r?"success":"primary",children:ft.map(o=>d(ne,{selected:C===o,disabled:C===o,onClick:()=>L({slotKey:o}),children:[e(ze,{children:e(le,{slotKey:o})}),n(o)]},o))}),e(z,{bgt:"light",sx:{p:1,ml:1,flexGrow:1},children:e(y.Suspense,{fallback:e(Y,{width:"60%"}),children:e(K,{color:"text.secondary",children:n(`relics_gen:${C}`)})})})]}),d(b,{component:"div",display:"flex",gap:1,children:[e(zt,{slotKey:C,statKey:r==null?void 0:r.mainStatKey,setStatKey:o=>L({mainStatKey:o}),defText:i("mainStat"),dropdownButtonProps:{disabled:!I,color:r?"success":"primary"}}),e(z,{bgt:"light",sx:{p:1,flexGrow:1},children:e(K,{color:"text.secondary",children:r?Le(_,r.mainStatKey,S):i("mainStat")})}),e(A,{onClick:()=>L({lock:!(r!=null&&r.lock)}),color:r!=null&&r.lock?"success":"primary",disabled:!r,children:r!=null&&r.lock?e(lr,{}):e(dr,{})})]}),e(Pe,{locKey:(g==null?void 0:g.location)??"",setLocKey:o=>L({location:o})})]}),e(w,{item:!0,xs:1,display:"flex",flexDirection:"column",gap:1,children:[0,1,2,3].map(o=>e(fr,{index:o,relic:g,setSubstat:te},o))})]}),c&&d(w,{container:!0,sx:{justifyContent:"space-around"},spacing:1,children:[e(w,{item:!0,xs:12,md:5.5,lg:4,children:d(z,{bgt:"light",children:[e(K,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:i(v!=="edit"?v==="duplicate"?"editor.dupeRelic":"editor.updateRelic":"editor.beforeEdit")}),e(ce,{relic:c})]})}),Oe&&e(w,{item:!0,md:1,display:"flex",alignItems:"center",justifyContent:"center",children:e(z,{bgt:"light",sx:{display:"flex"},children:e(ar,{sx:{fontSize:40}})})}),e(w,{item:!0,xs:12,md:5.5,lg:4,children:d(z,{bgt:"light",children:[e(K,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:i("editor.preview")}),g&&e(ce,{relic:g})]})})]}),!O&&e(Qt,{variant:"filled",severity:"error",children:j.map((o,M)=>e("div",{children:o},M))}),d(b,{display:"flex",gap:2,children:[v==="edit"?e(A,{startIcon:e(ie,{}),onClick:()=>{r&&h.relics.set(c.id,r),s||(f(!1),a()),D()},disabled:!r||!O,color:"primary",children:i("editor.btnSave")}):e(A,{startIcon:e(ie,{}),onClick:()=>{h.relics.new(r),s||(f(!1),a()),D()},disabled:!r||!O,color:v==="duplicate"?"warning":"primary",children:i("editor.btnAdd")}),s&&e(A,{startIcon:e(Xt,{}),disabled:!r,onClick:()=>{Be()&&D()},color:"error",children:i("editor.btnClear")}),c&&v!=="edit"&&e(A,{startIcon:e(hr,{}),onClick:()=>{r&&h.relics.set(c.id,r),D(),s||f(!1)},disabled:!r||!O,color:"success",children:i("editor.btnUpdate")}),!!he&&e(A,{startIcon:e(Pt,{}),onClick:()=>{window.confirm(i("editor.confirmDelete"))&&(h.relics.remove(he),D(),s||f(!1))},disabled:!r||!O,color:"error",children:i("editor.delete")})]})]})]})})})}const Ke={xs:1,sm:2,md:3,lg:3,xl:4},xr={xs:10,sm:12,md:24,lg:24,xl:24};function yr({onAdd:t,onEdit:a}){const{t:l}=N("relic"),{database:s}=_e(),p=mt(s.relics),i=p.length,n=Ot(),h=p.length!==i?`${p.length}/${i}`:i,{numShow:x,setTriggerElement:f}=Bt(xr[n],p.length),r=y.useMemo(()=>p.slice(0,x),[p,x]),m={numShowing:r.length,totalShowing:h};return d(gt,{children:[e(z,{bgt:"dark",children:e(ue,{children:e(b,{pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:d(K,{color:"text.secondary",children:["Showing ",e("b",{children:m.numShowing})," out of"," ",m.totalShowing," Items"]})})})}),e(w,{container:!0,columns:Ke,spacing:1,children:e(w,{item:!0,xs:!0,children:e(A,{fullWidth:!0,onClick:t,color:"info",startIcon:e(ie,{}),children:l("addNew")})})}),d(y.Suspense,{fallback:e(Y,{variant:"rectangular",sx:{width:"100%",height:"100%",minHeight:5e3}}),children:[e(w,{container:!0,columns:Ke,spacing:1,children:r.map(u=>e(w,{item:!0,xs:1,children:e(ce,{relic:s.relics.get(u),onEdit:()=>a==null?void 0:a(u),onDelete:()=>s.relics.remove(u),setLocation:g=>s.relics.set(u,{location:g}),onLockToggle:()=>s.relics.set(u,({lock:g})=>({lock:!g}))})},u))}),p.length!==r.length&&e(Y,{ref:u=>{u&&f(u)},sx:{borderRadius:1},variant:"rectangular",width:"100%",height:100})]})]})}function jr(){const[t,a]=y.useState("");return d(b,{display:"flex",flexDirection:"column",gap:1,my:1,children:[e(vr,{relicIdToEdit:t,cancelEdit:()=>a(""),allowEmpty:!0}),e(yr,{onAdd:()=>a("new"),onEdit:a})]})}export{jr as default};
