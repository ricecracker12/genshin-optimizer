import{a as Ye,g as Ze,r as d,_ as et,af as Et,ag as Pt,b as H,j as K,s as Se,d as tt,e as ne,f as nt,ah as wt,ai as st,c as ke,u as zt,h as Dt,V as S,aj as ue,i as Me,k as Te,l as Be,m as Re,a6 as _t,ak as Lt,al as ce,am as Ot,an as Oe,ao as jt,p as e,ap as qt,a7 as At,aq as at,ar as Nt,as as Ft,at as $t,q as h,B as m,au as Ht,w as ye,T as k,av as ot,z as M,n as V,ae as rt,$ as it,a0 as ct,aw as Kt,ad as Gt,ax as Wt,a4 as he,x as Vt,a1 as U,I as W,Q as lt,ay as Ut,y as O,az as Jt,aA as Ie,aB as Xt,aC as Qt,J as Yt,aD as Zt,aE as en,aF as dt,aG as tn,aH as ut,a2 as nn,aI as sn,a9 as Q,aJ as ht,aK as an,aL as on,aM as rn,aN as cn,A as pt,aO as ln,aP as dn,aQ as un,aR as je,aS as hn,aT as pn,aU as qe,aV as mn}from"./index-CsTkwEb4.js";import{r as fn,a as Cn,O as mt,T as gn,C as bn,N as pe,I as Ee,t as xn,L as vn,b as yn,R as Sn,c as kn,d as be,E as me,e as Mn,f as Tn,g as Bn,o as Rn,W as In,h as En,S as Pn,i as wn,j as zn,u as Dn,k as _n,l as Ln,m as Ae,n as Ne,p as Fe,q as $e,s as On,v as jn,w as qn,x as An,y as Nn,D as Fn,z as $n,A as Hn,B as Kn,F as Gn,G as Wn,H as Vn,J as Un,K as Jn,M as Xn}from"./Checkroom-wOMjKd0u.js";import{C as Qn,D as ft,b as B,a as Yn,c as Zn}from"./UploadCard-rUtAx2tH.js";import{c as es,d as Ct,M as se,D as fe,u as He,b as ts,C as ns}from"./StatDisplay-xQBSFPQU.js";import{u as gt,b as ae,S as N,g as ss,a as as,C as os}from"./CharacterEditor-B_WATID6.js";import{C as E,G as I}from"./ReadOnlyTextArea-CJfHBbDv.js";import{u as rs,a as is,g as cs}from"./LightConeTrans-aFjFmNTS.js";import{C as oe}from"./CardActionArea-C6v6jzFO.js";import{T as Ke,D as ls}from"./Delete-CrLe1oW8.js";import{b as J,D as ds}from"./BusinessCenter-1puDvPhM.js";import{C as q}from"./CardHeader-kTUtVrgD.js";import{u as X}from"./useBoolState-CpBuHcU3.js";import{R as us,b as bt,S as hs}from"./RelicSetAutocomplete-vZA75AbX.js";import{L as ps}from"./LightConeEditorCard-BZQD77ym.js";import{D as ms,R as fs,a as Cs}from"./RelicRarityDropdown-CWXUnWKY.js";import"./InfoTooltip-Bz1DfW_b.js";import"./LocationAutocomplete-3dnGCKuz.js";function gs(n){return Ye("PrivateSwitchBase",n)}Ze("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const bs=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],xs=n=>{const{classes:t,checked:s,disabled:a,edge:o}=n,r={root:["root",s&&"checked",a&&"disabled",o&&`edge${ne(o)}`],input:["input"]};return nt(r,gs,t)},vs=Se(wt)(({ownerState:n})=>H({padding:9,borderRadius:"50%"},n.edge==="start"&&{marginLeft:n.size==="small"?-3:-12},n.edge==="end"&&{marginRight:n.size==="small"?-3:-12})),ys=Se("input",{shouldForwardProp:st})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Ss=d.forwardRef(function(t,s){const{autoFocus:a,checked:o,checkedIcon:r,className:i,defaultChecked:u,disabled:l,disableFocusRipple:c=!1,edge:p=!1,icon:C,id:v,inputProps:g,inputRef:b,name:P,onBlur:T,onChange:j,onFocus:w,readOnly:z,required:D=!1,tabIndex:A,type:_,value:f}=t,x=et(t,bs),[y,F]=Et({controlled:o,default:!!u,name:"SwitchBase",state:"checked"}),L=Pt(),De=$=>{w&&w($),L&&L.onFocus&&L.onFocus($)},Bt=$=>{T&&T($),L&&L.onBlur&&L.onBlur($)},Rt=$=>{if($.nativeEvent.defaultPrevented)return;const Le=$.target.checked;F(Le),j&&j($,Le)};let Y=l;L&&typeof Y>"u"&&(Y=L.disabled);const It=_==="checkbox"||_==="radio",ge=H({},t,{checked:y,disabled:Y,disableFocusRipple:c,edge:p}),_e=xs(ge);return K.jsxs(vs,H({component:"span",className:tt(_e.root,i),centerRipple:!0,focusRipple:!c,disabled:Y,tabIndex:null,role:void 0,onFocus:De,onBlur:Bt,ownerState:ge,ref:s},x,{children:[K.jsx(ys,H({autoFocus:a,checked:o,defaultChecked:u,className:_e.input,disabled:Y,id:It?v:void 0,name:P,onChange:Rt,readOnly:z,ref:b,required:D,ownerState:ge,tabIndex:A,type:_},_==="checkbox"&&f===void 0?{}:{value:f},g)),y?r:C]}))}),ks=ke(K.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Ms=ke(K.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Ts=ke(K.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function Bs(n){return Ye("MuiCheckbox",n)}const xe=Ze("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),Rs=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],Is=n=>{const{classes:t,indeterminate:s,color:a,size:o}=n,r={root:["root",s&&"indeterminate",`color${ne(a)}`,`size${ne(o)}`]},i=nt(r,Bs,t);return H({},t,i)},Es=Se(Ss,{shouldForwardProp:n=>st(n)||n==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(n,t)=>{const{ownerState:s}=n;return[t.root,s.indeterminate&&t.indeterminate,t[`size${ne(s.size)}`],s.color!=="default"&&t[`color${ne(s.color)}`]]}})(({theme:n,ownerState:t})=>H({color:(n.vars||n).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:n.vars?`rgba(${t.color==="default"?n.vars.palette.action.activeChannel:n.vars.palette[t.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Dt.alpha(t.color==="default"?n.palette.action.active:n.palette[t.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${xe.checked}, &.${xe.indeterminate}`]:{color:(n.vars||n).palette[t.color].main},[`&.${xe.disabled}`]:{color:(n.vars||n).palette.action.disabled}})),Ps=K.jsx(Ms,{}),ws=K.jsx(ks,{}),zs=K.jsx(Ts,{}),Ds=d.forwardRef(function(t,s){var a,o;const r=zt({props:t,name:"MuiCheckbox"}),{checkedIcon:i=Ps,color:u="primary",icon:l=ws,indeterminate:c=!1,indeterminateIcon:p=zs,inputProps:C,size:v="medium",className:g}=r,b=et(r,Rs),P=c?p:l,T=c?p:i,j=H({},r,{color:u,indeterminate:c,size:v}),w=Is(j);return K.jsx(Es,H({type:"checkbox",inputProps:H({"data-indeterminate":c},C),icon:d.cloneElement(P,{fontSize:(a=P.props.fontSize)!=null?a:v}),checkedIcon:d.cloneElement(T,{fontSize:(o=T.props.fontSize)!=null?o:v}),ownerState:j,ref:s,className:tt(w.root,g)},b,{classes:w}))});function xt(n){const{database:t}=S();return ue(t.builds,n??"")}function Pe(n){const{database:t}=S();return ue(t.buildTcs,n??"")}function re(n){const{database:t}=S();return ue(t.teams,n)}var Z={},Ge;function _s(){if(Ge)return Z;Ge=1;var n=Me();Object.defineProperty(Z,"__esModule",{value:!0}),Z.default=void 0;var t=n(Te()),s=Be(),a=(0,t.default)((0,s.jsx)("path",{d:"M12 12.75c1.63 0 3.07.39 4.24.9 1.08.48 1.76 1.56 1.76 2.73V18H6v-1.61c0-1.18.68-2.26 1.76-2.73 1.17-.52 2.61-.91 4.24-.91zM4 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm1.13 1.1c-.37-.06-.74-.1-1.13-.1-.99 0-1.93.21-2.78.58C.48 14.9 0 15.62 0 16.43V18h4.5v-1.61c0-.83.23-1.61.63-2.29zM20 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm4 3.43c0-.81-.48-1.53-1.22-1.85-.85-.37-1.79-.58-2.78-.58-.39 0-.76.04-1.13.1.4.68.63 1.46.63 2.29V18H24v-1.57zM12 6c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}),"Groups");return Z.default=a,Z}var Ls=_s();const We=Re(Ls);function Os({teamId:n,children:t}){const s=re(n),a=le(s.teamMetadata,0),o=le(s.teamMetadata,1),r=le(s.teamMetadata,2),i=le(s.teamMetadata,3),u=d.useMemo(()=>_t([...Lt(s.teamMetadata.map(l=>l==null?void 0:l.characterKey).filter(l=>!!l)),...a,...o,...r,...i,ce.common.lvl.add(80),ce.common.res.add(.1),ce.common.isBroken.add(0),ce.common.maxToughness.add(100),Ot.common.critMode.add("avg"),...s.conditionals.flatMap(({sheet:l,src:c,dst:p,condKey:C,condValues:v})=>v.flatMap((g,b)=>g?Oe(`preset${b}`,jt(l,c,p)(C,g)):[])),...s.bonusStats.flatMap(({tag:l,values:c})=>c.flatMap((p,C)=>Oe(`preset${C}`,{tag:{...l},value:$t(p)})))]),[s,a,o,r,i]);return e(Qn.Provider,{value:u,children:t})}function le(n,t){const s=n[t],a=gt(s==null?void 0:s.characterKey),o=Pe(s==null?void 0:s.buildTcId),r=xt(s==null?void 0:s.buildId),i=rs((s==null?void 0:s.buildType)==="equipped"?a==null?void 0:a.equippedLightCone:(s==null?void 0:s.buildType)==="real"?r==null?void 0:r.lightConeId:void 0),u=qt((s==null?void 0:s.buildType)==="equipped"?a==null?void 0:a.equippedRelics:(s==null?void 0:s.buildType)==="real"?r==null?void 0:r.relicIds:void 0),l=d.useMemo(()=>{const p=(s==null?void 0:s.buildType)==="tc"?o==null?void 0:o.lightCone:i;return p?At(p.key,p.level,p.ascension,p.superimpose):[]},[s==null?void 0:s.buildType,o==null?void 0:o.lightCone,i]),c=d.useMemo(()=>{const p=o==null?void 0:o.relic;return(s==null?void 0:s.buildType)==="tc"&&p?fn(p):u?Cn(Object.values(u).filter(at)):[]},[o==null?void 0:o.relic,s==null?void 0:s.buildType,u]);return d.useMemo(()=>a?Nt(a.key,...Ft(a,t+1),...l,...c):[],[a,t,l,c])}const ie=d.createContext({presetIndex:0,setPresetIndex:()=>{}}),Ce=d.createContext({teamId:"",team:{}});function G(){return d.useContext(Ce)}const vt=d.createContext({buildType:"equipped",buildId:""});function R(){return d.useContext(vt)}function js(){const{database:n}=S(),{team:t,teamId:s}=G();return h(m,{sx:{display:"flex",gap:1,overflowX:"auto",overflowY:"visible",p:1},children:[t.frames.map((a,o)=>e(qs,{frame:a,index:o},o)),e(m,{sx:{flexShrink:0},children:e(mt,{setOptTarget:a=>n.teams.set(s,o=>{o.frames=[...o.frames,{multiplier:1,tag:{...a,preset:`preset${o.frames.length}`}}]})})})]})}function qs({frame:n,index:t}){const{presetIndex:s,setPresetIndex:a}=d.useContext(ie),o=ae(),{setRead:r}=d.useContext(ft),i=d.useMemo(()=>new Ht(n.tag,"sum"),[n.tag]),u=d.useMemo(()=>{try{return(o==null?void 0:o.compute(i).val)??0}catch(p){return console.error("Error computing value:",p),0}},[o,i]),l=ye(n.tag.q??""),c=d.useCallback(p=>{p.altKey?r(i):a(t)},[t,i,a,r]);return e(M,{bgt:"light",sx:p=>({flexShrink:0,outline:s===t?`solid ${p.palette.success.main}`:void 0}),children:h(oe,{onClick:c,children:[h(m,{sx:{display:"flex",gap:1,alignItems:"stretch",p:1},children:[e(k,{children:t+1}),e(B,{orientation:"vertical"}),e(m,{sx:{display:"flex",alignItems:"center"},children:e(gn,{tag:n.tag})})]}),e(B,{}),e(m,{sx:{p:1,display:"flex",alignItems:"center",gap:1},children:h(k,{children:[n.multiplier," x ",ot(u,l)]})})]})})}var ee={},Ve;function As(){if(Ve)return ee;Ve=1;var n=Me();Object.defineProperty(ee,"__esModule",{value:!0}),ee.default=void 0;var t=n(Te()),s=Be(),a=(0,t.default)((0,s.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");return ee.default=a,ee}var Ns=As();const Fs=Re(Ns);function $s({teamId:n,charKey:t}){const{t:s}=V("page_team"),a=rt(),o=it(),r=ct(o.breakpoints.down("md")),i=re(n);return i?e(Wt,{variant:"fullWidth",value:t??0,orientation:r?"vertical":"horizontal",sx:()=>({borderBottom:"1px rgb(200,200,200,0.3) solid","& .MuiTab-root:hover":{transition:"background-color 0.25s ease",backgroundColor:"rgba(255,255,255,0.1)"},"& .Mui-selected":{color:"white !important"},"& .MuiTabs-indicator":{height:"4px",backgroundColor:"rgb(200,200,200,0.5)"},minHeight:"1em"}),children:i.teamMetadata.map((u,l)=>{const c=u==null?void 0:u.characterKey;return e(Kt,{icon:c?e(Gt,{size:1.5,src:es(Ct(c),"icon")}):e(Fs,{}),iconPosition:"start",value:c??l,disabled:!u,label:c?e(k,{children:s(`charNames_gen:${c}`)}):`Character ${l+1}`,onClick:()=>c&&a(`/teams/${n}/${c}`),sx:{p:1,minHeight:"1em"}},l)})}):null}var te={},Ue;function Hs(){if(Ue)return te;Ue=1;var n=Me();Object.defineProperty(te,"__esModule",{value:!0}),te.default=void 0;var t=n(Te()),s=Be(),a=(0,t.default)((0,s.jsx)("path",{d:"M22 24H2v-4h20v4zM13.06 5.19l3.75 3.75L7.75 18H4v-3.75l9.06-9.06zm4.82 2.68-3.75-3.75 1.83-1.83c.39-.39 1.02-.39 1.41 0l2.34 2.34c.39.39.39 1.02 0 1.41l-1.83 1.83z"}),"BorderColor");return te.default=a,te}var Ks=Hs();const Gs=Re(Ks);function Ws({teamId:n}){const t=re(n);return e(m,{display:"flex",flexDirection:"column",gap:1,children:t.teamMetadata.map((s,a)=>e(Vs,{teamMetadataIndex:a,teamId:n},`${a}_${s==null?void 0:s.characterKey}`))})}const Vs=d.memo(function({teamMetadataIndex:t,teamId:s}){var i;const{database:a}=S(),o=re(s);function r(u){if(u===""){a.teams.set(s,c=>c.teamMetadata[t]=void 0);return}a.chars.getOrCreate(u);const l=o.teamMetadata.findIndex(c=>(c==null?void 0:c.characterKey)===u);if(l===-1)a.teams.set(s,c=>{c.teamMetadata[t]={characterKey:u}});else{if(l===t)return;const c=o.teamMetadata[l],p=o.teamMetadata[t];a.teams.set(s,C=>{C.teamMetadata[t]=c,C.teamMetadata[l]=p})}}return e(bn,{charKey:((i=o.teamMetadata[t])==null?void 0:i.characterKey)??"",setCharKey:r})});function Us(){const{t:n}=V("page_team"),{teamId:t,team:s}=G(),{database:a}=S(),[o,r]=d.useState(!1),i=l=>{a.teams.set(t,{name:l})},u=l=>{a.teams.set(t,{description:l})};return h(he,{children:[e(oe,{onClick:()=>r(!0),children:e(Vt,{placement:"top",title:h(m,{children:[h(m,{sx:{display:"flex",color:"info.light",gap:1},children:[e(Gs,{}),e(k,{children:e("strong",{children:n("team.editNameDesc")})})]}),!!s.description&&e(k,{children:s.description})]}),children:e(E,{sx:{display:"flex",justifyContent:"center","&:hover":{color:"info.light"},py:1},children:h(k,{variant:"h5",sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"center",textShadow:"#000 0 0 10px !important"},children:[e(We,{}),s.name]})})})}),e(U,{open:o,onClose:()=>r(!1),children:h(M,{children:[e(q,{title:n("team.editNameDesc"),avatar:e(We,{}),titleTypographyProps:{variant:"h6"},action:e(W,{onClick:()=>r(!1),children:e(J,{})})}),e(B,{}),e(E,{children:h(m,{display:"flex",flexDirection:"column",gap:2,sx:{mt:2},children:[e(Ke,{label:n("team.name"),value:s.name,onChange:l=>i(l),autoFocus:!0}),e(Ke,{label:n("team.desc"),value:s.description,onChange:l=>u(l),multiline:!0,minRows:4}),e(Ws,{teamId:t})]})})]})})]})}const yt=210,St=2,kt=d.createContext(yt);function Js({teamId:n,characterKey:t,headerRef:s}){return e(m,{ref:s,sx:{overflow:"visible",top:St,position:"sticky",zIndex:101},children:h(M,{sx:a=>({outline:`solid ${a.palette.secondary.main}`}),children:[e(Us,{}),e(B,{}),e(js,{}),e(B,{}),e($s,{teamId:n,charKey:t})]})})}function Xs(){const{database:n}=S(),{presetIndex:t}=d.useContext(ie),{teamId:s,team:{bonusStats:a}}=G(),{characterKey:o}=R(),r=i=>{const u=Qs(i,o);n.teams.setBonusStat(s,u,0,t)};return t?h(M,{children:[e(q,{title:"Bonus Stats"}),e(B,{}),e(E,{children:h(N,{spacing:1,children:[a.map(({tag:i,values:u},l)=>e(ea,{tag:i,value:u[t],setValue:c=>n.teams.setBonusStat(s,i,c,t),onDelete:()=>n.teams.setBonusStat(s,i,0,t),setTag:c=>n.teams.setBonusStat(s,c,0,t)},JSON.stringify(i)+l)),e(Zs,{onSelect:r})]})})]}):null}function Qs(n,t){return{src:t,dst:t,et:"own",q:n,qt:"premod",sheet:"agg"}}const Ys=["hp","hp_","def","def_","atk","atk_","spd","spd_","dmg_","enerRegen_","brEffect_","crit_","crit_dmg_","eff_","eff_res_","heal_"];function Zs({tag:n={},onSelect:t}){var s;return e(fe,{title:(n&&((s=xn.subset(n)[0])==null?void 0:s.title))??"Add Bonus Stat",children:Ys.map(a=>e(se,{onClick:()=>t(a),children:a},a))})}function ea({tag:n,setTag:t,value:s,setValue:a,onDelete:o}){var i;const r=(i=n.name||n.q)==null?void 0:i.endsWith("_");return e(M,{bgt:"light",children:h(E,{sx:{display:"flex",gap:1,justifyContent:"space-around"},children:[e(lt,{sx:{m:"auto"},children:n.q}),n.q==="dmg_"&&e(ta,{tag:n,setElementalType:u=>{const{elementalType:l,...c}=n;t(u?{...c,elementalType:u}:c)}}),e(pe,{float:!0,value:s,sx:{flexBasis:150,flexGrow:1,height:"100%"},onChange:a,placeholder:"Stat Value",size:"small",inputProps:{sx:{textAlign:"right"}},InputProps:{endAdornment:h(Ee,{position:"end",sx:{ml:0},children:[r?"%":void 0," ",e(W,{"aria-label":"Delete Bonus Stat",onClick:o,edge:"end",children:e(ds,{fontSize:"small"})})]})}})]})})}function ta({tag:n,setElementalType:t}){return h(fe,{title:n.elementalType??"No Element",children:[e(se,{onClick:()=>t(null),children:"No Element"}),Ut.map(s=>e(se,{onClick:()=>t(s),children:s},s))]})}function na({onClose:n}){const{database:t}=S(),{characterKey:s}=R(),a=He(t.builds),o=d.useMemo(()=>a&&t.builds.getBuildIds(s),[a,t,s]),r=He(t.buildTcs),i=d.useMemo(()=>r&&t.buildTcs.getBuildTcIds(s),[r,t,s]);return h(M,{bgt:"dark",children:[e(q,{title:"Builds",action:n?e(W,{onClick:n,children:e(J,{})}):null}),e(B,{}),e(E,{children:h(N,{spacing:1,children:[e(k,{variant:"h6",children:"Equipped build"}),e(sa,{}),e(k,{variant:"h6",children:"Other builds"}),o.map(u=>e(aa,{buildId:u},u)),e(k,{variant:"h6",children:"TC builds"}),e(O,{fullWidth:!0,onClick:()=>t.buildTcs.new(Jt(s)),children:"New TC Build"}),i.map(u=>e(oa,{buildTcId:u},u))]})})]})}function we(n,t=""){const{database:s}=S(),{characterKey:a,buildType:o,buildId:r,buildTcId:i}=R(),{teamId:u}=G();return d.useMemo(()=>({active:o==="equipped"?o===n:o==="real"?r===t:o==="tc"&&i===t,onActive:()=>{s.teams.set(u,l=>{const c=l.teamMetadata.find(p=>(p==null?void 0:p.characterKey)===a);if(!c){console.error(`Teammate data not found for character ${a}`);return}c.buildType=n,n==="real"&&t?c.buildId=t:n==="tc"&&t&&(c.buildTcId=t)})}}),[r,i,o,a,s.teams,t,n,u])}function sa(){const n=Ie(),{equippedRelics:t,equippedLightCone:s}=n,{active:a,onActive:o}=we("equipped");return e(ze,{name:"Equipped",onActive:o,active:a,buildGrid:e(me,{relicIds:t,lightConeId:s})})}function aa({buildId:n}){const t=xt(n),{relicIds:s,lightConeId:a,name:o,description:r}=t,{active:i,onActive:u}=we("real",n);return e(ze,{name:o,description:r,onActive:u,active:i,buildGrid:e(me,{relicIds:s,lightConeId:a})})}function ze({name:n,description:t,buildGrid:s,active:a,onActive:o}){const r=d.useCallback(()=>{},[]);return h(M,{sx:i=>({outline:a?`solid ${i.palette.success.main}`:void 0}),children:[h(m,{display:"flex",children:[e(oe,{onClick:r,children:e(q,{title:n,subheader:t})}),e(m,{display:"flex",alignContent:"center",sx:{padding:1},children:e(O,{size:"small",color:"success",onClick:o,disabled:a,children:"Set Active"})})]}),e(B,{}),e(E,{children:s})]})}function oa({buildTcId:n}){const t=Pe(n),{name:s="ERROR",description:a="ERROR"}=t??{},{active:o,onActive:r}=we("tc",n);return e(ze,{name:s,description:a,onActive:r,active:o,buildGrid:e(Mt,{buildTcId:n})})}function Mt({buildTcId:n}){const{database:t}=S(),s=Pe(n),{lightCone:a,relic:o}=s,[r,i,u]=X(),[l,c,p]=X(),[C,v,g]=X(),[b,P,T]=X(),j=d.useCallback(f=>{t.buildTcs.set(n,x=>({lightCone:{...x.lightCone,...f}}))},[n,t.buildTcs]),w=d.useCallback((f,x)=>{t.buildTcs.set(n,y=>({relic:{...y.relic,slots:{...y.relic.slots,[f]:{...y.relic.slots[f],...x}}}}))},[n,t.buildTcs]),z=d.useCallback((f,x)=>{t.buildTcs.set(n,y=>({relic:{...y.relic,substats:{...y.relic.substats,stats:{...y.relic.substats.stats,[f]:x}}}}))},[n,t.buildTcs]),D=d.useCallback(f=>{t.buildTcs.set(n,x=>({relic:{...x.relic,substats:{...x.relic.substats,type:f}}}))},[n,t.buildTcs]),A=d.useCallback((f,x)=>{t.buildTcs.set(n,y=>({relic:{...y.relic,sets:{...y.relic.sets,[f]:x}}}))},[n,t.buildTcs]),_=d.useCallback(f=>{t.buildTcs.set(n,x=>{const y={...x.relic.sets};return delete y[f],{relic:{...x.relic,sets:y}}})},[n,t.buildTcs]);return h(m,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e(ra,{show:r,onClose:u,lightCone:a,onUpdate:j}),a?e(vn,{bgt:"light",lightCone:a,onClick:i}):e(yn,{bgt:"light",onClick:i}),e(ua,{show:b,onClose:T,sets:o.sets,setSets:A,removeSet:_}),e(Sn,{bgt:"light",sets:o.sets,onClick:P}),e(ia,{show:l,onClose:p,slots:o.slots,setSlot:w}),e(kn,{bgt:"light",slots:o.slots,onClick:c}),e(la,{stats:o.substats.stats,show:C,onClose:g,type:o.substats.type,setType:D,setStat:z}),e(be,{onClick:v,relic:o,keys:["hp","hp_","def","def_"],bgt:"light"}),e(be,{onClick:v,relic:o,keys:["atk","atk_","crit_","crit_dmg_"],bgt:"light"}),e(be,{onClick:v,relic:o,keys:["spd","eff_","eff_res_","brEffect_"],bgt:"light"})]})}function ra({lightCone:n={},onUpdate:t,show:s,onClose:a}){return e(U,{open:s,onClose:a,children:e(ps,{onClose:a,lightCone:n,setLightCone:t,hideLocation:!0})})}function ia({slots:n,show:t,onClose:s,setSlot:a}){return e(U,{open:t,onClose:s,containerProps:{maxWidth:"sm"},children:h(M,{children:[e(q,{title:"TC Build Relic Slots Editor",action:e(W,{onClick:s,children:e(J,{})})}),e(B,{}),e(E,{children:e(N,{spacing:1,children:Object.entries(n).map(([o,{level:r,statKey:i,rarity:u}])=>e(ca,{slotKey:o,level:r,statKey:i,rarity:u,setStatKey:l=>a(o,{statKey:l}),setRarity:l=>a(o,{rarity:l}),setLevel:l=>a(o,{level:l})},o))})})]})})}function ca({slotKey:n,level:t,rarity:s,statKey:a,setStatKey:o,setRarity:r,setLevel:i}){return h(m,{sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"space-between"},children:[e(hs,{slotKey:n}),e(fs,{rarity:s,onRarityChange:r,showNumber:!0}),e(m,{sx:{flexGrow:1},children:e(Cs,{dropdownButtonProps:{fullWidth:!0},slotKey:n,statKey:a,setStatKey:o})}),e(pe,{value:t,inputProps:{sx:{width:"2ch"},max:Zt[s],min:0},InputProps:{startAdornment:e(Ee,{position:"start",children:"Level"})},size:"small",onChange:i})]})}function la({show:n,onClose:t,stats:s,setStat:a}){return e(U,{open:n,onClose:t,containerProps:{maxWidth:"sm"},children:h(M,{children:[e(q,{title:"TC Build Substats Editor",action:e(W,{onClick:t,children:e(J,{})})}),e(B,{}),e(E,{children:e(N,{spacing:1,children:e(m,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",rowGap:1,columnGap:2},children:Object.entries(s).map(([o,r])=>e(da,{statKey:o,value:r,setValue:i=>a(o,i)},o))})})})]})})}function da({statKey:n,value:t,setValue:s}){return h(m,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"space-between"},children:[e(ts,{statKey:n}),e(pe,{value:t,onChange:s,float:ye(n)==="%",size:"small",inputProps:{sx:{width:"4em",textAlign:"right"},min:0,max:9999},InputProps:{endAdornment:ye(n)||e(m,{width:"0.8em",component:"span"})}})]})}function ua({show:n,onClose:t,sets:s,setSets:a,removeSet:o}){const[r,i]=d.useState(null),u=d.useCallback(c=>{c&&(Xt(c)?a(c,2):Qt(c)&&i(c))},[a]),l=d.useCallback(c=>{r&&(a(r,c),i(null))},[r,a]);return e(U,{open:n,onClose:t,containerProps:{maxWidth:"sm"},children:h(M,{children:[e(q,{title:"TC Build Relic Sets Editor",action:e(W,{onClick:t,children:e(J,{})})}),e(B,{}),e(E,{children:h(N,{spacing:1,children:[Object.entries(s).map(([c,p])=>h(m,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(us,{setKey:c}),e(lt,{children:p}),e(W,{size:"small",onClick:()=>o(c),children:e(ms,{})})]},c)),h(m,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(bt,{size:"small",relicSetKey:r??"",setRelicSetKey:u,sx:{flexGrow:1},label:r??""}),h(Yt,{children:[e(O,{disabled:!r,onClick:()=>l(2),children:"2"}),e(O,{disabled:!r,onClick:()=>l(4),children:"4"})]})]})]})})]})})}function ha(){const{team:n}=G(),t=n.conditionals,[s,a]=d.useState(""),o=d.useMemo(()=>{const r=t.map(i=>i.sheet).filter(en);return s&&r.push(s),[...new Set(r)].sort(i=>i===s?-1:1)},[t,s]);return h(N,{spacing:1,sx:{pt:1},children:[e(is,{lcKey:s,setLCKey:a,label:"Search Light Cone"}),e(m,{children:e(I,{container:!0,columns:3,spacing:1,children:o.map(r=>e(I,{item:!0,xs:1,children:e(Mn,{lcKey:r})},r))})})]})}function pa(n){const{database:t}=S();return ue(t.generatedBuildList,n)}const ma=d.memo(function(){const{optConfig:t}=d.useContext(dt),s=pa(t.generatedBuildListId??"");return e(N,{spacing:1,children:s==null?void 0:s.builds.map((a,o)=>e(M,{children:h(E,{children:[h(m,{sx:{display:"flex",justifyContent:"space-between",gap:1},children:[h(k,{children:["Build ",o+1,": ",ot(a.value)]}),e(fa,{build:a})]}),e(me,{relicIds:a.relicIds,lightConeId:a.lightConeId})]})},`${o}-${a.lightConeId}-${Object.values(a.relicIds).join("-")}`))})});function fa({build:{relicIds:n,lightConeId:t}}){const{t:s}=V("build"),[a,o]=d.useState(""),[r,i,u]=X(),[l,c]=d.useState(!1),{database:p}=S(),{teamId:C}=G(),{characterKey:v}=R(),g=b=>{b.preventDefault(),l||p.builds.new({characterKey:v,name:a,teamId:C,relicIds:n,lightConeId:t}),o(""),u()};return h(he,{children:[e(O,{color:"info",size:"small",startIcon:e(Tn,{}),onClick:i,children:s("createBuildReal.button")}),e(U,{open:r,onClose:u,disableRestoreFocus:!0,children:h(M,{children:[e(q,{title:s("createBuildReal.title"),action:e(W,{onClick:u,children:e(J,{})})}),e(B,{}),h(E,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e(k,{children:s("createBuildReal.desc")}),h(m,{display:"flex",alignItems:"center",sx:{ml:-1},children:[e(Ds,{size:"small",checked:l,onChange:()=>c(!l)}),e(k,{children:"Create a new TC Build"})]}),h("form",{onSubmit:g,children:[e(Yn,{value:a,onChange:b=>o(b.target.value),autoFocus:!0,margin:"dense",label:s("createBuildReal.label"),fullWidth:!0}),h(m,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[e(O,{onClick:u,children:s("createBuildReal.cancel")}),e(O,{type:"submit",color:"success",disabled:!a,children:s("createBuildReal.create")})]})]})]})]})})]})}function Ca(){const{database:n}=S(),{teamId:t}=d.useContext(Ce),s=R(),a=s.optConfigId,o=d.useCallback(()=>{a||n.teams.set(t,r=>{const i=r.teamMetadata.find(u=>(u==null?void 0:u.characterKey)===s.characterKey);if(i){const u=n.optConfigs.new();i.optConfigId=u}})},[t,s.characterKey,n,a]);return a?h(tn,{optConfigId:a,children:[e(ga,{}),e(ma,{})]}):e(M,{children:e(q,{title:h("span",{children:["Optimize this team for ",s.characterKey]}),action:e(O,{onClick:o,children:"Optimize"})})})}function ga(){const{t:n}=V("optimize"),{database:t}=S(),s=ae(),{team:a}=d.useContext(Ce),{characterKey:o}=R(),[r,i]=d.useState(8),[u,l]=d.useState(void 0),{optConfig:c,optConfigId:p}=d.useContext(dt),C=d.useMemo(()=>t.relics.values.reduce((z,D)=>(z[D.slotKey].push(D),z),{head:[],hands:[],feet:[],body:[],sphere:[],rope:[]}),[t.relics.values]),v=d.useMemo(()=>{const{path:z}=ss(o);return t.lightCones.values.filter(({key:D})=>{const{path:A}=cs(D);return z===A})},[o,t.lightCones.values]),g=d.useMemo(()=>Bn(Object.values(C))*v.length,[v.length,C]),[b,P]=d.useState(!1),T=d.useRef(()=>{});d.useEffect(()=>()=>T.current(),[]);const j=d.useCallback(async()=>{if(!s)return;const z=new Promise(f=>T.current=f);l(void 0),P(!0);const D=(c.statFilters??[]).filter(f=>!f.disabled),A=Rn(o,s,a.frames,10,D,[],[],[],v,C,r,l);z.then(()=>A.terminate("user cancelled"));let _;try{_=await A.results}catch{return}finally{T.current=()=>{},P(!1)}_.length&&t.optConfigs.newOrSetGeneratedBuildList(p,{builds:_.slice(0,5).map(({ids:f,value:x})=>({lightConeId:f[0],relicIds:ut(nn,(y,F)=>f[F+1]),value:x})),buildDate:Date.now()})},[s,c.statFilters,o,a.frames,v,C,r,t.optConfigs,p]),w=d.useCallback(()=>{T.current(),P(!1)},[T]);return h(M,{children:[e(q,{title:n("optimize"),action:h(m,{children:[e(In,{numWorkers:r,setNumWorkers:i}),e(O,{onClick:b?w:j,color:b?"error":"primary",startIcon:b?e(J,{}):e(En,{}),children:n(b?"cancel":"optimize")})]})}),e(B,{}),h(E,{children:[e(Pn,{}),u&&e(ba,{progress:u,total:g})]})]})}function de({value:n}){const t=n.toLocaleString();return e(m,{sx:{fontFamily:"Monospace",display:"inline"},children:t})}function ba(n){const{t}=V("optimize"),{computed:s,remaining:a,skipped:o}=n.progress,r=s+a,i=Math.log1p(r)/Math.log1p(n.total),u=a/r*i;return h(m,{children:[h(k,{children:[t("computed"),": ",e(de,{value:s})," /"," ",e(de,{value:r})," "]}),h(k,{children:[t("computed + skipped"),": ",e(de,{value:s+o})," /"," ",e(de,{value:n.total})]}),e(wn,{variant:"determinate",value:(1-u)*100,sx:{height:10,borderRadius:5}})]})}function xa(){const{team:n}=G(),t=n.conditionals,[s,a]=d.useState(""),o=d.useMemo(()=>{const r=t.map(i=>i.sheet).filter(sn);return s&&r.push(s),[...new Set(r)].sort(i=>i===s?-1:1)},[t,s]);return h(N,{spacing:1,sx:{pt:1},children:[e(bt,{relicSetKey:s,setRelicSetKey:a,label:"Search Relic Set"}),e(m,{children:e(I,{container:!0,columns:3,spacing:1,children:o.map(r=>e(I,{item:!0,xs:1,children:e(zn,{setKey:r})},r))})})]})}const va={xs:12,sm:6,md:4};function ya(){const{characterKey:n}=R(),t=ae(),s=["basic","skill","ult","talent","technique","overworld","bonusAbility1","bonusAbility2","bonusAbility3",...Ln],a=it(),o=ct(a.breakpoints.up("lg")),r=Dn[n],i=(t==null?void 0:t.compute(Q.char.eidolon).val)??0,u=d.useMemo(()=>r&&_n.map(l=>{const c=r[l];return c?e(Je,{talentKey:l,sheetElement:c},l):null}),[r]);if(!(!r||!t))return e(he,{children:h(I,{container:!0,spacing:1,children:[o&&h(I,{item:!0,xs:12,md:12,lg:3,sx:{display:"flex",flexDirection:"column",gap:1},children:[e(Xe,{eidolon:i}),u&&u.map((l,c)=>e(m,{sx:{opacity:i>=c+1?1:.5},children:l},c))]}),e(I,{item:!0,xs:12,md:12,lg:9,container:!0,spacing:1,children:s.map(l=>{const c=r[l];return c?e(I,{item:!0,...va,children:e(Je,{talentKey:l,sheetElement:c})},l):null})}),!o&&e(I,{item:!0,xs:12,md:12,lg:3,container:!0,spacing:1,children:e(I,{item:!0,xs:12,children:e(Xe,{eidolon:i})})})]})})}function Je({sheetElement:n,talentKey:t}){const s=ae(),{characterKey:a}=R(),{database:o}=S(),{img:r,title:i,subtitle:u,documents:l}=n,c=d.useMemo(()=>s?Ae(t)?Ne[t].disabled(s):Fe(t)?$e[t].disabled(s):!1:!1,[s,t]),p=d.useMemo(()=>{if(s){if(Ae(t)&&Ne[t].onClickable(s))return()=>o.chars.set(a,g=>{const b=On(t);g.statBoosts={...g.statBoosts,[b]:!g.statBoosts[b]}});if(Fe(t)&&$e[t].onClickable(s))return()=>o.chars.set(a,g=>{const b=jn(t);g.bonusAbilities={...g.bonusAbilities,[b]:!g.bonusAbilities[b]}});if(qn(t)){const g=An(t),b=(s==null?void 0:s.compute(Q.char.eidolon).val)??0;return()=>o.chars.set(a,{eidolon:g===b?g-1:g})}}},[t,s,o.chars,a]),C=d.useCallback(g=>e(oe,{onClick:p,children:g}),[p]);let v=null;return v=null,$n(t)&&(v=e(Sa,{talentKey:t,dropDownButtonProps:{sx:{borderRadius:0}},setTalent:g=>o.chars.set(a,b=>{b[t]=g})})),h(M,{bgt:"light",sx:{height:"100%",opacity:c?.5:1},children:[v,h(m,{sx:{p:1},children:[e(Nn,{condition:!!p,wrapper:C,children:h(I,{container:!0,sx:{flexWrap:"nowrap"},children:[r&&e(I,{item:!0,children:e(m,{component:"img",src:r,sx:{width:60,height:"auto"}})}),h(I,{item:!0,flexGrow:1,sx:{pl:1},children:[e(k,{variant:"subtitle1",children:i}),u&&e(k,{variant:"subtitle2",children:u})]})]})}),l.map((g,b)=>e(Fn,{document:g,collapse:!0},b))]})]})}function Xe({eidolon:n}){const{t}=V("characters_gen"),{characterKey:s}=R(),{database:a}=S();return e(fe,{fullWidth:!0,title:h("span",{children:[t("eidolonLvl")," ",n]}),color:"primary",children:ht(0,an).map(o=>e(se,{selected:n===o,disabled:n===o,onClick:()=>a.chars.set(s,{eidolon:o}),children:h("span",{children:[t("eidolonLvl")," ",o]})},o))})}function Sa({talentKey:n,setTalent:t,dropDownButtonProps:s}){const{t:a}=V("common_gen"),o=Ie(),r=ae();if(!r||!o)return null;const i=0,u=r.compute(Q.char[n]).val,l=r.compute(Q.char.ascension).val;return e(fe,{fullWidth:!0,title:h("span",{children:[a("lv")," ",u]}),color:"primary",...s,children:ht(1,on[l]).map(c=>e(se,{selected:o[n]===c,disabled:o[n]===c,onClick:()=>t(c),children:h("span",{children:[a("lv")," ",c+i]})},c))})}const ka=0,ve=33,Tt=d.createContext(0);function Ma(){const{presetIndex:n}=d.useContext(ie),{team:t}=G(),s=d.useMemo(()=>t.frames[n]?[["combo",`Edit Combo ${n+1}`,e(Ba,{},"combo")],["char","Character",e(Qe,{},"char")],["talent","Talent",e(ya,{},"talent")],["relicCond","Relic Conditionals",e(xa,{},"relicCond")],["lightConeCond","Light Cone Conditionals",e(ha,{},"lightConeCond")],["opt","Optimize",e(Ra,{},"opt")]]:[["char","Character",e(Qe,{})]],[t,n]);return e(Tt.Provider,{value:s.length,children:e(N,{gap:1,children:s.map(([a,o,r],i)=>e(Ta,{title:o,index:i,children:r},a))})})}function Ta({index:n,title:t,children:s}){const[a,o]=Kn(),r=d.useContext(Tt),i=d.useContext(kt);return h(he,{children:[e(M,{sx:u=>({outline:`solid ${u.palette.secondary.main}`,position:"sticky",top:i+n*ve,bottom:ka+(r-1-n)*ve,zIndex:100}),children:e(oe,{onClick:o,sx:{px:1},children:e(k,{variant:"h6",children:t})})}),e(m,{ref:a,sx:{scrollMarginTop:i+(n+1)*ve},children:s})]})}function Ba(){const{database:n}=S(),{presetIndex:t,setPresetIndex:s}=d.useContext(ie),{team:a,teamId:o}=G(),r=d.useMemo(()=>a.frames[t],[a,t]),i=l=>{n.teams.set(o,c=>{c.frames=[...c.frames],c.frames[t]={...c.frames[t],...l},c.frames.length?c.frames.length<=t&&s(c.frames.length-1):s(0)})},u=()=>{n.teams.set(o,l=>{l.frames=l.frames.filter((c,p)=>p!==t)})};return r?h(m,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e(pe,{value:r.multiplier,onChange:l=>i({multiplier:l}),size:"small",InputProps:{startAdornment:e(Ee,{position:"start",children:"Multi x "})}}),e(mt,{optTarget:r.tag,setOptTarget:l=>i({tag:l})}),e(O,{size:"small",color:"error",onClick:u,startIcon:e(ls,{}),children:"Remove"})]}):null}function Qe(){const n=Ie(),{key:t}=n,[s,a]=d.useState(void 0);return h(N,{spacing:1,children:[h(m,{sx:{display:"flex",gap:1},children:[h(m,{sx:{minWidth:"350px"},children:[e(as,{character:n}),e(os,{characterKey:s,onClose:()=>a(void 0)}),e(O,{fullWidth:!0,disabled:!t,onClick:()=>t&&a(t),children:"Edit Character"})]}),e(Ia,{})]}),e(Xs,{}),e(Hn,{formulasRead:Q.listing.formulas,buffsRead:Q.listing.buffs})]})}function Ra(){const{buildType:n}=R();return n==="tc"?null:e(Ca,{})}function Ia(){const n=R(),{database:t}=S(),{buildType:s,buildId:a,buildTcId:o}=n,r=d.useSyncExternalStore(d.useCallback(c=>{let p=()=>{};return s==="real"&&(p=t.builds.follow(a,c)),s==="tc"&&(p=t.buildTcs.follow(o,c)),()=>p()},[a,o,s,t]),()=>t.teams.getActiveBuildName(n)),[i,u,l]=X();return h(M,{sx:{width:"100%"},children:[e(wa,{show:i,onClose:l}),e(q,{title:r,action:e(O,{onClick:u,size:"small",children:"Change Build"})}),e(B,{}),e(E,{children:s==="tc"?e(Pa,{}):e(Ea,{})})]})}function Ea(){const n=R(),{database:t}=S(),{relicIds:s,lightConeId:a}=d.useMemo(()=>t.teams.getTeamActiveBuild(n),[t.teams,n]);return e(me,{relicIds:s,lightConeId:a})}function Pa(){const n=R();return n.buildType!=="tc"?null:e(Mt,{buildTcId:n.buildTcId})}function wa({show:n,onClose:t}){return e(U,{open:n,onClose:t,containerProps:{maxWidth:"xl"},children:e(na,{onClose:t})})}const za=e(pt,{variant:"rectangular",width:"100%",height:1e3});function Ya(){const{database:n}=S(),{teamId:t}=rn(),s=!t||!n.teams.keys.includes(t);return d.useEffect(()=>{s||n.teams.set(t,{lastEdit:Date.now()})},[t,n.teams,s]),s?e(cn,{to:"/teams"}):e(m,{display:"flex",flexDirection:"column",gap:1,children:e(d.Suspense,{fallback:za,children:t&&e(Da,{teamId:t})})})}function Da({teamId:n}){const t=rt(),{database:s}=S(),[a,o]=d.useState(0),r=d.useMemo(()=>({presetIndex:a,setPresetIndex:o}),[a,o]),i=re(n),{teamMetadata:u}=i,{params:{characterKey:l}}=ln({path:"/teams/:teamId/:characterKey",end:!1})??{params:{}},c=d.useMemo(()=>{const f=u.findIndex(x=>x&&x.characterKey===l);return f===-1?0:f},[u,l]),p=d.useMemo(()=>u[c],[u,c]),C=p==null?void 0:p.characterKey;C&&C!==l&&t(`${C}`,{replace:!0});const{t:v}=V(["charNames_gen","page_character"]);Gn(d.useMemo(()=>{const f=v(C?"charNames_gen:Character":"Team Settings");return`${i.name} - ${f}`},[C,v,i.name]));const g=d.useMemo(()=>({teamId:n,team:i}),[i,n]),b=d.useMemo(()=>{const f=i.teamMetadata.filter(at).map(({characterKey:y})=>y);C&&dn(f,C);const x=ut(f,y=>e(ns,{genderedKey:Ct(y)}));return{srcDisplay:x,dstDisplay:x}},[i.teamMetadata,C]),P=d.useMemo(()=>i.conditionals.map(({sheet:f,src:x,dst:y,condKey:F,condValues:L})=>({sheet:f,src:x,dst:y,condKey:F,condValue:L[a]})),[a,i.conditionals]),T=d.useCallback((f,x,y,F,L)=>{!un(f)||!je(y)||!(F===null||je(F))||!hn(f,x)||s.teams.setConditional(n,f,x,y,F,L,a)},[s.teams,a,n]),j=d.useMemo(()=>({src:C,dst:C,preset:`preset${a}`}),[C,a]),[w,z]=d.useState(),D=d.useMemo(()=>({read:w,setRead:z}),[w]),{height:A,ref:_}=Wn();return e(Ce.Provider,{value:g,children:e(Zn.Provider,{value:j,children:e(ie.Provider,{value:r,children:e(Os,{teamId:n,children:e(Vn.Provider,{value:b,children:e(Un.Provider,{value:P,children:e(Jn.Provider,{value:T,children:h(ft.Provider,{value:D,children:[e(Xn,{}),h(m,{sx:{display:"flex",gap:1,flexDirection:"column",mx:1,mt:2},children:[e(Js,{headerRef:_,teamId:n,characterKey:C}),e(kt.Provider,{value:(A||yt)+St,children:p&&e(vt.Provider,{value:p,children:e(_a,{})})})]})]})})})})})})})})}function _a(){const{characterKey:n}=R(),t=gt(n);return t?e(mn.Provider,{value:t,children:e(pn,{children:e(qe,{path:":characterKey",children:e(qe,{path:"*",index:!0,element:e(Ma,{})})})})}):e(pt,{variant:"rectangular",width:"100%",height:1e3})}export{Ya as default};
