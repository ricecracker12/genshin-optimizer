import{r as h,c as v,j as y,i as U,k as G,l as A,m as N,n as W,q as n,p as e,T as l,aJ as F,z as S,V as Q,a3 as m,y as x,C as X,B as D,a1 as Y}from"./index-CsTkwEb4.js";import{b as _,T as u,U as Z}from"./UploadCard-rUtAx2tH.js";import{C,G as c}from"./ReadOnlyTextArea-CJfHBbDv.js";import{u as ee}from"./useBoolState-CpBuHcU3.js";import{T as te,D as ae}from"./Delete-CrLe1oW8.js";function ne(a){return h.useSyncExternalStore(h.useCallback(o=>a==null?void 0:a.follow(s=>s==="update"&&o()),[a]),()=>a.get())}const re=v(y.jsx("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download"),oe=v(y.jsx("path",{d:"M9 3 5 6.99h3V14h2V6.99h3L9 3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99h-3z"}),"ImportExport"),se=v(y.jsx("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload");var g={},R;function le(){if(R)return g;R=1;var a=U();Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var o=a(G()),s=A(),b=(0,o.default)((0,s.jsx)("path",{d:"M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"}),"ContentPaste");return g.default=b,g}var ce=le();const ie=N(ce);function de(){const{t:a}=W("page_settings");return n(S,{bgt:"light",children:[e(C,{sx:{py:1},children:e(l,{variant:"subtitle1",children:a("DatabaseCard.title")})}),e(_,{}),e(C,{sx:{display:"flex",flexDirection:"column",gap:2},children:e(c,{container:!0,spacing:2,columns:{xs:1,md:2},children:F(0,3).map(o=>e(c,{item:!0,xs:1,children:e(ue,{index:o})},o))})})]})}function ue({index:a}){const{databases:o,database:s,setDatabase:b}=Q(),t=o[a],{name:p,lastEdit:w}=ne(t.dbMeta),i=s===t,[M,O,I]=ee(),{t:r}=W("page_settings"),j=m(t.chars).length,T=m(t.relics).length,k=m(t.lightCones).length,E=m(t.teams).length,z=m(t.builds).length,f=!!(j||T||k||E||z),q=h.useCallback(()=>navigator.clipboard.writeText(JSON.stringify(t.exportSROD())).then(()=>alert("Copied database to clipboard.")).catch(console.error),[t]),L=h.useCallback(()=>{window.confirm(`Are you sure you want to delete "${p}"?`)&&(t.clear(),t.toExtraLocalDB())},[t,p]),P=h.useCallback(()=>{const K=new Date().toISOString().split(".")[0].replace("T","_").replaceAll(":","-"),$=JSON.stringify(t.exportSROD()),H=`${p.trim().replaceAll(" ","_")}_${K}.json`,J="application/json;charset=utf-8",d=document.createElement("a");d.download=H,d.href=`data:${J},${encodeURIComponent($)}`,d.target="_blank",document.body.appendChild(d),d.click(),document.body.removeChild(d)},[t,p]),V=h.useCallback(()=>{i||(s.toExtraLocalDB(),t.swapStorage(s),b(a,t))},[a,b,s,i,t]);return n(S,{sx:{height:"100%",boxShadow:i?"0px 0px 0px 2px green inset":void 0},children:[n(C,{sx:{display:"flex",gap:1,justifyContent:"space-between",alignItems:"center"},children:[e(te,{size:"small",fullWidth:!0,value:p,sx:{borderRadius:1,px:1,flexGrow:1},onChange:B=>{t.dbMeta.set({name:B}),t.toExtraLocalDB()}}),!i&&e(x,{startIcon:e(oe,{}),onClick:V,color:"warning",children:r("DatabaseCard.button.swap")}),e(X,{color:i?"success":"secondary",sx:{alignSelf:"center"},label:i?r("DatabaseCard.currentDB"):`${r("DatabaseCard.title")} ${t.dbIndex}`})]}),e(_,{}),e(C,{children:n(D,{display:"flex",gap:2,children:[n(D,{flexGrow:1,children:[n(l,{noWrap:!0,children:[e(u,{t:r,i18nKey:"count.chars"})," ",e("strong",{children:j})]}),n(l,{noWrap:!0,children:[e(u,{t:r,i18nKey:"count.relics"})," ",e("strong",{children:T})]}),n(l,{noWrap:!0,children:[e(u,{t:r,i18nKey:"count.lightCones"})," ",e("strong",{children:k})]}),n(l,{noWrap:!0,children:[e(u,{t:r,i18nKey:"count.teams"})," ",e("strong",{children:E})]}),n(l,{noWrap:!0,children:[e(u,{t:r,i18nKey:"count.builds"})," ",e("strong",{children:z})]})]}),n(D,{children:[n(c,{container:!0,spacing:1,columns:{xs:2},children:[e(c,{item:!0,xs:1,children:e(x,{fullWidth:!0,disabled:!f,color:"info",onClick:q,startIcon:e(ie,{}),children:e(u,{t:r,i18nKey:"DatabaseCard.button.copy"})})}),n(c,{item:!0,xs:1,children:[e(Y,{open:M,onClose:I,children:e(Z,{index:a,onReplace:I})}),e(x,{fullWidth:!0,component:"span",color:"info",startIcon:e(se,{}),onClick:O,children:r("DatabaseCard.button.upload")})]}),e(c,{item:!0,xs:1,children:e(x,{fullWidth:!0,disabled:!f,onClick:P,startIcon:e(re,{}),children:r("DatabaseCard.button.download")})}),e(c,{item:!0,xs:1,children:e(x,{fullWidth:!0,disabled:!f,color:"error",onClick:L,startIcon:e(ae,{}),children:r("DatabaseCard.button.delete")})})]}),!!w&&e(l,{noWrap:!0,align:"center",style:{paddingTop:"1.5em"},children:e("strong",{children:new Date(w).toLocaleString()})})]})]})})]})}function Ce(){return e(S,{sx:{my:1},children:e(C,{sx:{display:"flex",flexDirection:"column",gap:2},children:e(de,{})})})}export{Ce as default};
