import{bZ as li,E as ri,z as di,c as _,H as hi,_ as ui,L as te,b_ as to,V as Dt,U as Et,Q as ce,b$ as L,W as gi,c0 as cc,c1 as lc,T as R,w as pi,c2 as no,c3 as mi,c4 as rc,a3 as dc,c5 as hc,a6 as uc,c6 as fi,u as J,aL as Rn,aJ as gc,c7 as pc,c8 as mc,c9 as fc,ca as $i,a$ as yi,a_ as bi,cb as P,cc as $c,cd as yc,bv as A,b4 as bc,b5 as xc,ce as Mt,cf as _c,cg as wc,ch as xi,ci as It,cj as vc,j as o,ck as Tt,cl as le,bn as Q,bw as zn,cm as kc,d as x,al as G,ay as rt,cn as Rt,h as H,av as W,bQ as _i,co as Cc,cp as wi,cq as vi,cr as Bn,cs as ee,ad as En,n as M,ct as Sc,cu as ki,bD as Dc,k as Ci,bU as Mc,e as Y,G as j,C as re,S as ne,N as Ic,bH as Tc,bb as In,bV as oo,bl as Si,aV as at,bW as Rc,bX as zc,I as Pn,q as Vn,a1 as Bc,cv as Ec,s as ct,M as On,aK as Pt,ab as Di,ac as Mi,cw as Pc,i as Vc,l as Oc,m as Ac,ba as qc,D as Fc,bY as Lc,cx as jc,o as Ii,r as Hc,a as Wc,b as Kc,g as Nc,br as Ti,bz as Ri,bx as zi,cy as Gc,y as Uc,cz as Jc,x as dt,B as de,cA as An,F as ht,cB as Bi,cC as Zc,ag as qn,af as Qc,aW as st,ao as Yc,b1 as Xc,cD as el,cE as tl,cF as nl,aF as Ei,aD as Ct,ah as ol,cG as al,bt as sl,cH as il,aI as cl,cI as ll,cJ as rl,bT as dl,cK as hl,cL as ul,cM as U,cN as Pi,a4 as ao,b3 as so,cO as gl,cP as pl,b9 as Vi,cQ as ml,cR as w,cS as Fn,cT as p,cU as g,aw as z,aB as $,cV as fl,bC as $l}from"./index-q28bSghv.js";import{u as Oi}from"./useDataEntryBase-BrIdg3nn.js";import{i as yl,d as bl}from"./discSortUtil-D8f7t1DI.js";function xl(e){const{badgeContent:t,invisible:n=!1,max:a=99,showZero:s=!1}=e,c=li({badgeContent:t,max:a});let i=n;n===!1&&t===0&&!s&&(i=!0);const{badgeContent:l,max:d=a}=i?c:e,h=l&&Number(l)>d?`${d}+`:l;return{badgeContent:l,invisible:i,max:d,displayValue:h}}function _l(e){return di("MuiBadge",e)}const X=ri("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),wl=["anchorOrigin","className","classes","component","components","componentsProps","children","overlap","color","invisible","max","badgeContent","slots","slotProps","showZero","variant"],dn=10,hn=4,vl=e=>{const{color:t,anchorOrigin:n,invisible:a,overlap:s,variant:c,classes:i={}}=e,l={root:["root"],badge:["badge",c,a&&"invisible",`anchorOrigin${L(n.vertical)}${L(n.horizontal)}`,`anchorOrigin${L(n.vertical)}${L(n.horizontal)}${L(s)}`,`overlap${L(s)}`,t!=="default"&&`color${L(t)}`]};return gi(l,_l,i)},kl=Et("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,t)=>t.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Cl=Et("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${L(n.anchorOrigin.vertical)}${L(n.anchorOrigin.horizontal)}${L(n.overlap)}`],n.color!=="default"&&t[`color${L(n.color)}`],n.invisible&&t.invisible]}})(({theme:e})=>{var t;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:dn*2,lineHeight:1,padding:"0 6px",height:dn*2,borderRadius:dn,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.keys(((t=e.vars)!=null?t:e).palette).filter(n=>{var a,s;return((a=e.vars)!=null?a:e).palette[n].main&&((s=e.vars)!=null?s:e).palette[n].contrastText}).map(n=>({props:{color:n},style:{backgroundColor:(e.vars||e).palette[n].main,color:(e.vars||e).palette[n].contrastText}})),{props:{variant:"dot"},style:{borderRadius:hn,height:hn*2,minWidth:hn*2,padding:0}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${X.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${X.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${X.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${X.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${X.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="right"&&n.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${X.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="top"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${X.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:n})=>n.anchorOrigin.vertical==="bottom"&&n.anchorOrigin.horizontal==="left"&&n.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${X.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]}}),io=_.forwardRef(function(t,n){var a,s,c,i,l,d;const h=hi({props:t,name:"MuiBadge"}),{anchorOrigin:b={vertical:"top",horizontal:"right"},className:S,component:k,components:m={},componentsProps:y={},children:v,overlap:C="rectangular",color:V="default",invisible:K=!1,max:N=99,badgeContent:Z,slots:F,slotProps:O,showZero:q=!1,variant:I="standard"}=h,T=ui(h,wl),{badgeContent:ae,invisible:Yi,max:Xi,displayValue:ec}=xl({max:N,invisible:K,badgeContent:Z,showZero:q}),tc=li({anchorOrigin:b,color:V,overlap:C,variant:I,badgeContent:Z}),Jn=Yi||ae==null&&I!=="dot",{color:nc=V,overlap:oc=C,anchorOrigin:ac=b,variant:Zn=I}=Jn?tc:h,Qn=Zn!=="dot"?ec:void 0,cn=te({},h,{badgeContent:ae,invisible:Jn,max:Xi,displayValue:Qn,showZero:q,anchorOrigin:ac,color:nc,overlap:oc,variant:Zn}),Yn=vl(cn),Xn=(a=(s=F==null?void 0:F.root)!=null?s:m.Root)!=null?a:kl,eo=(c=(i=F==null?void 0:F.badge)!=null?i:m.Badge)!=null?c:Cl,ln=(l=O==null?void 0:O.root)!=null?l:y.root,rn=(d=O==null?void 0:O.badge)!=null?d:y.badge,sc=to({elementType:Xn,externalSlotProps:ln,externalForwardedProps:T,additionalProps:{ref:n,as:k},ownerState:cn,className:Dt(ln==null?void 0:ln.className,Yn.root,S)}),ic=to({elementType:eo,externalSlotProps:rn,ownerState:cn,className:Dt(Yn.badge,rn==null?void 0:rn.className)});return ce.jsxs(Xn,te({},sc,{children:[v,ce.jsx(eo,te({},ic,{children:Qn}))]}))});function Sl(e){return di("MuiFormControlLabel",e)}const it=ri("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Dl=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],Ml=e=>{const{classes:t,disabled:n,labelPlacement:a,error:s,required:c}=e,i={root:["root",n&&"disabled",`labelPlacement${L(a)}`,s&&"error",c&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",s&&"error"]};return gi(i,Sl,t)},Il=Et("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${it.label}`]:t.label},t.root,t[`labelPlacement${L(n.labelPlacement)}`]]}})(({theme:e,ownerState:t})=>te({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${it.disabled}`]:{cursor:"default"}},t.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},t.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},t.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${it.label}`]:{[`&.${it.disabled}`]:{color:(e.vars||e).palette.text.disabled}}})),Tl=Et("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})(({theme:e})=>({[`&.${it.error}`]:{color:(e.vars||e).palette.error.main}})),Rl=_.forwardRef(function(t,n){var a,s;const c=hi({props:t,name:"MuiFormControlLabel"}),{className:i,componentsProps:l={},control:d,disabled:h,disableTypography:b,label:S,labelPlacement:k="end",required:m,slotProps:y={}}=c,v=ui(c,Dl),C=cc(),V=(a=h??d.props.disabled)!=null?a:C==null?void 0:C.disabled,K=m??d.props.required,N={disabled:V,required:K};["checked","name","onChange","value","inputRef"].forEach(T=>{typeof d.props[T]>"u"&&typeof c[T]<"u"&&(N[T]=c[T])});const Z=lc({props:c,muiFormControl:C,states:["error"]}),F=te({},c,{disabled:V,labelPlacement:k,required:K,error:Z.error}),O=Ml(F),q=(s=y.typography)!=null?s:l.typography;let I=S;return I!=null&&I.type!==R&&!b&&(I=ce.jsx(R,te({component:"span"},q,{className:Dt(O.label,q==null?void 0:q.className),children:I}))),ce.jsxs(Il,te({className:Dt(O.root,i),ownerState:F,ref:n},v,{children:[_.cloneElement(d,N),K?ce.jsxs(pi,{display:"block",children:[I,ce.jsxs(Tl,{ownerState:F,"aria-hidden":!0,className:O.asterisk,children:["â€‰","*"]})]}):I]}))}),zl={};class Ai{constructor(t,n){this.root=new Bl(t,n)}subset(t){const n=[];return this._subset(t,a=>n.push(...a[no].map(s=>s.value))),n}entries(t){const n=[];return this._subset(t,a=>n.push(...a[no])),n}_subset(t,n){const a=t.length;function s(c,i){c<a?i.subset(t[c]).forEach(l=>s(c+1,l)):n(i.leaf)}s(0,this.root)}}let Bl=class qi{constructor(t,n){if(this.children=[],t>0)for(const[a,s]of Object.entries(n)){const c=new Map;for(const[i,l]of Object.entries(s))c.set(+i,new qi(t-1,l));this.children.push({mask:+a,map:c})}else this.leaf=n}subset(t){return this.children.map(({mask:n,map:a})=>a.get(t&n)).filter(n=>!!n)}};class co{constructor(t){this.root=new Ln(void 0),this.keys=t}at(t){const n=this.keys.get(t),a=n.reduce((s,c)=>s.child(c),this.root);return a.leaf||(a.leaf=new jn(t,n,this.keys,a)),a.leaf}}class Ln{constructor(t){this.children=new Map,this.parent=t}child(t){let n=this.children.get(t);return n||(n=new Ln(this),this.children.set(t,n),n)}}class jn{constructor(t,n,a,s){this.tag=Object.fromEntries(Object.entries(t).filter(([c,i])=>i!=null)),this.id=n,this.keys=a,this.internal=s}with(t){const{keys:n}=this,{id:a,firstReplacedByte:s}=n.combine(this.id,t);let c=this.internal;for(let i=s;i<n.tagLen;i++)c=c.parent;for(let i=s;i<n.tagLen;i++)c=c.child(a[i]);return c.leaf||(c.leaf=new jn({...this.tag,...t},a,n,c)),c.leaf}}class El{constructor(t,n){this.keys=new mi(t),this.values=new Ai(t.tagLen,n)}subset(t){return this.values.subset(this.keys.get(t))}}const lt={sum:e=>e.reduce((t,n)=>t+n,0),prod:e=>e.reduce((t,n)=>t*n,1),min:e=>Math.min(...e),max:e=>Math.max(...e),sumfrac:([e,t])=>e/(e+t),unique:([e])=>e},Fi={match:([e,t])=>e===t?0:1,thres:([e,t])=>e>=t?0:1,lookup:([e],t)=>t[e]??0},wt=e=>hc(e,"val");let Li=class{constructor(t,...n){const a=new mi(t);this.nodes=new Ai(a.tagLen,rc(n)),this.cache=new co(a).at({}),this.calc=new co(a).at({}),this.calc.val=this}withTag(t){const n=this.calc.with(t);return n.val??(n.val=Object.assign(new this.constructor(this.cache.keys),this,{cache:this.cache.with(t),calc:n}))}gather(t){return this._gather(this.cache.with(t)).pre}compute(t){return this._compute(t,this.cache)}_gather(t){if(t.val)return t.val;const n=this.nodes.entries(t.id).flatMap(({tag:a,value:s})=>s.op==="reread"?this._gather(t.with(s.tag)).pre:[this.markGathered(t.tag,a,s,this._compute(s,t))]);return t.val={pre:n}}_compute(t,n){const a=(c,i,l,d)=>Object.freeze({val:c,meta:this.computeMeta(t,c,i,l,d)}),{op:s}=t;switch(s){case"const":return a(t.ex,[],[]);case"sum":case"prod":case"min":case"max":case"sumfrac":{const c=t.x.map(i=>this._compute(i,n));return a(lt[s](wt(c)),c,[])}case"thres":case"match":case"lookup":{const c=t.br.map(h=>this._compute(h,n)),i=Fi[s](wt(c),t.ex),l=[...Array(t.x.length)],d=l[i]=this._compute(t.x[i],n);return a(d.val,l,c)}case"subscript":{const c=this._compute(t.br[0],n);return a(t.ex[c.val],[],[c])}case"vtag":return a(n.tag[t.ex]??"",[],[]);case"tag":{const c=n.with(t.tag),i=this._compute(t.x[0],c);return a(i.val,[i],[],c.tag)}case"dtag":{const c=t.br.map(d=>this._compute(d,n)),i=n.with(Object.fromEntries(c.map((d,h)=>[t.ex[h],d.val]))),l=this._compute(t.x[0],i);return a(l.val,[l],c,i.tag)}case"read":{const c=n.with(t.tag),i=this._gather(c),{pre:l}=i,d=t.ex??this.defaultAccu(c.tag)??"unique";if(d!==t.ex&&(t={...t,ex:d}),i[d])return i[d];if(uc()&&d==="unique"&&l.length!==1)throw new Error(`Ill-form read for ${fi(c.tag)}`);const h=lt[d](wt(l));return i[d]=a(h,l,[],c.tag)}case"custom":{const c=t.x.map(i=>this._compute(i,n));return a(zl[t.ex].calc(wt(c)),c,[])}default:dc(s)}}defaultAccu(t){}markGathered(t,n,a,s){return s}computeMeta(t,n,a,s,c){}toDebug(){throw new Error("not implemented")}};const Pl={arithmetic:lt,branching:Fi};class Vl extends Li{constructor(t,n=fi,a=()=>!0){super(t.cache.keys),this.gathering=new Set,this.nodes=t.nodes,this.tagStr=n,this.filter=a,this.defaultAccu=s=>t.defaultAccu(s),this.cache=this.cache.with(t.cache.tag)}withTag(t){throw new Error("Unimplemented")}_gather(t){if(this.gathering.has(t))throw new Error(`Loop detected for ${this.tagStr(t.tag)}`);this.gathering.add(t);const n=this.__gather(t);return this.gathering.delete(t),n}__gather(t){if(t.val)return t.val;const n=this.nodes.entries(t.id).flatMap(({tag:a,value:s})=>s.op==="reread"?this._gather(t.with(s.tag)).pre.map(c=>{const i=`${this.tagStr(a)} <= ${this.tagStr(s.tag)} : ${c.meta.readSeq}`;return Object.freeze({...c,meta:{...c.meta,readSeq:i}})}):[this.markGathered(t.tag,a,s,this._compute(s,t))]);return t.val={pre:n}}_compute(t,n){try{return super._compute(t,n)}catch(a){return Object.freeze({val:NaN,meta:{formula:`${a}`,deps:[],omitted:[],val:NaN,x:[],br:[],comp:"ERR",pivot:!0,toJSON:ro}})}}markGathered(t,n,a,s){const c=`${this.tagStr(n)} <- ${this.tagStr(t)}`;return{...s,meta:{...s.meta,readSeq:c,pivot:!0}}}computeMeta(t,n,a,s,c){let i,l;const d=a.filter(m=>m).map(m=>m.meta),h=s.map(m=>m.meta),b=[],S=t.op==="read"?t.ex:t.op,k=[];if(S in lt){const m=lt[S]([]);for(const y of[...h,...d])y.val!==m||this.filter(y)?b.push(y):k.push(y)}else b.push(...h,...d);switch(t.op){case"const":i=lo(t.ex);break;case"read":l=`gather ${d.length} node(s)`,l+=` matching ${this.tagStr(c,t.ex)}`,l+=` (for ${this.tagStr(t.tag)})`,k.length&&(l+=` <${k.length} omitted>`),i=`${this.tagStr(t.tag)}`;break;default:{const m=[];t.ex&&t.op!=="subscript"&&m.push(JSON.stringify(t.ex)),t.tag&&m.push(this.tagStr(t.tag)),m.push(...b.map(y=>y.comp)),k.length&&m.push(`<${k.length} omitted>`),i=`${t.op}(`+m.join(", ")+")"}}return k.push(...b.flatMap(m=>m.pivot?[]:m.omitted)),Object.freeze({formula:`[${lo(n)}] ${l??i}`,deps:[...new Set(b.flatMap(m=>m.pivot?[m]:m.deps))],omitted:[...new Set(k)],val:n,x:d,br:h,comp:i,pivot:t.op==="read",toJSON:ro})}}const lo=e=>typeof e=="string"?`"${e}"`:e.toString();function ro(){const{formula:e,readSeq:t,deps:n}=this,a={readSeq:t,formula:e,deps:n};return a.readSeq||delete a.readSeq,a.deps.length||delete a.deps,Object.keys(a).length===1?a.formula:a}function Vt(e){const{database:t}=J();return Rn(t.chars,e)}function Ol(e){const{database:t}=J();return Rn(t.charOpts,e)}function Al(e){const{database:t}=J();return Rn(t.discs,e??"")}const{arithmetic:ql}=Pl;let Fl=class extends Li{computeMeta({op:t,ex:n,tag:a},s,c,i,l){let d=c.filter(m=>!!m);const h=Ll(d,i);function b(m){return Object.freeze(l&&!m.tag?{tag:l,...m}:m)}function S(m,y){return b({op:m,ops:y,...h})}function k(m,y){let{meta:v}=m;return y!=null&&y.some(C=>!v.usedCats.has(C))&&(v={...v,usedCats:new Set([...v.usedCats,...y])}),b(v.conds===h.conds?v:{...v,...h})}if(t==="read"&&(l==null?void 0:l.qt)==="cond"){const{src:m,dst:y,sheet:v,q:C}=l;m&&v&&C&&(h.conds=zt(h.conds,{[y??"All"]:{[m]:{[v]:{[C]:s}}}}))}switch(t==="read"&&n!=="unique"&&([t,n]=[n,void 0]),t){case"sum":case"prod":case"min":case"max":case"sumfrac":if(d.length>1){const m=ql[t]([]);d=d.filter(y=>y.val!==m)}return d.length===1?k(d[0]):S(d.length?t:"const",d);case"const":case"subscript":return S("const",[]);case"vtag":return h.usedCats=new Set([n]),S("const",[]);case"match":case"thres":case"lookup":case"read":return k(d[0]);case"tag":return k(d[0],Object.keys(a));case"dtag":return k(d[0],n);case"custom":return S(n,d);default:gc(t)}}markGathered(t,n,a,s){const{val:c}=s,i={...s.meta};let l=!1;const d=new Set([...i.usedCats,...Object.keys(n)]);return i.usedCats.size!==d.size&&(i.usedCats=d,l=!0),l?{val:c,meta:Object.freeze(i)}:s}listFormulas(t){return this.gather(t.tag).filter(n=>n.val).map(({val:n,meta:a})=>pc.withTag(a.tag)[n])}listCondFormulas(t){return this.listFormulas(t).map(n=>this.compute(n).meta.conds).reduce(zt,{})}};function Ll(e,t){var i;const n=[...e.map(l=>l.meta),...t.map(l=>l.meta)];let a={},s=new Set;for(const l of n)a=zt(a,l.conds),l.usedCats.forEach(d=>s.add(d));const c=s.size;return s=((i=n.find(l=>l.usedCats.size===c))==null?void 0:i.usedCats)??s,{usedCats:s,conds:a}}function zt(e,t){if(e===t)return e;if(typeof e!="object")throw new Error(`cannot merge ${e} and ${t}`);if(Object.keys(t).length>Object.keys(e).length&&([e,t]=[t,e]),!Object.keys(t).length)return e;let n=!1;const a={...e};for(const[s,c]of Object.entries(t)){const i=a[s],l=s in a?zt(i,c):c;i!==l&&(a[s]=l,n=!0)}return Object.freeze(n?a:e)}function jl(e){const t=new Set(e);return n=>!Hl(n,t)}function Hl(e,t){const n=e.formula.match(/(\S+) (\S+) common.count/);if(!n)return!1;const[,a,s]=n;return s==="own"&&t.has(a)}class Wl extends Fl{toDebug(){return new Vl(this,mc,jl([...yi,...bi]))}defaultAccu(t){var s,c,i,l;const{qt:n,q:a}=t;if(!(!n||!a))switch(t.et){case"own":case"target":return(c=(s=$i[n])==null?void 0:s[a])==null?void 0:c.accu;case"enemy":return(l=(i=fc[n])==null?void 0:i[a])==null?void 0:l.accu;case"team":if(n==="common"&&a==="count")return"sum";throw new Error("non-explicit team value accumulator")}}listFormulas(t){return super.listFormulas(t).filter(n=>n.tag.qt!=="formula"||["standardDmgInst","anomalyDmgInst","anomalyBuildupInst","dazeInst"].includes(n.tag.name??""))}}function St(e,...t){return t.map(({tag:n,value:a})=>({tag:{...n,preset:e},value:a}))}function ji(e,...t){return t.map(({tag:n,value:a})=>({tag:{...n,src:e},value:a}))}function Hi(e){const{lvl:t,promotion:n,basic:a,dodge:s,special:c,chain:i,assist:l,core:d,mindscape:h}=A.char,{char:b,iso:S,[e.key]:k}=P.withAll("sheet",[]);return[b.reread(k),S.reread(k),t.add(e.level),a.add(e.basic),s.add(e.dodge),c.add(e.special),i.add(e.chain),l.add(e.assist),d.add(e.core),n.add(e.promotion),h.add(e.mindscape),Mt.base.crit_.add(.05),Mt.base.crit_dmg_.add(.5)]}function Kl(e){return[P.sheet("agg").reread(P.sheet("wengine")),...e?[A.common.count.sheet(e.key).add(1),A.wengine.lvl.add(e.level),A.wengine.modification.add(e.modification),A.wengine.phase.add(e.phase)]:[]]}function Wi(e,t){const{common:{count:n},initial:a}=_c($i,{sheet:"disc",et:"own"});return[P.sheet("agg").reread(P.sheet("disc")),P.withTag({sheet:"disc",qt:"initial"}).reread(P.sheet("dyn")),...Object.entries(e).map(([s,c])=>wc(a,s).sheet("dyn").add(c)),...Object.entries(t).map(([s,c])=>n.sheet(s).add(c))]}function Nl(e){const t={},n={};return e.forEach(({setKey:a,mainStatKey:s,substats:c,level:i,rarity:l})=>{t[a]=(t[a]??0)+1,n[s]=(n[s]??0)+bc(l,s,i),c.forEach(({key:d,upgrades:h})=>{!d||!h||(n[d]=(n[d]??0)+xc(d,l)*h)})}),Wi(n,t)}function Ki(e){const t=P.with("et","team"),{own:n,enemy:a,teamBuff:s,notOwnBuff:c}=P.sheet("agg").withAll("et",[]);return[e.map(i=>P.withTag({et:"target",dst:i}).reread(P.withTag({et:"own",dst:null,src:i}))),e.flatMap(i=>{const l=n.with("src",i);return e.map(d=>l.reread(s.withTag({dst:i,src:d,name:null})))}),e.flatMap(i=>{const l=n.with("src",i);return e.filter(d=>d!==i).map(d=>l.reread(c.withTag({dst:i,src:d,name:null})))}),e.map(i=>a.reread(P.withTag({et:"enemyDeBuff",dst:null,src:i,name:null}))),e.flatMap((i,l)=>{const{stackIn:d,stackTmp:h}=P.withAll("qt",[]),b=P.withTag({src:i,et:"own"});return[b.with("qt","stackTmp").add($c(d,0,l+1)),b.with("qt","stackOut").add(yc(h.max.with("et","team"),l+1,d))]}),e.map(i=>t.add(P.withTag({src:i,et:"own"})))].flat()}function Ni(e){const t=xi(It,e);return new Wl(It,vc,t)}function Gl(e){return new El(It,xi(It,e))}function Ul({characterKey:e}){return o(Tt,{ns:"charNames_gen",key18:e})}function Jl({attribute:e}){return le[e]}function Zl({characterKey:e,onClick:t,charCardConfig:n}){const{level:a=0,promotion:s=0}=Vt(e)??{},c=Q(e),i=n||{cardWidth:"100%",charImgWidth:"100%",iconsSize:1.7,isEditing:!1,charNameWidth:"191px",charNameVariant:"h6",scrollingBgSize:"200px"},l=_.useCallback(()=>e&&(t==null?void 0:t(e)),[e,t]),d=_.useCallback(h=>o(zn,{onClick:l,sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:h}),[l]);return o(rt,{children:o(kc,{condition:!!t,wrapper:d,children:x(G,{sx:{display:"flex",flexDirection:"column",width:i.cardWidth},children:[o(Ql,{characterKey:e,characterStat:c,charCardConfig:i}),o(Yl,{characterKey:e,characterStat:c,promotion:s,level:a,charCardConfig:i})]})})})}function Ql({characterKey:e,characterStat:t,charCardConfig:n}){const{attribute:a,id:s}=t;return x(G,{sx:i=>({width:"100%",height:"100%",position:"relative",display:"flex",background:`${i.palette[a].main}`,zIndex:1,overflow:"hidden"}),children:[x(G,{sx:{position:"absolute",left:"0",right:"0",display:"flex",transform:"rotate(5deg) translateX(-50%)",zIndex:2},children:[o(ho,{characterKey:e,charCardConfig:n}),o(ho,{characterKey:e,charCardConfig:n})]}),o(G,{src:`https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_vertical_painting/role_vertical_painting_${s}.png`,component:Rt?Rt:"img",width:n.charImgWidth,height:"auto",position:"relative",zIndex:"2"})]})}function Yl({characterKey:e,characterStat:t,promotion:n,level:a,charCardConfig:s}){const{t:c}=H("page_characters"),{attribute:i,rarity:l,specialty:d}=t,h=Vt(e);return o(G,{sx:{width:"100%",height:"100%",padding:"8px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:x(G,{sx:{display:"flex",flexDirection:"column"},children:[x(G,{gap:1,sx:{display:"flex",alignItems:"center"},children:[o(W,{size:s.iconsSize,src:_i(l)}),o(R,{variant:s.charNameVariant,sx:{fontWeight:"900",maxWidth:s.charNameWidth,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:o(Ul,{characterKey:e})}),o(Cc,{ele:i,iconProps:{sx:{fontSize:`${s.iconsSize}em`}}}),o(W,{size:s.iconsSize,src:wi(d)}),s.isEditing?"":o(R,{variant:"h5",color:"primary",sx:{fontWeight:"900"},children:c("mindscape",{level:h?h.mindscape:0})})]}),s.isEditing?"":x(G,{sx:{mt:"12px",display:"flex",gap:"14px",flexWrap:"wrap"},children:[x(G,{sx:b=>({border:`2px solid ${b.palette.contentZzz.main}`,borderRadius:"20px",display:"flex"}),children:[o(R,{sx:{fontWeight:"900",paddingLeft:"12px",fontSize:"16px"},children:c("charLevel",{level:a})}),x(R,{color:"primary",sx:{fontWeight:"900",paddingLeft:"4px",pr:"10px"},children:["/ ",vi[n]]})]}),x(G,{gap:1.5,sx:{display:"flex",alignItems:"center"},children:[Bn.map((b,S)=>o(io,{anchorOrigin:{vertical:"bottom",horizontal:"left"},badgeContent:`${h?h[b]:0}`,color:"primary",children:o(W,{size:1.9,src:ee(b)})},S)),o(io,{anchorOrigin:{vertical:"bottom",horizontal:"left"},badgeContent:`${h?h.core:0}`,color:"primary",children:o(W,{size:1.9,src:ee("core")})},6)]})]})]})})}function ho({characterKey:e,charCardConfig:t}){const{t:n}=H("charNames_gen"),a={animation:"scroll 16s infinite linear","@keyframes scroll":{"0%":{transform:"translateX(-100%)"},"100%":{transform:"translateX(0)"}}};return o(G,{component:"span",sx:{color:"#000",marginTop:"20px",fontStyle:"italic",fontSize:t.scrollingBgSize,lineHeight:"150px",whiteSpace:"nowrap",textTransform:"uppercase",display:"flex",justifyContent:"center",fontFamily:"Impact",opacity:.1,...a},children:n(`${e}`)})}function Xl({mindscape:e,setMindscape:t}){const{t:n}=H("page_characters");return o(M,{sx:{display:"flex",flexWrap:"wrap",gap:2,mt:"12px"},children:En(1,6).map(a=>o(M,{children:o(rt,{sx:{position:"relative",borderRadius:"40px"},children:o(Rl,{control:o(Sc,{checked:e>=a,onChange:()=>t(a===e?a-1:a)}),label:x(M,{sx:{position:"absolute",top:9,left:e>=a?75:16,transition:"left 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",textAlign:"center"},children:[o(R,{variant:"subtitle1",sx:s=>({fontWeight:900,color:e>=a?s.palette.mindscapeActive.main:s.palette.mindscapeInactive.main}),children:n("mindscape",{level:a})}),o(R,{variant:"subtitle2",sx:s=>({lineHeight:.2,fontWeight:900,color:e>=a?s.palette.mindscapeActive.main:s.palette.mindscapeInactive.main}),children:n("mindscapeTitle")})]}),sx:{margin:0}})})},a))})}function er(e){return{new:t=>e.chars.get(t)?0:1,name:t=>ki.t(t).toString(),level:t=>{const n=e.chars.get(t);return n?n.level*(n.promotion+1):0},rarity:t=>Q(t).rarity??0}}function tr(e){return{attribute:(t,n)=>n.includes(Q(t).attribute),specialtyType:(t,n)=>n.includes(Q(t).specialty),rarity:(t,n)=>n.includes(Q(t).rarity),name:(t,n)=>n===void 0||ki.t(t).toLowerCase().includes(n.toLowerCase()),new:(t,n)=>n===void 0||n===(e.chars.get(t)?"no":"yes")}}const Gi={name:["name"],level:["level","rarity","name"],rarity:["rarity","level","name"]};function h$({show:e,onHide:t,onSelect:n,newFirst:a=!1}){const{database:s}=J(),c=Oi(s.displayCharacter),[i,l]=_.useState(""),d=_.useDeferredValue(i),h=_.useDeferredValue(c),b=_.useMemo(()=>{const{attribute:m,specialtyType:y,sortType:v,ascending:C}=h,V=[...a?["new"]:[],...Gi[v]??[]];return Dc.filter(Ci({attribute:m,specialtyType:y,name:d},tr(s))).sort(Mc(V,C,er(s),["new"]))},[h,a,d,s]);return o(or,{show:e,charactersToShow:b,filterSearchSortProps:{searchTerm:i,onChangeSpecialtyFilter:m=>{s.displayCharacter.set({specialtyType:m})},onChangeAttributeFilter:m=>{s.displayCharacter.set({attribute:m})},onChangeSearch:m=>{l(m.target.value)},onChangeSort:m=>{s.displayCharacter.set({sortType:m})},onChangeAsc:m=>{s.displayCharacter.set({ascending:m})}},onClose:()=>{l(""),t()},children:o(Y,{sx:{flex:"1",overflow:"auto"},children:o(_.Suspense,{fallback:o(ne,{variant:"rectangular",width:"100%",height:1e3}),children:o(j,{container:!0,spacing:.5,columns:{xs:2,sm:3,md:4,lg:5},children:b.map(m=>o(j,{item:!0,xs:1,children:o(re,{bgt:"light",sx:y=>({position:"relative",flexGrow:1,display:"flex",flexDirection:"column",borderRadius:"40px 16px 16px 40px",border:`3px solid ${y.palette.contentZzz.main}`}),children:o(ar,{characterKey:m,onClick:()=>{t(),n(m)}})})},m))})})})})}const nr=Object.keys(Gi);function or({show:e,charactersToShow:t,filterSearchSortProps:n,onClose:a,children:s}){const{t:c}=H("page_characters"),{database:i}=J(),l=Oi(i.displayCharacter),d=_.useMemo(()=>oo(Si,y=>i.chars.entries.forEach(([v,C])=>{const V=Q(C.key).specialty;y[V].total++,t.includes(v)&&y[V].current++})),[t,i.chars.entries]),h=_.useMemo(()=>oo(at,y=>Object.entries(i.chars.data).forEach(([v])=>{const C=Q(v).attribute;y[C].total++,t.includes(v)&&y[C].current++})),[t,i.chars.data]),{specialtyType:b,attribute:S,sortType:k,ascending:m}=l;return o(On,{open:e,onClose:a,containerProps:{sx:{height:"100vh",p:{xs:1}}},children:x(re,{sx:{display:"flex",flexDirection:"column",height:"100%"},children:[x(Y,{sx:{display:"flex",flexDirection:"column",gap:1},children:[x(M,{sx:{display:"flex",justifyContent:"space-between"},children:[x(M,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[o(Rc,{onChange:y=>i.displayCharacter.set({specialtyType:y}),value:b,totals:d,size:"small"}),o(zc,{onChange:y=>i.displayCharacter.set({attribute:y}),value:S,totals:h,size:"small"})]}),o(Pn,{sx:{ml:"auto"},onClick:()=>a(),children:o(Vn,{})})]}),x(M,{display:"flex",gap:1,children:[o(Bc,{autoFocus:!0,value:n.searchTerm,onChange:y=>n.onChangeSearch(y),label:c("characterName"),size:"small",sx:{height:"100%",mr:"auto"},InputProps:{sx:{height:"100%"}}}),o(Ec,{sortKeys:nr,value:k,onChange:y=>n.onChangeSort(y),ascending:m,onChangeAsc:y=>n.onChangeAsc(y)})]})]}),o(ct,{}),s]})})}function ar({characterKey:e,onClick:t}){const{t:n}=H(["page_characters","charNames_gen"]),a=Ic(),s=Vt(e),{rarity:c,attribute:i}=Q(e),{level:l=1,promotion:d=0,mindscape:h=0}=s??{},b=i==="electric"?a.palette[i].light:a.palette[i].main;return o(zn,{onClick:t,children:x(M,{sx:{position:"relative",width:"100%",display:"flex",padding:"3px",gap:.5,"&::before":{content:'""',display:"block",position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:.7,background:b}},children:[o(M,{sx:{maxWidth:{xs:"33%",lg:"30%"},alignSelf:"flex-end",display:"flex",flexDirection:"column",zIndex:1,flexShrink:1},children:o(M,{component:Rt?Rt:"img",src:Tc(e,"interknot")})}),x(M,{sx:{display:"flex",flexDirection:"column",zIndex:1,justifyContent:"space-evenly"},children:[x(M,{sx:{display:"flex",alignItems:"center",gap:.5},children:[o(W,{size:1.5,src:_i(c)}),o(R,{variant:"subtitle2",sx:S=>({flexGrow:1,color:S.palette.contentNormal.main,fontWeight:"900"}),children:n(`charNames_gen:${e}`)})]}),s?x(M,{sx:S=>({display:"flex",gap:1,alignItems:"center",background:S.palette.contentNormal.main,padding:"4px 12px",borderRadius:"20px"}),children:[x(M,{sx:{textShadow:"0 0 5px gray"},children:[o(R,{variant:"body2",component:"span",whiteSpace:"nowrap",children:n("charLevel",{level:l})}),x(R,{variant:"body2",component:"span",color:"text.secondary",children:["/",vi[d]]})]}),x(R,{variant:"body2",children:["M",h]})]}):o(R,{component:"span",variant:"body2",children:o(In,{color:"electric",children:n("characterEditor.new")})})]})]})})}function sr(){const{t:e}=H("page_characters"),{database:t}=J(),n=Pt(),{core:a=0,promotion:s=0,key:c}=n??{},i=_.useCallback(l=>c&&t.chars.set(c,{core:l}),[t,c]);return o(Mi,{fullWidth:!0,title:e("core",{level:a}),color:"primary",startIcon:o(W,{src:ee("core"),size:1.75,sideMargin:!0}),children:En(0,Pc[s]).map(l=>o(Di,{selected:a===l,disabled:a===l,onClick:()=>i(l),children:e("core",{level:l})},l))})}const ir={xs:2*3,sm:2*3,md:3*3,lg:4*3,xl:4*3};function Ui({disc:e,onChangeId:t,slotKey:n,show:a,onClose:s}){const{t:c}=H(["page_characters","disc"]),{database:i}=J(),l=e==null?void 0:e.id,d=_.useCallback((I,T)=>({...I,...T,slotKeys:[n]}),[n]),[h,b]=_.useReducer(d,{...yl(),slotKeys:[n]}),[S,k]=Vc();_.useEffect(()=>i.discs.followAny(k),[i,k]);const m=Oc(),y=_.useMemo(()=>bl(),[]),v=i.discs.values.filter(I=>I.slotKey===h.slotKeys[0]).length,C=_.useMemo(()=>{const I=Ci(h,y);let T=i.discs.values.filter(I).map(ae=>ae.id);return l&&i.discs.get(l)&&(T=T.filter(ae=>ae!==l),T.unshift(l)),S&&T},[h,y,i.discs,l,S]),{numShow:V,setTriggerElement:K}=Ac(ir[m],C.length),N=_.useMemo(()=>C.slice(0,V),[C,V]),Z=C.length!==v?`${C.length}/${v}`:`${v}`,F={numShowing:N.length,total:Z,t:c,namespace:"disc"},[O,q]=_.useState("");return _.useEffect(()=>{qc.includes(O)?(t(null),q(""),s()):O&&(t(O),q(""),s())},[t,s,O]),o(On,{open:a,onClose:s,containerProps:{maxWidth:"xl"},children:x(re,{children:[x(Y,{sx:{py:1,display:"flex",alignItems:"center"},children:[o(R,{variant:"h6",children:c("tabEquip.swapDisc")}),o(Pn,{onClick:s,sx:{ml:"auto"},children:o(Vn,{})})]}),o(ct,{}),o(Y,{children:o(_.Suspense,{fallback:o(ne,{variant:"rectangular",width:"100%",height:200}),children:o(Fc,{filterOption:h,filterOptionDispatch:b,filteredIds:C,disableSlotFilter:!0})})}),o(ct,{}),x(Y,{children:[o(M,{pb:1,display:"flex",justifyContent:"space-between",alignItems:"flex-end",flexWrap:"wrap",children:o(Lc,{showingTextProps:F})}),o(M,{mt:1,children:o(_.Suspense,{fallback:o(ne,{variant:"rectangular",width:"100%",height:1e3}),children:x(j,{container:!0,spacing:1,columns:{xs:2,md:3,lg:4},children:[l&&o(j,{item:!0,xs:1,children:o(re,{bgt:"light",sx:{width:"100%",height:"100%"},children:o(zn,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>q(n),children:x(M,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[o(jc,{sx:{fontSize:"10em"}}),o(R,{children:c("disc:button.unequipDisc")})]})})})}),N.map(I=>o(j,{item:!0,xs:1,sx:T=>({...l===I&&{"> .MuiCard-root":{outline:`${T.spacing(.5)} solid ${T.palette.warning.main}`}}}),children:o(Ii,{disc:i.discs.get(I),onClick:l===I?void 0:()=>q(I)})},I))]})})}),C.length!==N.length&&o(ne,{ref:I=>{I&&K(I)},sx:{borderRadius:1,mt:1},variant:"rectangular",width:"100%",height:100})]})]})})}function cr(e){return"fieldRef"in e}var nt={},uo;function lr(){if(uo)return nt;uo=1;var e=Hc();Object.defineProperty(nt,"__esModule",{value:!0}),nt.default=void 0;var t=e(Wc()),n=Kc(),a=(0,t.default)((0,n.jsx)("path",{d:"M6.99 11 3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"}),"SwapHoriz");return nt.default=a,nt}var rr=lr();const ut=Nc(rr),dr={xs:1,sm:2,md:3,lg:3,xl:3};function hr({setWengine:e,setDisc:t}){const{database:n}=J(),a=_.useContext(Ti),[s,c]=_.useState(),[i,l]=_.useState(""),d=_.useCallback(y=>{l(y)},[]),h=_.useCallback(y=>{c(y)},[]),b=Ri(a==null?void 0:a.equippedWengine),S=a?Q(a.key).specialty:Si[0],k=zi(a==null?void 0:a.equippedDiscs),m=Al(s);return o(M,{children:x(pi,{spacing:2,children:[o(_.Suspense,{fallback:!1,children:i&&o(Gc,{wengineId:i,footer:!0,onClose:()=>l(""),extraButtons:o(fr,{wengineId:(b==null?void 0:b.id)||"",wengineTypeKey:S,onChangeId:e})})}),o(_.Suspense,{fallback:!1,children:m&&o(Uc,{disc:m,show:!!s,onShow:()=>c(s),onClose:()=>c(void 0),cancelEdit:()=>c(void 0)})}),o(M,{children:b&&b.id&&n.wengines.keys.includes(b.id)?o(Jc,{wengineId:b.id,onEdit:()=>d(b.id),extraButtons:o(mr,{wengineId:b.id,wengineTypeKey:S,onChangeId:e})}):o(ur,{wengineId:"",wengineTypeKey:S,onChangeId:e})}),o(M,{children:o(j,{item:!0,columns:dr,container:!0,spacing:1,children:!!k&&Object.entries(k).map(([y,v])=>o(j,{item:!0,xs:1,children:v!=null&&v.id&&n.discs.keys.includes(v.id)?o(Ii,{disc:v,extraButtons:o(pr,{disc:v,slotKey:y,onChangeId:C=>t(y,C)}),onEdit:()=>h(v.id),onLockToggle:()=>n.discs.set(v.id,({lock:C})=>({lock:!C}))}):o(gr,{slotKey:y,onChangeId:C=>t(y,C)})},(v==null?void 0:v.id)||y))})})]})})}function ur({wengineId:e,wengineTypeKey:t,onChangeId:n}){const[a,s,c]=dt();return x(rt,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[o(Y,{children:x(R,{children:[o(W,{src:wi(t)})," "]})}),o(ct,{}),x(M,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[o(An,{wengineId:e,wengineTypeKey:t,show:a,onClose:c,onChangeId:n}),o(de,{onClick:s,color:"info",sx:{borderRadius:"1em"},children:o(ut,{sx:{height:100,width:100}})})]})]})}function gr({slotKey:e,onChangeId:t}){const[n,a,s]=dt(),{t:c}=H("disc");return x(rt,{bgt:"light",sx:{height:"100%",width:"100%",minHeight:300,display:"flex",flexDirection:"column"},children:[o(Y,{children:o(R,{children:c("slotName",{slotKey:e})})}),o(ct,{}),x(M,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:[o(Ui,{disc:void 0,slotKey:e,show:n,onClose:s,onChangeId:t}),o(de,{onClick:a,color:"info",sx:{borderRadius:"1em"},children:o(ut,{sx:{height:100,width:100}})})]})]})}function pr({disc:e,slotKey:t,onChangeId:n}){const{t:a}=H("page_characters"),[s,c,i]=dt();return x(ht,{children:[o(Bi,{title:o(R,{children:a("tabEquip.swapDisc")}),placement:"top",arrow:!0,children:o(de,{color:"info",size:"small",onClick:c,"aria-label":a("tabEquip.swapDisc"),children:o(ut,{})})}),o(Ui,{disc:e,slotKey:t,show:s,onClose:i,onChangeId:n})]})}function mr({wengineId:e,wengineTypeKey:t,onChangeId:n}){const{t:a}=H("page_characters"),[s,c,i]=dt();return x(ht,{children:[o(Bi,{title:o(R,{children:a("tabEquip.swapWengine")}),placement:"top",arrow:!0,children:o(de,{color:"info",size:"small",onClick:c,children:o(ut,{})})}),o(An,{wengineId:e,wengineTypeKey:t,onChangeId:n,show:s,onClose:i})]})}function fr({wengineId:e,wengineTypeKey:t,onChangeId:n}){const{t:a}=H("page_characters"),[s,c,i]=dt();return x(ht,{children:[o(de,{color:"info",onClick:c,startIcon:o(ut,{}),children:a("tabEquip.swapWengine")}),o(An,{wengineId:e,wengineTypeKey:t,onChangeId:n,show:s,onClose:i})]})}function $r({skillKey:e}){const{database:t}=J(),{t:n}=H("page_characters"),a=Pt(),{[e]:s=0,promotion:c=0,key:i}=a??{},l=_.useCallback(d=>i&&t.chars.set(i,{[e]:d}),[t,i,e]);return o(Mi,{fullWidth:!0,title:n(e,{level:s}),color:"primary",startIcon:o(W,{src:ee(e),size:1.75,sideMargin:!0}),children:En(1,Zc[c]).map(d=>o(Di,{selected:s===d,disabled:s===d,onClick:()=>l(d),children:n(e,{level:d})},d))})}function Ot(){const e=_.useContext(qn),t=_.useContext(Qc);return _.useMemo(()=>e==null?void 0:e.withTag(t),[e,t])}const yr=(e,t)=>o(Tt,{ns:"sheet",key18:e,values:t});function u(e,t){return[(n,a)=>o(Tt,{ns:`${e}_${t}_gen`,key18:n,values:a}),(n,a)=>o(Tt,{ns:`${e}_${t}`,key18:n,values:a})]}function r(e){return{title:o(At,{tag:e}),fieldRef:e}}function br(e){if(!e)return"";const{et:t,q:n,qt:a,name:s}=e;return t==="own"&&a==="formula"&&n!=="base"?s??n??"":n??""}const xr={initial:"Initial",combat:"Combat",final:"Final",base:"Base"};function At({tag:e,showPercent:t,preventRecursion:n}){return o(st,{color:n$(e),children:o(vr,{tag:e,showPercent:t,preventRecursion:n})})}function u$({tag:e,showPercent:t}){return x(ht,{children:[o(At,{tag:e,showPercent:t}),a$(e).map(n=>o(In,{children:Bt[n]},n)),e.attribute&&o(In,{color:e.attribute,children:o(Jl,{attribute:e.attribute})})]})}const _r=["hp","hp_","atk","atk_","def","def_"],wr=e=>_r.includes(e),go={dmg_:"DMG",common_dmg_:"DMG",defIgn_:"DEF Ignore",resIgn_:"Res Ignore"};function vr({tag:e,showPercent:t,preventRecursion:n}){var i;const a=Ot(),s=(i=s$.subset(e)[0])==null?void 0:i.title;if(s&&!n)return s;if(e.qt==="cond"&&e.q&&e.sheet&&a){const l=Tn.get(`${e.sheet}:${e.q}`);if(l)return Yc(l.label,a,a==null?void 0:a.compute(new Xc(e,"max")).val)}const c=br(e);if(wr(c))return x("span",{children:[o(tl,{statKey:c,iconProps:el})," ",x("span",{children:[(e.qt&&xr[e.qt])??e.qt," ",nl[c],t&&Ei(c)]})]});if(go[c]){const l=[...e.attribute?[le[e.attribute]]:[],...e.damageType1?[Bt[e.damageType1]]:[],...e.damageType2?[Bt[e.damageType2]]:[],go[c]];return o("span",{children:l.join(" ")})}return o(Ct,{statKey:c,showPercent:t})}function kr(){const e=Ot();return o(rt,{children:o(Y,{children:e==null?void 0:e.listFormulas(A.listing.formulas).map((t,n)=>o(Cr,{read:t},n))})})}function Cr({read:e}){var v,C,V,K,N,Z,F;const t=Ot(),{setRead:n}=_.useContext(ol),a=Pt(),s=Ol(a==null?void 0:a.key),c=e.tag.sheet===((v=s==null?void 0:s.target)==null?void 0:v.sheet)&&e.tag.name===((C=s==null?void 0:s.target)==null?void 0:C.name)||((V=s==null?void 0:s.target)==null?void 0:V.q)===e.tag.q,i=_.useMemo(()=>{var O,q,I,T;return e.tag.sheet===((O=s==null?void 0:s.target)==null?void 0:O.sheet)&&e.tag.name===((q=s==null?void 0:s.target)==null?void 0:q.name)?al(e.tag,(I=s==null?void 0:s.target)==null?void 0:I.damageType1,(T=s==null?void 0:s.target)==null?void 0:T.damageType2):e.tag},[e.tag,(K=s==null?void 0:s.target)==null?void 0:K.sheet,(N=s==null?void 0:s.target)==null?void 0:N.name,(Z=s==null?void 0:s.target)==null?void 0:Z.damageType1,(F=s==null?void 0:s.target)==null?void 0:F.damageType2]),l=_.useMemo(()=>({...e,tag:i}),[i,e]),d=t==null?void 0:t.compute(l),h=i.name||i.q,{statHighlight:b,setStatHighlight:S}=_.useContext(sl),k=i.name?"":i.attribute?`${i.attribute}_${i.q}`:i.q==="cappedCrit_"?"crit_":i.q,m=k?il(b,k):!1;if(!d)return null;const y=cl(d.val,Ei(h??""));return x(M,{onMouseEnter:()=>k&&S(k),onMouseLeave:()=>S(""),sx:{display:"flex",gap:1,alignItems:"center",p:.5,borderRadius:.5,backgroundColor:c?"rgba(0,200,0,0.2)":void 0,position:"relative","::after":{content:'""',position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:.5,backgroundColor:ll(m),transition:"background-color 0.3s ease-in-out",pointerEvents:"none"}},children:[o(M,{sx:{flexGrow:1},children:o(At,{tag:i})}),y,o(rl,{tag:i,onClick:()=>{}})]})}function g$({characterKey:e,onClose:t}){return o(On,{open:!!e,onClose:t,children:o(_.Suspense,{fallback:o(ne,{variant:"rectangular",width:"100%",height:1e3}),children:e&&o(Sr,{characterKey:e,onClose:t},e)})})}function Sr({characterKey:e,onClose:t}){const n=Vt(e);return o(re,{children:o(Y,{sx:{display:"flex",flexDirection:"column",gap:1},children:o(_.Suspense,{fallback:o(ne,{variant:"rectangular",width:"100%",height:1e3}),children:n?o(Ti.Provider,{value:n,children:o(Mr,{onClose:t})}):o(ne,{variant:"rectangular",width:"100%",height:1e3})})})})}const Dr={cardWidth:"500px",charImgWidth:"75%",iconsSize:1.5,isEditing:!0,charNameWidth:"166px",charNameVariant:"h6",scrollingBgSize:"220px"};function Mr({onClose:e}){const{t}=H(["page_characters"]),n=dl(),{database:a}=J(),s=Pt(),{key:c,equippedDiscs:i,equippedWengine:l}=s,d=_.useCallback(async()=>{const h=t(`${c}`);window.confirm(t("removeCharacter",{value:h}))&&(a.chars.remove(c),n("/characters"))},[a,n,c,t]);return x(M,{display:"flex",flexDirection:"column",gap:1,children:[x(M,{display:"flex",gap:1,children:[o(de,{color:"error",onClick:()=>d(),startIcon:o(hl,{}),sx:{marginLeft:"auto"},children:t("characterEditor.delete")}),!!e&&o(Pn,{onClick:e,children:o(Vn,{})})]}),o(M,{children:x(j,{container:!0,spacing:1,sx:{justifyContent:"center"},children:[o(j,{item:!0,xs:6,sm:4,md:4,lg:4,xl:4,children:x(re,{sx:{height:"100%",display:"flex",flexDirection:"column",gap:1},children:[o(Zl,{characterKey:c,charCardConfig:Dr}),o(M,{sx:{px:1},children:o(ul,{level:s.level,milestone:s.promotion,setBoth:({level:h,milestone:b})=>a.chars.set(c,{level:h,promotion:b})})}),o(kr,{}),o(Xl,{mindscape:s.mindscape,setMindscape:h=>a.chars.set(c,{mindscape:h})})]})}),x(j,{item:!0,xs:6,sm:8,md:8,lg:8,xl:8,sx:{display:"flex",flexDirection:"column",gap:1},children:[o(M,{children:x(j,{container:!0,columns:3,spacing:1,children:[Bn.map(h=>o(j,{item:!0,xs:1,children:o($r,{skillKey:h},h)},h)),o(j,{item:!0,xs:1,children:o(sr,{})},"core")]})}),o(M,{children:o(hr,{setWengine:h=>{h?a.wengines.set(h,{location:c}):l&&a.wengines.set(l,{location:""})},setDisc:(h,b)=>{b?a.discs.set(b,{location:c}):i[h]&&a.discs.set(i[h],{location:""})}})})]})]})})]})}function p$({character:e,charOpt:t,wengineId:n,discIds:a,children:s}){const c=Ir(e,n,a),i=_.useMemo(()=>Ni([...Ki([e.key]),...c,Mt.common.critMode.add(t.critMode),U.common.lvl.add(t.enemyLvl),U.common.def.add(t.enemyDef),U.common.isStunned.add(t.enemyisStunned?1:0),U.common.stun_.add(t.enemyStunMultiplier/100),U.common.unstun_.add(1),...t.conditionals.flatMap(({sheet:d,src:h,dst:b,condKey:S,condValue:k})=>St("preset0",Pi(d,h,b)(S,k))),...t.bonusStats.filter(({disabled:d})=>!d).flatMap(({tag:d,value:h})=>St("preset0",{tag:{...d,src:e.key,sheet:"agg",et:"own"},value:ao(so(h,d.q??""))})),...t.enemyStats.flatMap(({tag:d,value:h})=>St("preset0",{tag:{...d,qt:"common",et:"enemy",sheet:"agg"},value:ao(so(h,d.q??""))}))]),[c,t,e.key]),l=_.useMemo(()=>i&&new Map,[i]);return o(gl.Provider,{value:l,children:o(qn.Provider,{value:i,children:s})})}function Ir(e,t,n){const a=Ri(t),s=zi(n),c=_.useMemo(()=>Kl(a),[a]),i=_.useMemo(()=>Nl(Object.values(s).filter(pl)),[s]);return _.useMemo(()=>ji(e.key,...Hi(e),...c,...i),[e,c,i])}function m$({character:e,conditionals:t,children:n}){const a=_.useMemo(()=>Ni([...Ki([e.key]),...ji(e.key,...Hi(e),...Wi({},Vi(bi,()=>4)),P.sheet("agg").reread(P.sheet("wengine")),A.wengine.lvl.add(60),A.wengine.modification.add(5),A.wengine.phase.add(1),...yi.map(s=>A.common.count.sheet(s).add(1))),Mt.common.critMode.add("avg"),U.common.lvl.add(100),U.common.def.add(900),U.common.isStunned.add(0),U.common.stun_.add(1.5),U.common.unstun_.add(1),...t.flatMap(({sheet:s,src:c,dst:i,condKey:l,condValue:d})=>St("preset0",Pi(s,c,i)(l,d)))]),[e,t]);return o(qn.Provider,{value:a,children:n})}function D(e,t={}){return{...Tr(e,t==null?void 0:t.perSkillAbility),core:zr(e,t==null?void 0:t.core,t==null?void 0:t.ability),m1:se(e,1,t==null?void 0:t.m1),m2:se(e,2,t==null?void 0:t.m2),m3:se(e,3,t==null?void 0:t.m3),m4:se(e,4,t==null?void 0:t.m4),m5:se(e,5,t==null?void 0:t.m5),m6:se(e,6,t==null?void 0:t.m6)}}function ot(e){return{title:o(At,{tag:e.tag,preventRecursion:!0}),fieldRef:e.tag}}function Tr(e,t){const n=w.char[e],a=Fn[e],[s,c]=u("char",e);return Vi(Bn,i=>({title:i,img:ee(`${i}Flat`),documents:Object.keys(n[i]).flatMap(l=>{var d;return[{type:"text",header:{icon:o(W,{src:ee(`${i}Flat`),size:1.5}),text:s(`${i}.${l}.name`)},text:s(`${i}.${l}.desc`)},{type:"fields",fields:Object.values(a).filter(h=>h.name.includes(l)).map(h=>({title:Rr(e,i,h.name),fieldRef:h.tag}))},...((d=t==null?void 0:t[i])==null?void 0:d[l])??[]]})}))}function Rr(e,t,n){const[a,s,c]=n.split("_");return yr(c,{val:`$t(char_${e}_gen:${t}.${a}.params.${s})`})}function zr(e,t=[],n=[]){const[a,s]=u("char",e);return{title:"core",documents:[{type:"text",header:{icon:o(W,{src:ee("coreFlat"),size:1.5}),text:a("core.name")},text:c=>a(`core.desc.${c.compute(A.char.core).val}`)},...t,{type:"text",header:{icon:o(W,{src:ee("coreFlat"),size:1.5}),text:a("ability.name")},text:a("ability.desc")},...n]}}function se(e,t,n=[]){const[a,s]=u("char",e);return{title:`mindscape${t}`,documents:[{type:"text",header:{icon:o(W,{src:ml(t),size:1.5}),text:a(`mindscapes.${t}.name`)},text:x(ht,{children:[a(`mindscapes.${t}.desc`),o("br",{}),o("br",{}),o("i",{children:a(`mindscapes.${t}.flavor`)})]})},...n]}}const qt="Anby",[,vt]=u("char",qt),un=p[qt],ie=g[qt],Br=D(qt,{core:[{type:"conditional",conditional:{label:vt("coreCond"),metadata:un.core_after3rdBasic,fields:[{title:vt("core_dazeInc_"),fieldRef:ie.core_after3rdBasic_dazeInc_.tag}]}}],m1:[{type:"conditional",conditional:{label:vt("m1Cond"),metadata:un.m1After4thBasicHit,fields:[ot(ie.m1_after4thHit_energyRegen_)]}}],m2:[{type:"fields",fields:[ot(ie.m2_stunned_basic_dmg_),ot(ie.m2_unstunned_ex_dazeInc_)]}],m6:[{type:"conditional",conditional:{label:vt("m6Cond"),metadata:un.m6ChargeConsumed,fields:[ot(ie.m6_charge_basic_dmg_),ot(ie.m6_charge_exSpecial_dmg_)]}}]}),Er="Anton",Pr=D(Er),Vr="Astra",Or=D(Vr),Ar="Ben",qr=D(Ar),Fr="Billy",Lr=D(Fr),jr="Burnice",Hr=D(jr),Wr="Caesar",Kr=D(Wr),Nr="Corin",Gr=D(Nr),Ur="Ellen",Jr=D(Ur),Zr="Evelyn",Qr=D(Zr),Yr="Grace",Xr=D(Yr),ed="Harumasa",td=D(ed),nd="Hugo",od=D(nd),ad="Jane",sd=D(ad),id="Koleda",cd=D(id),ld="Lighter",rd=D(ld),dd="Lucy",hd=D(dd),ud="Lycaon",gd=D(ud),pd="Miyabi",md=D(pd),fd="Nekomata",$d=D(fd),yd="Nicole",bd=D(yd),xd="Piper",_d=D(xd),wd="Pulchra",vd=D(wd),kd="QingYi",Cd=D(kd),Sd="Rina",Dd=D(Sd),Md="Seth",Id=D(Md),Td="Soldier0Anby",Rd=D(Td),zd="Soldier11",Bd=D(zd),Ed="Soukaku",Pd=D(Ed),Vd="Trigger",Od=D(Vd),Ad="Vivian",qd=D(Ad),Fd="Yanagi",Ld=D(Fd),jd="ZhuYuan",Hd=D(jd),Wd={Anby:Br,Anton:Pr,Astra:Or,Ben:qr,Billy:Lr,Burnice:Hr,Caesar:Kr,Corin:Gr,Ellen:Jr,Evelyn:Qr,Grace:Xr,Harumasa:td,Hugo:od,Jane:sd,Koleda:cd,Lighter:rd,Lucy:hd,Lycaon:gd,Miyabi:md,Nekomata:$d,Nicole:bd,Piper:_d,Pulchra:vd,QingYi:Cd,Rina:Dd,Seth:Id,Soldier0Anby:Rd,Soldier11:Bd,Soukaku:Pd,Trigger:Od,Vivian:qd,Yanagi:Ld,ZhuYuan:Hd},Ft="AstralVoice",[po,Kd]=u("disc",Ft),mo=z(Ft),Nd=p[Ft],Gd=g[Ft],Ud={2:{title:o(B,{}),img:mo,documents:[{type:"text",text:po("desc2")}]},4:{title:o(E,{}),img:mo,documents:[{type:"text",text:po("desc4")},{type:"conditional",conditional:{label:Kd("set4_cond"),metadata:Nd.astral,fields:[r(Gd.set4_team_dmg_.tag)]}}]}},Lt="BranchBladeSong",[fo,Jd]=u("disc",Lt),$o=z(Lt),Zd=p[Lt],yo=g[Lt],Qd={2:{title:o(B,{}),img:$o,documents:[{type:"text",text:fo("desc2")}]},4:{title:o(E,{}),img:$o,documents:[{type:"text",text:fo("desc4")},{type:"fields",fields:[r(yo.set4_passive.tag)]},{type:"conditional",conditional:{label:Jd("set4_cond"),metadata:Zd.apply_or_trigger,fields:[r(yo.set4_cond.tag)]}}]}},jt="ChaosJazz",[bo,Yd]=u("disc",jt),xo=z(jt),Xd=p[jt],kt=g[jt],eh={2:{title:o(B,{}),img:xo,documents:[{type:"text",text:bo("desc2")}]},4:{title:o(E,{}),img:xo,documents:[{type:"text",text:bo("desc4")},{type:"fields",fields:[r(kt.set4_passive_fire_dmg_.tag),r(kt.set4_passive_electric_dmg_.tag)]},{type:"conditional",conditional:{label:Yd("set4_cond"),metadata:Xd.while_off_field,fields:[{title:"EX Special Attack DMG",fieldRef:kt.set4_off_field_special_dmg_.tag},{title:"Assist Attack Attack DMG",fieldRef:kt.set4_off_field_assist_dmg_.tag}]}}]}},Ht="ChaoticMetal",[_o,th]=u("disc",Ht),wo=z(Ht),nh=p[Ht],vo=g[Ht],oh={2:{title:o(B,{}),img:wo,documents:[{type:"text",text:_o("desc2")}]},4:{title:o(E,{}),img:wo,documents:[{type:"text",text:_o("desc4")},{type:"fields",fields:[r(vo.set4_passive.tag)]},{type:"conditional",conditional:{label:th("set4_cond"),metadata:nh.trigger_corruption,fields:[r(vo.set4_cond_trigger_corruption.tag)]}}]}},Wt="FangedMetal",[ko,ah]=u("disc",Wt),Co=z(Wt),sh=p[Wt],ih=g[Wt],ch={2:{title:o(B,{}),img:Co,documents:[{type:"text",text:ko("desc2")}]},4:{title:o(E,{}),img:Co,documents:[{type:"text",text:ko("desc4")},{type:"conditional",conditional:{label:ah("set4_cond"),metadata:sh.inflict_assault,fields:[r(ih.set4_cond_inflict_assault.tag)]}}]}},Kt="FreedomBlues",[So,lh]=u("disc",Kt),Do=z(Kt),rh=p[Kt],dh=g[Kt],hh={2:{title:o(B,{}),img:Do,documents:[{type:"text",text:So("desc2")}]},4:{title:o(E,{}),img:Do,documents:[{type:"text",text:So("desc4")},{type:"conditional",conditional:{label:lh("set4_cond"),metadata:rh.exSpecialHit,fields:[r(dh.anomBuildupRes_.tag)]}}]}},Nt="HormonePunk",[Mo,uh]=u("disc",Nt),Io=z(Nt),gh=p[Nt],ph=g[Nt],mh={2:{title:o(B,{}),img:Io,documents:[{type:"text",text:Mo("desc2")}]},4:{title:o(E,{}),img:Io,documents:[{type:"text",text:Mo("desc4")},{type:"conditional",conditional:{label:uh("set4_cond"),metadata:gh.entering_combat,fields:[r(ph.set4_cond_entering_combat.tag)]}}]}},Gt="InfernoMetal",[To,fh]=u("disc",Gt),Ro=z(Gt),$h=p[Gt],yh=g[Gt],bh={2:{title:o(B,{}),img:Ro,documents:[{type:"text",text:To("desc2")}]},4:{title:o(E,{}),img:Ro,documents:[{type:"text",text:To("desc4")},{type:"conditional",conditional:{label:fh("set4_cond"),metadata:$h.hitting_burning_enemy,fields:[r(yh.set4_cond_hitting_burning_enemy.tag)]}}]}},Ut="PhaethonsMelody",[zo,Bo]=u("disc",Ut),Eo=z(Ut),Po=p[Ut],Vo=g[Ut],xh={2:{title:o(B,{}),img:Eo,documents:[{type:"text",text:zo("desc2")}]},4:{title:o(E,{}),img:Eo,documents:[{type:"text",text:zo("desc4")},{type:"conditional",conditional:{label:Bo("set4_cond_squad_use_ex"),metadata:Po.squad_use_ex,fields:[r(Vo.set4_squad_anomProf.tag)]}},{type:"conditional",conditional:{label:Bo("set4_cond_not_char_use_ex"),metadata:Po.not_char_use_ex,fields:[r(Vo.set4_not_self_ether_.tag)]}}]}},Jt="PolarMetal",[Oo,_h]=u("disc",Jt),Ao=z(Jt),wh=p[Jt],qo=g[Jt],vh={2:{title:o(B,{}),img:Ao,documents:[{type:"text",text:Oo("desc2")}]},4:{title:o(E,{}),img:Ao,documents:[{type:"text",text:Oo("desc4")},{type:"conditional",conditional:{label:_h("set4_cond"),metadata:wh.freeze_shatter}},{type:"fields",fields:[{title:"Basic Attack DMG",fieldRef:qo.set4_basic_dmg_.tag},{title:"Dash Attack DMG",fieldRef:qo.set4_dash_dmg_.tag}]}]}},Zt="ProtoPunk",[Fo,kh]=u("disc",Zt),Lo=z(Zt),Ch=p[Zt],Sh=g[Zt],Dh={2:{title:o(B,{}),img:Lo,documents:[{type:"text",text:Fo("desc2")}]},4:{title:o(E,{}),img:Lo,documents:[{type:"text",text:Fo("desc4")},{type:"conditional",conditional:{label:kh("set4_cond"),metadata:Ch.def_assist_or_evasive_assist,fields:[r(Sh.set4_cond_def_assist_or_evasive_assist_dmg_.tag)]}}]}},Qt="PufferElectro",[jo,Mh]=u("disc",Qt),Ho=z(Qt),Ih=p[Qt],Wo=g[Qt],Th={2:{title:o(B,{}),img:Ho,documents:[{type:"text",text:jo("desc2")}]},4:{title:o(E,{}),img:Ho,documents:[{type:"text",text:jo("desc4")},{type:"fields",fields:[{title:"Ultimate DMG",fieldRef:Wo.set4_dmg_.tag}]},{type:"conditional",conditional:{label:Mh("set4_cond"),metadata:Ih.launching_ult,fields:[r(Wo.set4_cond_launching_ult_atk_.tag)]}}]}},Yt="ShadowHarmony",[Ko,Rh]=u("disc",Yt),No=z(Yt),zh=p[Yt],Go=g[Yt],Bh={2:{title:o(B,{}),img:No,documents:[{type:"text",text:Ko("desc2")}]},4:{title:o(E,{}),img:No,documents:[{type:"text",text:Ko("desc4")},{type:"conditional",conditional:{label:Rh("set4_cond_stacks"),metadata:zh.stacks,fields:[r(Go.set4_stack_atk_.tag),r(Go.set4_stack_crit_.tag)]}}]}},Hn="ShockstarDisco",[Uo,f$]=u("disc",Hn),Jo=z(Hn),gn=g[Hn],Eh={2:{title:o(B,{}),img:Jo,documents:[{type:"text",text:Uo("desc2")}]},4:{title:o(E,{}),img:Jo,documents:[{type:"text",text:Uo("desc4")},{type:"fields",fields:[{title:"Basic Attack Daze",fieldRef:gn.set4_basic_daze_.tag},{title:"Dash Attack Daze",fieldRef:gn.set4_dash_daze_.tag},{title:"Dodge Counter Daze",fieldRef:gn.set4_dodgeCounter_daze_.tag}]}]}},Ji="SoulRock",[Zo,$$]=u("disc",Ji),Qo=z(Ji),Ph={2:{title:o(B,{}),img:Qo,documents:[{type:"text",text:Zo("desc2")}]},4:{title:o(E,{}),img:Qo,documents:[{type:"text",text:Zo("desc4")}]}},Xt="SwingJazz",[Yo,Vh]=u("disc",Xt),Xo=z(Xt),Oh=p[Xt],Ah=g[Xt],qh={2:{title:o(B,{}),img:Xo,documents:[{type:"text",text:Yo("desc2")}]},4:{title:o(E,{}),img:Xo,documents:[{type:"text",text:Yo("desc4")},{type:"conditional",conditional:{label:Vh("set4_cond"),metadata:Oh.chain_or_ult,fields:[r(Ah.set4_cond_chain_or_ult.tag)]}}]}},en="ThunderMetal",[ea,Fh]=u("disc",en),ta=z(en),Lh=p[en],jh=g[en],Hh={2:{title:o(B,{}),img:ta,documents:[{type:"text",text:ea("desc2")}]},4:{title:o(E,{}),img:ta,documents:[{type:"text",text:ea("desc4")},{type:"conditional",conditional:{label:Fh("set4_cond"),metadata:Lh.enemy_shocked,fields:[r(jh.set4_cond_enemy_shocked_atk_.tag)]}}]}},tn="WoodpeckerElectro",[na,Wh]=u("disc",tn),oa=z(tn),Kh=p[tn],Nh=g[tn],Gh={2:{title:o(B,{}),img:oa,documents:[{type:"text",text:na("desc2")}]},4:{title:o(E,{}),img:oa,documents:[{type:"text",text:na("desc4")},{type:"conditional",conditional:{label:Wh("set4_cond"),metadata:Kh.crit_basic_dodge_ex,fields:[r(Nh.set4_cond_crit_basic_dodge_ex_atk_.tag)]}}]}},Uh={AstralVoice:Ud,BranchBladeSong:Qd,ChaosJazz:eh,ChaoticMetal:oh,FangedMetal:ch,FreedomBlues:hh,HormonePunk:mh,InfernoMetal:bh,PhaethonsMelody:xh,PolarMetal:vh,ProtoPunk:Dh,PufferElectro:Th,ShadowHarmony:Bh,ShockstarDisco:Eh,SoulRock:Ph,SwingJazz:qh,ThunderMetal:Hh,WoodpeckerElectro:Gh};function B(){return"2-Set"}function E(){return"4-Set"}function f({wKey:e,children:t}){const n=Ot();let a=1;return n&&n.compute(A.common.count.sheet(e)).val&&(a=n.compute(A.wengine.phase).val??1),t(a)}const he="BashfulDemon",[aa,Jh]=u("wengine",he),Zh=w.wengine[he],Qh=$(he,"icon"),Yh=p[he],sa=g[he],Xh={title:aa("phase"),img:Qh,documents:[{type:"text",text:o(f,{wKey:he,children:e=>aa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(sa.passive_ice_dmg_.tag)]},{type:"conditional",conditional:{label:Jh("cond"),metadata:Yh.launch_ex_attack,fields:[r(sa.team_atk_.tag),{title:"Duration",fieldValue:Zh.duration}]}}]},ue="BigCylinder",[ia,y$]=u("wengine",ue),eu=w.wengine[ue],tu=$(ue,"icon"),nu=g[ue],ou=Fn[ue],au={title:ia("phase"),img:tu,documents:[{type:"text",text:o(f,{wKey:ue,children:e=>ia(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(nu.passive_dmg_red_.tag)]},{type:"fields",fields:[{title:"Additional DMG",fieldRef:ou.damage.tag},{title:"Cooldown",fieldValue:eu.cooldown}]}]},ge="BlazingLaurel",[ca,la]=u("wengine",ge),ra=w.wengine[ge],su=$(ge,"icon"),da=p[ge],pn=g[ge],iu={title:ca("phase"),img:su,documents:[{type:"text",text:o(f,{wKey:ge,children:e=>ca(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:la("cond1"),metadata:da.quickOrPerfectAssistUsed,fields:[r(pn.impact_.tag),{title:"Duration",fieldValue:ra.duration}]}},{type:"conditional",conditional:{label:la("cond2"),metadata:da.wilt,fields:[r(pn.crit_dmg_ice_.tag),r(pn.crit_dmg_fire_.tag),{title:"Duration",fieldValue:ra.wilt_duration}]}}]},pe="BoxCutter",[ha,cu]=u("wengine",pe),lu=w.wengine[pe],ru=$(pe,"icon"),du=p[pe],ua=g[pe],hu={title:ha("phase"),img:ru,documents:[{type:"text",text:o(f,{wKey:pe,children:e=>ha(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:cu("cond"),metadata:du.launchedAftershock,fields:[r(ua.physical_dmg_.tag),r(ua.daze_.tag),{title:"Duration",fieldValue:lu.duration}]}}]},gt="BunnyBand",[ga,uu]=u("wengine",gt),gu=$(gt,"icon"),pu=p[gt],pa=g[gt],mu={title:ga("phase"),img:gu,documents:[{type:"text",text:o(f,{wKey:gt,children:e=>ga(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(pa.passive_hp_.tag)]},{type:"conditional",conditional:{label:uu("cond"),metadata:pu.wearerShielded,fields:[r(pa.atk_.tag)]}}]},oe="CannonRotor",[ma,b$]=u("wengine",oe),fu=w.wengine[oe],$u=$(oe,"icon"),yu=Fn[oe],bu=g[oe],xu={title:ma("phase"),img:$u,documents:[{type:"text",text:o(f,{wKey:oe,children:e=>ma(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(bu.passive_atk_.tag)]},{type:"fields",fields:[{title:"Additional DMG",fieldRef:yu.damage.tag},{title:"Cooldown",fieldValue:o(f,{wKey:oe,children:e=>fu.cooldown[e]})}]}]},me="DeepSeaVisitor",[fa,$a]=u("wengine",me),ya=w.wengine[me],_u=$(me,"icon"),ba=p[me],mn=g[me],wu={title:fa("phase"),img:_u,documents:[{type:"text",text:o(f,{wKey:me,children:e=>fa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(mn.passive_ice_dmg_.tag)]},{type:"conditional",conditional:{label:$a("cond1"),metadata:ba.basicHit,fields:[r(mn.crit_.tag),{title:"Duration",fieldValue:ya.duration}]}},{type:"conditional",conditional:{label:$a("cond2"),metadata:ba.iceDashAtkHit,fields:[r(mn.extra_crit_.tag),{title:"Duration",fieldValue:ya.extra_duration}]}}]},fe="DemaraBatteryMarkII",[xa,vu]=u("wengine",fe),ku=w.wengine[fe],Cu=$(fe,"icon"),Su=p[fe],_a=g[fe],Du={title:xa("phase"),img:Cu,documents:[{type:"text",text:o(f,{wKey:fe,children:e=>xa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(_a.passive_electric_dmg_.tag)]},{type:"conditional",conditional:{label:vu("cond"),metadata:Su.dodgeCounterOrAssistHit,fields:[r(_a.enerRegen_.tag),{title:"Duration",fieldValue:ku.duration}]}}]},$e="DrillRigRedAxis",[wa,Mu]=u("wengine",$e),va=w.wengine[$e],Iu=$($e,"icon"),Tu=p[$e],ka=g[$e],Ru={title:wa("phase"),img:Iu,documents:[{type:"text",text:o(f,{wKey:$e,children:e=>wa(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Mu("cond"),metadata:Tu.exSpecialOrChainUsed,fields:[r(ka.basic_eletric_dmg_.tag),r(ka.dash_eletric_dmg_.tag),{title:"Duration",fieldValue:va.duration},{title:"Cooldown",fieldValue:va.cooldown}]}}]},pt="ElectroLipGloss",[Ca,zu]=u("wengine",pt),Bu=$(pt,"icon"),Eu=p[pt],Sa=g[pt],Pu={title:Ca("phase"),img:Bu,documents:[{type:"text",text:o(f,{wKey:pt,children:e=>Ca(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:zu("cond"),metadata:Eu.anomalyOnEnemy,fields:[r(Sa.atk_.tag),r(Sa.common_dmg_.tag)]}}]},ye="ElegantVanity",[Da,Vu]=u("wengine",ye),Ou=w.wengine[ye],Au=$(ye,"icon"),qu=p[ye],Fu=g[ye],Lu={title:Da("phase"),img:Au,documents:[{type:"text",text:o(f,{wKey:ye,children:e=>Da(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Vu("cond"),metadata:qu.consumed25Energy,fields:[r(Fu.common_dmg_.tag),{title:"Duration",fieldValue:Ou.buffDuration}]}}]},be="FlamemakerShaker",[Ma,Ia]=u("wengine",be),fn=w.wengine[be],ju=$(be,"icon"),Ta=p[be],$n=g[be],Hu={title:Ma("phase"),img:ju,documents:[{type:"text",text:o(f,{wKey:be,children:e=>Ma(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Ia("cond1"),metadata:Ta.offField,fields:[r($n.enerRegen.tag)]}},{type:"conditional",conditional:{label:Ia("cond2"),metadata:Ta.exSpecialAssistHits,fields:[r($n.common_dmg_.tag),{title:"Duration",fieldValue:fn.duration},{title:"Cooldown",fieldValue:fn.cooldown},r($n.anomProf.tag),{title:"Duration",fieldValue:fn.anomProfDuration}]}}]},xe="FlightOfFancy",[Ra,Wu]=u("wengine",xe),za=w.wengine[xe],Ku=$(xe,"icon"),Nu=p[xe],Ba=g[xe],Gu={title:Ra("phase"),img:Ku,documents:[{type:"text",text:o(f,{wKey:xe,children:e=>Ra(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Ba.anomBuildup_.tag)]},{type:"conditional",conditional:{label:Wu("cond"),metadata:Nu.etherDmg,fields:[r(Ba.etherDmg_anomProf.tag),{title:"Duration",fieldValue:za.duration},{title:"Cooldown",fieldValue:za.cd}]}}]},_e="FusionCompiler",[Ea,Uu]=u("wengine",_e),Ju=w.wengine[_e],Zu=$(_e,"icon"),Qu=p[_e],Pa=g[_e],Yu={title:Ea("phase"),img:Zu,documents:[{type:"text",text:o(f,{wKey:_e,children:e=>Ea(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Pa.passive_atk_.tag)]},{type:"conditional",conditional:{label:Uu("cond"),metadata:Qu.specialUsed,fields:[r(Pa.anomProf.tag),{title:"Duration",fieldValue:Ju.duration}]}}]},nn="GildedBlossom",[Va,x$]=u("wengine",nn),Xu=$(nn,"icon"),Oa=g[nn],eg={title:Va("phase"),img:Xu,documents:[{type:"text",text:o(f,{wKey:nn,children:e=>Va(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Oa.passive_atk_.tag),r(Oa.passive_exSpecial_dmg_.tag)]}]},we="HailstormShrine",[Aa,tg]=u("wengine",we),ng=w.wengine[we],og=$(we,"icon"),ag=p[we],qa=g[we],sg={title:Aa("phase"),img:og,documents:[{type:"text",text:o(f,{wKey:we,children:e=>Aa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(qa.passive_crit_dmg_.tag)]},{type:"conditional",conditional:{label:tg("cond"),metadata:ag.exSpecialOrAnomaly,fields:[r(qa.ice_dmg_.tag),{title:"Duration",fieldValue:ng.duration}]}}]},ve="HeartstringNocturne",[Fa,ig]=u("wengine",ve),cg=w.wengine[ve],lg=$(ve,"icon"),rg=p[ve],yn=g[ve],dg={title:Fa("phase"),img:lg,documents:[{type:"text",text:o(f,{wKey:ve,children:e=>Fa(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(yn.passive_crit_dmg_.tag)]},{type:"conditional",conditional:{label:ig("cond"),metadata:rg.heartstring,fields:[r(yn.chain_resIgn_fire_.tag),r(yn.ult_resIgn_fire_.tag),{title:"Duration",fieldValue:cg.duration}]}}]},ke="HellfireGears",[La,ja]=u("wengine",ke),hg=w.wengine[ke],ug=$(ke,"icon"),Ha=p[ke],Wa=g[ke],gg={title:La("phase"),img:ug,documents:[{type:"text",text:o(f,{wKey:ke,children:e=>La(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ja("cond1"),metadata:Ha.offField,fields:[r(Wa.enerRegen.tag)]}},{type:"conditional",conditional:{label:ja("cond1"),metadata:Ha.exSpecialUsed,fields:[r(Wa.impact_.tag),{title:"Duration",fieldValue:hg.duration}]}}]},Ce="Housekeeper",[Ka,Na]=u("wengine",Ce),pg=w.wengine[Ce],mg=$(Ce,"icon"),Ga=p[Ce],Ua=g[Ce],fg={title:Ka("phase"),img:mg,documents:[{type:"text",text:o(f,{wKey:Ce,children:e=>Ka(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Na("cond1"),metadata:Ga.offField,fields:[r(Ua.enerRegen.tag)]}},{type:"conditional",conditional:{label:Na("cond2"),metadata:Ga.exSpecialHits,fields:[r(Ua.physical_dmg_.tag),{title:"Duration",fieldValue:pg.duration}]}}]},Se="IceJadeTeapot",[Ja,$g]=u("wengine",Se),Za=w.wengine[Se],yg=$(Se,"icon"),bg=p[Se],Qa=g[Se],xg={title:Ja("phase"),img:yg,documents:[{type:"text",text:o(f,{wKey:Se,children:e=>Ja(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:$g("cond"),metadata:bg.teariffic,fields:[r(Qa.impact_.tag),{title:"Duration",fieldValue:Za.duration},r(Qa.common_dmg_.tag),{title:"Duration",fieldValue:Za.teamBuffDuration}]}}]},De="IdentityBase",[Ya,_g]=u("wengine",De),wg=w.wengine[De],vg=$(De,"icon"),kg=p[De],Cg=g[De],Sg={title:Ya("phase"),img:vg,documents:[{type:"text",text:o(f,{wKey:De,children:e=>Ya(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:_g("cond"),metadata:kg.equipperAttacked,fields:[r(Cg.def_.tag),{title:"Duration",fieldValue:wg.duration}]}}]},Wn="IdentityInflection",[Xa,_$]=u("wengine",Wn),Dg=$(Wn,"icon"),Mg={title:Xa("phase"),img:Dg,documents:[{type:"text",text:o(f,{wKey:Wn,children:e=>Xa(`phaseDescs.${e-1}`)})}]},Me="KaboomTheCannon",[es,Ig]=u("wengine",Me),Tg=w.wengine[Me],Rg=$(Me,"icon"),zg=p[Me],Bg=g[Me],Eg={title:es("phase"),img:Rg,documents:[{type:"text",text:o(f,{wKey:Me,children:e=>es(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Ig("cond"),metadata:zg.allyHitsEnemy,fields:[r(Bg.atk_.tag),{title:"Duration",fieldValue:Tg.duration}]}}]},Ie="LunarDecrescent",[ts,Pg]=u("wengine",Ie),Vg=w.wengine[Ie],Og=$(Ie,"icon"),Ag=p[Ie],qg=g[Ie],Fg={title:ts("phase"),img:Og,documents:[{type:"text",text:o(f,{wKey:Ie,children:e=>ts(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Pg("cond"),metadata:Ag.chainOrUltUsed,fields:[r(qg.common_dmg_.tag),{title:"Duration",fieldValue:Vg.duration}]}}]},Kn="LunarNoviluna",[ns,w$]=u("wengine",Kn),Lg=$(Kn,"icon"),jg={title:ns("phase"),img:Lg,documents:[{type:"text",text:o(f,{wKey:Kn,children:e=>ns(`phaseDescs.${e-1}`)})}]},on="LunarPleniluna",[os,v$]=u("wengine",on),Hg=$(on,"icon"),bn=g[on],Wg={title:os("phase"),img:Hg,documents:[{type:"text",text:o(f,{wKey:on,children:e=>os(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(bn.basic_dmg_.tag),r(bn.dash_dmg_.tag),r(bn.dodgeCounter_dmg_.tag)]}]},Te="MagneticStormAlpha",[as,Kg]=u("wengine",Te),ss=w.wengine[Te],Ng=$(Te,"icon"),Gg=p[Te],Ug=g[Te],Jg={title:as("phase"),img:Ng,documents:[{type:"text",text:o(f,{wKey:Te,children:e=>as(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Kg("cond"),metadata:Gg.anomalyBuildupIncreased,fields:[r(Ug.anomMas.tag),{title:"Duration",fieldValue:ss.duration},{title:"Cooldown",fieldValue:ss.cooldown}]}}]},Re="MagneticStormBravo",[is,Zg]=u("wengine",Re),cs=w.wengine[Re],Qg=$(Re,"icon"),Yg=p[Re],Xg=g[Re],ep={title:is("phase"),img:Qg,documents:[{type:"text",text:o(f,{wKey:Re,children:e=>is(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Zg("cond"),metadata:Yg.anomalyBuildupIncreased,fields:[r(Xg.anomProf.tag),{title:"Duration",fieldValue:cs.duration},{title:"Cooldown",fieldValue:cs.cooldown}]}}]},Nn="MagneticStormCharlie",[ls,k$]=u("wengine",Nn),tp=$(Nn,"icon"),np={title:ls("phase"),img:tp,documents:[{type:"text",text:o(f,{wKey:Nn,children:e=>ls(`phaseDescs.${e-1}`)})}]},ze="MarcatoDesire",[rs,ds]=u("wengine",ze),op=w.wengine[ze],ap=$(ze,"icon"),hs=p[ze],sp=g[ze],ip={title:rs("phase"),img:ap,documents:[{type:"text",text:o(f,{wKey:ze,children:e=>rs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ds("cond1"),metadata:hs.exSpecialOrChainHitsEnemy,fields:[r(sp.atk_.tag),{title:"Duration",fieldValue:op.duration}]}},{type:"conditional",conditional:{label:ds("cond2"),metadata:hs.attributeAnomalyInflicted}}]},Be="MyriadEclipse",[us,cp]=u("wengine",Be),lp=w.wengine[Be],rp=$(Be,"icon"),dp=p[Be],gs=g[Be],hp={title:us("phase"),img:rp,documents:[{type:"text",text:o(f,{wKey:Be,children:e=>us(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(gs.crit_dmg_.tag)]},{type:"conditional",conditional:{label:cp("cond"),metadata:dp.deathSentence,fields:[r(gs.deathSentence_defIgn_.tag),{title:"Duration",fieldValue:lp.duration}]}}]},Ee="OriginalTransmorpher",[ps,up]=u("wengine",Ee),gp=w.wengine[Ee],pp=$(Ee,"icon"),mp=p[Ee],ms=g[Ee],fp={title:ps("phase"),img:pp,documents:[{type:"text",text:o(f,{wKey:Ee,children:e=>ps(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(ms.passive_hp_.tag)]},{type:"conditional",conditional:{label:up("cond"),metadata:mp.equipperHit,fields:[r(ms.impact_.tag),{title:"Duration",fieldValue:gp.duration}]}}]},mt="PeacekeeperSpecialized",[fs,$p]=u("wengine",mt),yp=$(mt,"icon"),bp=p[mt],xn=g[mt],xp={title:fs("phase"),img:yp,documents:[{type:"text",text:o(f,{wKey:mt,children:e=>fs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:$p("cond"),metadata:bp.shielded,fields:[r(xn.enerRegen.tag)]}},{type:"fields",fields:[r(xn.passive_exSpecial_anomBuildup_.tag),r(xn.passive_assist_anomBuildup_.tag)]}]},ft="PreciousFossilizedCore",[$s,ys]=u("wengine",ft),_p=$(ft,"icon"),bs=p[ft],wp=g[ft],vp={title:$s("phase"),img:_p,documents:[{type:"text",text:o(f,{wKey:ft,children:e=>$s(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ys("cond1"),metadata:bs.enemyHpGE50,fields:[r(wp.daze_.tag)]}},{type:"conditional",conditional:{label:ys("cond2"),metadata:bs.enemyHpGE75}}]},Pe="RainforestGourmet",[xs,kp]=u("wengine",Pe),Cp=w.wengine[Pe],Sp=$(Pe,"icon"),Dp=p[Pe],Mp=g[Pe],Ip={title:xs("phase"),img:Sp,documents:[{type:"text",text:o(f,{wKey:Pe,children:e=>xs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:kp("cond"),metadata:Dp.energyConsumed,fields:[r(Mp.atk_.tag),{title:"Duration",fieldValue:Cp.duration}]}}]},Ve="ReverbMarkI",[_s,Tp]=u("wengine",Ve),Rp=w.wengine[Ve],zp=$(Ve,"icon"),Bp=p[Ve],Ep=g[Ve],Pp={title:_s("phase"),img:zp,documents:[{type:"text",text:o(f,{wKey:Ve,children:e=>_s(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Tp("cond"),metadata:Bp.exSpecialUsed,fields:[r(Ep.impact_.tag),{title:"Duration",fieldValue:Rp.duration}]}}]},Oe="ReverbMarkII",[ws,Vp]=u("wengine",Oe),Op=w.wengine[Oe],Ap=$(Oe,"icon"),qp=p[Oe],vs=g[Oe],Fp={title:ws("phase"),img:Ap,documents:[{type:"text",text:o(f,{wKey:Oe,children:e=>ws(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Vp("cond"),metadata:qp.exSpecialOrChainUsed,fields:[r(vs.anomMas.tag),r(vs.anomProf.tag),{title:"Duration",fieldValue:Op.duration}]}}]},Ae="ReverbMarkIII",[ks,Lp]=u("wengine",Ae),jp=w.wengine[Ae],Hp=$(Ae,"icon"),Wp=p[Ae],Kp=g[Ae],Np={title:ks("phase"),img:Hp,documents:[{type:"text",text:o(f,{wKey:Ae,children:e=>ks(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Lp("cond"),metadata:Wp.chainOrUltUsed,fields:[r(Kp.atk_.tag),{title:"Duration",fieldValue:jp.duration}]}}]},$t="RiotSuppressorMarkVI",[Cs,Gp]=u("wengine",$t),Up=$($t,"icon"),Jp=p[$t],Ss=g[$t],Zp={title:Cs("phase"),img:Up,documents:[{type:"text",text:o(f,{wKey:$t,children:e=>Cs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Ss.passive_crit_.tag)]},{type:"conditional",conditional:{label:Gp("cond"),metadata:Jp.charge,fields:[r(Ss.basic_ether_dmg_.tag)]}}]},qe="RoaringRide",[Ds,_n]=u("wengine",qe),wn=w.wengine[qe],Qp=$(qe,"icon"),vn=p[qe],kn=g[qe],Yp={title:Ds("phase"),img:Qp,documents:[{type:"text",text:o(f,{wKey:qe,children:e=>Ds(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:_n("cond_atk_"),metadata:vn.atk_,fields:[r(kn.atk_.tag),{title:"Duration",fieldValue:wn.duration}]}},{type:"conditional",conditional:{label:_n("cond_anomProf"),metadata:vn.anomProf,fields:[r(kn.anomProf.tag),{title:"Duration",fieldValue:wn.duration}]}},{type:"conditional",conditional:{label:_n("cond_anomBuildup_"),metadata:vn.anomBuildup_,fields:[r(kn.anomBuildup_.tag),{title:"Duration",fieldValue:wn.duration}]}}]},Fe="SeveredInnocence",[Ms,Xp]=u("wengine",Fe),em=w.wengine[Fe],tm=$(Fe,"icon"),nm=p[Fe],Cn=g[Fe],om={title:Ms("phase"),img:tm,documents:[{type:"text",text:o(f,{wKey:Fe,children:e=>Ms(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Cn.passive_crit_dmg_.tag)]},{type:"conditional",conditional:{label:Xp("cond"),metadata:nm.basicSpecialAftershockHit,fields:[r(Cn.crit_dmg_.tag),r(Cn.electric_dmg_.tag),{title:"Duration",fieldValue:em.duration}]}}]},Le="SharpenedStinger",[Is,am]=u("wengine",Le),sm=w.wengine[Le],im=$(Le,"icon"),cm=p[Le],Ts=g[Le],lm={title:Is("phase"),img:im,documents:[{type:"text",text:o(f,{wKey:Le,children:e=>Is(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:am("cond"),metadata:cm.predatoryInstinct,fields:[r(Ts.physical_dmg_.tag),{title:"Duration",fieldValue:sm.duration}]}},{type:"fields",fields:[r(Ts.anomBuildup_.tag)]}]},yt="SixShooter",[Rs,rm]=u("wengine",yt),dm=$(yt,"icon"),hm=p[yt],um=g[yt],gm={title:Rs("phase"),img:dm,documents:[{type:"text",text:o(f,{wKey:yt,children:e=>Rs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:rm("cond"),metadata:hm.charge,fields:[r(um.exSpecial_daze_.tag)]}}]},Gn="SliceOfTime",[zs,C$]=u("wengine",Gn),pm=$(Gn,"icon"),mm={title:zs("phase"),img:pm,documents:[{type:"text",text:o(f,{wKey:Gn,children:e=>zs(`phaseDescs.${e-1}`)})}]},je="SpectralGaze",[Bs,Es]=u("wengine",je),Ps=w.wengine[je],fm=$(je,"icon"),Vs=p[je],Os=g[je],$m={title:Bs("phase"),img:fm,documents:[{type:"text",text:o(f,{wKey:je,children:e=>Bs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Es("cond1"),metadata:Vs.hit_aftershock_electric,fields:[r(Os.cond_defRed_.tag),{title:"Duration",fieldValue:Ps.duration1}]}},{type:"conditional",conditional:{label:Es("cond2"),metadata:Vs.spiritLock,fields:[r(Os.cond_impact_.tag),{title:"Duration",fieldValue:Ps.duration2}]}}]},He="SpringEmbrace",[As,ym]=u("wengine",He),bm=w.wengine[He],xm=$(He,"icon"),_m=p[He],qs=g[He],wm={title:As("phase"),img:xm,documents:[{type:"text",text:o(f,{wKey:He,children:e=>As(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(qs.passive_dmg_red_.tag)]},{type:"conditional",conditional:{label:ym("cond"),metadata:_m.when_attacked,fields:[r(qs.cond_enerRegen_.tag),{title:"Duration",fieldValue:bm.duration}]}}]},We="StarlightEngine",[Fs,vm]=u("wengine",We),km=w.wengine[We],Cm=$(We,"icon"),Sm=p[We],Dm=g[We],Mm={title:Fs("phase"),img:Cm,documents:[{type:"text",text:o(f,{wKey:We,children:e=>Fs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:vm("cond"),metadata:Sm.dodgecounter_quickassist,fields:[r(Dm.cond_dmg_.tag),{title:"Duration",fieldValue:km.duration}]}}]},Ke="StarlightEngineReplica",[Ls,Im]=u("wengine",Ke),Tm=w.wengine[Ke],Rm=$(Ke,"icon"),zm=p[Ke],Bm=g[Ke],Em={title:Ls("phase"),img:Rm,documents:[{type:"text",text:o(f,{wKey:Ke,children:e=>Ls(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Im("cond"),metadata:zm.hit_away,fields:[r(Bm.cond_dmg_.tag),{title:"Duration",fieldValue:Tm.duration}]}}]},Ne="SteamOven",[js,Pm]=u("wengine",Ne),Vm=w.wengine[Ne],Om=$(Ne,"icon"),Am=p[Ne],qm=g[Ne],Fm={title:js("phase"),img:Om,documents:[{type:"text",text:o(f,{wKey:Ne,children:e=>js(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Pm("cond"),metadata:Am.stacks,fields:[r(qm.cond_impact_.tag),{title:"Duration",fieldValue:Vm.duration}]}}]},bt="SteelCushion",[Hs,Lm]=u("wengine",bt),jm=$(bt,"icon"),Hm=p[bt],Ws=g[bt],Wm={title:Hs("phase"),img:jm,documents:[{type:"text",text:o(f,{wKey:bt,children:e=>Hs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Ws.passive_physical_dmg_.tag)]},{type:"conditional",conditional:{label:Lm("cond"),metadata:Hm.hit_behind,fields:[r(Ws.cond_dmg_.tag)]}}]},xt="StreetSuperstar",[Ks,Km]=u("wengine",xt),Nm=$(xt,"icon"),Gm=p[xt],Um=g[xt],Jm={title:Ks("phase"),img:Nm,documents:[{type:"text",text:o(f,{wKey:xt,children:e=>Ks(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Km("cond"),metadata:Gm.charge,fields:[r(Um.cond_ult_dmg_.tag)]}}]},Ge="TheBrimstone",[Ns,Zm]=u("wengine",Ge),Qm=w.wengine[Ge],Ym=$(Ge,"icon"),Xm=p[Ge],ef=g[Ge],tf={title:Ns("phase"),img:Ym,documents:[{type:"text",text:o(f,{wKey:Ge,children:e=>Ns(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Zm("cond"),metadata:Xm.hit_basic_dash_dodge,fields:[r(ef.cond_atk_.tag),{title:"Duration",fieldValue:Qm.duration}]}}]},Ue="TheRestrained",[Gs,nf]=u("wengine",Ue),of=w.wengine[Ue],af=$(Ue,"icon"),sf=p[Ue],Us=g[Ue],cf={title:Gs("phase"),img:af,documents:[{type:"text",text:o(f,{wKey:Ue,children:e=>Gs(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:nf("cond"),metadata:sf.dmg_daze_,fields:[r(Us.basic_dmg_.tag),r(Us.basic_daze_.tag),{title:"Duration",fieldValue:of.duration}]}}]},Je="TheVault",[Js,lf]=u("wengine",Je),rf=w.wengine[Je],df=$(Je,"icon"),hf=p[Je],uf=g[Je],gf={title:Js("phase"),img:df,documents:[{type:"text",text:o(f,{wKey:Je,children:e=>Js(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:lf("cond"),metadata:hf.ether_hit,fields:[r(uf.cond_dmg_.tag),{title:"Duration",fieldValue:rf.duration}]}}]},Ze="Timeweaver",[Zs,pf]=u("wengine",Ze),mf=w.wengine[Ze],ff=$(Ze,"icon"),$f=p[Ze],Sn=g[Ze],yf={title:Zs("phase"),img:ff,documents:[{type:"text",text:o(f,{wKey:Ze,children:e=>Zs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Sn.passive_electric_anomBuildup_.tag),r(Sn.passive_disorder_dmg_.tag)]},{type:"conditional",conditional:{label:pf("cond"),metadata:$f.hit_anomaly,fields:[r(Sn.cond_anomProf.tag),{title:"Duration",fieldValue:mf.duration}]}}]},Qe="TusksOfFury",[Qs,bf]=u("wengine",Qe),xf=w.wengine[Qe],_f=$(Qe,"icon"),wf=p[Qe],Dn=g[Qe],vf={title:Qs("phase"),img:_f,documents:[{type:"text",text:o(f,{wKey:Qe,children:e=>Qs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Dn.passive_shield_.tag)]},{type:"conditional",conditional:{label:bf("cond"),metadata:wf.interrupt_perfdodge,fields:[r(Dn.cond_dmg_.tag),r(Dn.daze_.tag),{title:"Duration",fieldValue:xf.duration}]}}]},Ye="UnfetteredGameBall",[Ys,kf]=u("wengine",Ye),Cf=w.wengine[Ye],Sf=$(Ye,"icon"),Df=p[Ye],Mf=g[Ye],If={title:Ys("phase"),img:Sf,documents:[{type:"text",text:o(f,{wKey:Ye,children:e=>Ys(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:kf("cond"),metadata:Df.anomaly_counter,fields:[r(Mf.cond_crit_.tag),{title:"Duration",fieldValue:Cf.duration}]}}]},an="VortexArrow",[Xs,S$]=u("wengine",an),Tf=$(an,"icon"),Rf=g[an],zf={title:Xs("phase"),img:Tf,documents:[{type:"text",text:o(f,{wKey:an,children:e=>Xs(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Rf.passive_daze_.tag)]}]},Xe="VortexHatchet",[ei,Bf]=u("wengine",Xe),ti=w.wengine[Xe],Ef=$(Xe,"icon"),Pf=p[Xe],Vf=g[Xe],Of={title:ei("phase"),img:Ef,documents:[{type:"text",text:o(f,{wKey:Xe,children:e=>ei(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Bf("cond"),metadata:Pf.entering,fields:[r(Vf.cond_impact_.tag),{title:"Duration",fieldValue:ti.duration},{title:"Cooldown",fieldValue:ti.cooldown}]}}]},sn="VortexRevolver",[ni,D$]=u("wengine",sn),Af=$(sn,"icon"),qf=g[sn],Ff={title:ni("phase"),img:Af,documents:[{type:"text",text:o(f,{wKey:sn,children:e=>ni(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(qf.passive_exSpecial_daze_.tag)]}]},et="WeepingCradle",[oi,ai]=u("wengine",et),Lf=w.wengine[et],jf=$(et,"icon"),si=p[et],Hf=g[et],Wf={title:oi("phase"),img:jf,documents:[{type:"text",text:o(f,{wKey:et,children:e=>oi(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:ai("cond_atk"),metadata:si.attack}},{type:"conditional",conditional:{label:ai("cond_stacks"),metadata:si.stacks,fields:[r(Hf.cond_dmg_.tag),{title:"Duration",fieldValue:Lf.duration}]}}]},_t="WeepingGemini",[ii,Kf]=u("wengine",_t),Nf=$(_t,"icon"),Gf=p[_t],Uf=g[_t],Jf={title:ii("phase"),img:Nf,documents:[{type:"text",text:o(f,{wKey:_t,children:e=>ii(`phaseDescs.${e-1}`)})},{type:"conditional",conditional:{label:Kf("cond"),metadata:Gf.anomaly_stack,fields:[r(Uf.anomProf.tag)]}}]},tt="ZanshinHerbCase",[ci,Zf]=u("wengine",tt),Qf=w.wengine[tt],Yf=$(tt,"icon"),Xf=p[tt],Mn=g[tt],e$={title:ci("phase"),img:Yf,documents:[{type:"text",text:o(f,{wKey:tt,children:e=>ci(`phaseDescs.${e-1}`)})},{type:"fields",fields:[r(Mn.passive_crit_.tag),r(Mn.passive_electric_dmg_.tag)]},{type:"conditional",conditional:{label:Zf("cond"),metadata:Xf.apply_anom_stun,fields:[r(Mn.cond_crit_.tag),{title:"Duration",fieldValue:Qf.duration}]}}]},t$={BashfulDemon:Xh,BigCylinder:au,BlazingLaurel:iu,BoxCutter:hu,BunnyBand:mu,CannonRotor:xu,DeepSeaVisitor:wu,DemaraBatteryMarkII:Du,DrillRigRedAxis:Ru,ElectroLipGloss:Pu,ElegantVanity:Lu,FlamemakerShaker:Hu,FlightOfFancy:Gu,FusionCompiler:Yu,GildedBlossom:eg,HailstormShrine:sg,HeartstringNocturne:dg,HellfireGears:gg,Housekeeper:fg,IceJadeTeapot:xg,IdentityBase:Sg,IdentityInflection:Mg,KaboomTheCannon:Eg,LunarDecrescent:Fg,LunarNoviluna:jg,LunarPleniluna:Wg,MagneticStormAlpha:Jg,MagneticStormBravo:ep,MagneticStormCharlie:np,MarcatoDesire:ip,MyriadEclipse:hp,OriginalTransmorpher:fp,PeacekeeperSpecialized:xp,PreciousFossilizedCore:vp,RainforestGourmet:Ip,ReverbMarkI:Pp,ReverbMarkII:Fp,ReverbMarkIII:Np,RiotSuppressorMarkVI:Zp,RoaringRide:Yp,SeveredInnocence:om,SharpenedStinger:lm,SixShooter:gm,SliceOfTime:mm,SpectralGaze:$m,SpringEmbrace:wm,StarlightEngine:Mm,StarlightEngineReplica:Em,SteamOven:Fm,SteelCushion:Wm,StreetSuperstar:Jm,TheBrimstone:tf,TheRestrained:cf,TheVault:gf,Timeweaver:yf,TusksOfFury:vf,UnfetteredGameBall:If,VortexArrow:zf,VortexHatchet:Of,VortexRevolver:Ff,WeepingCradle:Wf,WeepingGemini:Jf,ZanshinHerbCase:e$};function n$(e){const{attribute:t}=e;if(t)return t}function o$(e){const{q:t}=e;return["standardDmg","anomalyDmg"].includes(t)}function a$(e){const{damageType1:t,damageType2:n}=e,a=[];return o$(e)?(t&&a.push(t),n&&a.push(n),a):[]}const Bt={basic:"Basic",dash:"Dash",dodgeCounter:"Dodge Counter",special:"Special",exSpecial:"EX Special",chain:"Chain",ult:"Ultimate",quickAssist:"Quick Assist",defensiveAssist:"Defensive Assist",evasiveAssist:"Evasive Assist",assistFollowUp:"Assist Follow Up",anomaly:"Anomaly",disorder:"Disorder",aftershock:"Aftershock",elemental:"Elemental"},Zi=["crit_","crit_dmg_","impact","pen","pen_","enerRegen","anomProf","anomMas"].map(e=>{if(fl.includes(e)){const t={...A.final.dmg_.tag,attribute:e.slice(0,-5)};return{title:o(Ct,{statKey:e}),fieldRef:t}}return e==="crit_"?{fieldRef:A.common.cappedCrit_.tag,title:o(Ct,{statKey:e})}:{fieldRef:A.final[e].tag,title:o(Ct,{statKey:e})}});Zi.push(...at.map(e=>({fieldRef:{et:"own",qt:"formula",q:"standardDmg",attribute:e,name:"standardDmgInst"},title:x(st,{color:e,children:[le[e]," Damage"]})})),...at.flatMap(e=>$l.map(t=>({fieldRef:{et:"own",qt:"formula",q:"standardDmg",attribute:e,damageType1:t,name:"standardDmgInst"},title:x(st,{color:e,children:[le[e]," ",Bt[t]," Damage"]})}))),...at.map(e=>({fieldRef:{et:"own",qt:"formula",q:"anomalyDmg",attribute:e,damageType1:"anomaly",name:"anomalyDmgInst"},title:x(st,{color:e,children:[le[e]," Anomaly Damage"]})})),...at.map(e=>({fieldRef:{et:"own",qt:"formula",q:"anomBuildup",attribute:e,name:"anomalyBuildupInst"},title:x(st,{color:e,children:[le[e]," Anomaly Buildup"]})})),{fieldRef:{et:"own",qt:"formula",q:"dazeBuildup",name:"dazeInst"},title:"Daze Buildup"});const Un=[];Object.values(Wd).forEach(e=>Object.values(e).forEach(t=>t.documents.forEach(n=>n.type==="fields"&&n.fields.forEach(a=>cr(a)&&Un.push({tag:a.fieldRef,value:a})))));Zi.forEach(e=>{Un.push({tag:e.fieldRef,value:e})});const s$=Gl(Un),Tn=new Map;function Qi(e,t){if(Tn.get(e))throw new Error(`Duplicate conditional ${e}`);Tn.set(e,t)}Object.values(t$).forEach(({documents:e})=>{e.forEach(t=>{t.type==="conditional"&&Qi(`${t.conditional.metadata.sheet}:${t.conditional.metadata.name}`,t.conditional)})});Object.values(Uh).forEach(e=>Object.values(e).forEach(({documents:t})=>{t.forEach(n=>{n.type==="conditional"&&Qi(`${n.conditional.metadata.sheet}:${n.conditional.metadata.name}`,n.conditional)})}));export{Jl as A,m$ as C,co as D,u$ as F,At as T,lt as a,Fi as b,Pl as c,zl as d,Uh as e,Bt as f,br as g,Ot as h,kr as i,p$ as j,g$ as k,Zl as l,Vt as m,Ul as n,h$ as o,tr as p,xr as q,er as r,Gi as s,Ol as u,t$ as w};
